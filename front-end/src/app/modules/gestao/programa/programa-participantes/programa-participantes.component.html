<grid [dao]="dao" [form]="form" [title]="isModal ? '' : title" [orderBy]="orderBy" [groupBy]="groupBy" [join]="join" editable
    [add]="addParticipante.bind(this)" [load]="loadParticipante.bind(this)" [remove]="removeParticipante.bind(this)" [save]="saveParticipante.bind(this)"
    [selectable]="selectable" (select)="onSelect($event)"
    [hasAdd]="auth.hasPermissionTo('MOD_PRGT_INCL')"
    [hasEdit]="auth.hasPermissionTo('MOD_PRGT_EDT')"
    [hasDelete]="auth.hasPermissionTo('MOD_PRGT_EXCL')">
    <toolbar *ngIf="!selectable"></toolbar>
    <filter [form]="filter" [where]="filterWhere" [submit]="filterSubmit.bind(this)" [clear]="filterClear.bind(this)" [collapseChange]="filterCollapseChange.bind(this)" [collapsed]="!selectable && filterCollapsed">
        <div class="row">
            <input-text [size]="6" label="Nome" controlName="nome" [control]="filter!.controls.nome" placeholder="Nome do usuário..."></input-text>
            <input-search [size]="6" #unidade label="Unidade" icon="fab fa-unity" controlName="unidade_id" [control]="filter!.controls.unidade_id" [dao]="unidadeDao" [selectRoute]="{route: ['configuracoes', 'unidade']}"></input-search>
        </div>
    </filter>
    <columns>
        <column icon="bi-person" [align]="'center'" [template]="columnFoto"  [editTemplate]="editFoto">
            <ng-template let-row="row" #columnFoto>
                <profile-picture [url]="row.usuario?.url_foto" [size]="40" [hint]="row.usuario?.nome"></profile-picture>
            </ng-template>
            <ng-template let-row="row" #editFoto>
                <profile-picture [url]="usuario?.searchObj?.url_foto" [size]="40"></profile-picture>
            </ng-template>
        </column>
        <column title="Usuário" [template]="columnUsuario" [editTemplate]="editUsuario">
            <ng-template let-row="row" #columnUsuario>
                <strong>{{row.usuario?.nome || ""}}</strong><br>
                <small>{{row.usuario?.apelido || ""}}</small>
                <!-- Pensar na possibilidade de por as lotacoes -->
            </ng-template>
            <ng-template let-row="row" #editUsuario>
                <input-search #usuario [size]="12" controlName="usuario_id" [control]="form.controls.usuario_id" [dao]="usuarioDao" [selectRoute]="{route: ['configuracoes', 'usuario']}"></input-search>
            </ng-template>
        </column>
        <column title="Habilitado" [template]="columnHabilitado" [editTemplate]="editHabilitado">
            <ng-template let-row="row" #columnHabilitado>
                <i *ngIf="row.habilitado" class="bi bi-person-check"></i>
            </ng-template>
            <ng-template let-row="row" #editHabilitado>
                <input-switch [size]="12" controlName="habilitado" [control]="form!.controls.habilitado"></input-switch>
            </ng-template>
        </column>
        <column type="options"></column>
    </columns>
    <pagination [rows]="rowsLimit"></pagination>
</grid>
