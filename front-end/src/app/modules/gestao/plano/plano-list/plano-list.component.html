<!--<h3 *ngIf="!isModal" class="my-2">{{title}}</h3>-->
<grid multiselect [dao]="dao" [add]="add" [title]="isModal ? '' : title" [orderBy]="orderBy" [groupBy]="groupBy" [join]="join"
    [selectable]="selectable" (select)="onSelect($event)"
    [hasAdd]="auth.hasPermissionTo('MOD_PTR_INCL')"
    [hasEdit]="auth.hasPermissionTo('MOD_PTR_EDT')"
    [dynamicMultiselectMenu]="dynamicMultiselectMenu.bind(this)"
    [multiselectAllFields]="multiselectAllFields">
    <toolbar *ngIf="!selectable">
      <input-switch [size]="4" labelPosition="left" label="Agrupar por Un." controlName="agrupar" [control]="filter!.controls.agrupar" (change)="onAgruparChange($event)"></input-switch>
    </toolbar>
    <filter [form]="filter" [where]="filterWhere" [submit]="filterSubmit.bind(this)" [clear]="filterClear.bind(this)" [collapseChange]="filterCollapseChange.bind(this)" [collapsed]="!selectable && filterCollapsed">
        <div class="row">
            <input-text [size]="6" label="Usuário" controlName="usuario" [control]="filter!.controls.usuario" placeholder="Usuário"></input-text>
            <input-search [size]="6" label="Unidade" controlName="unidade_id" [control]="filter!.controls.unidade_id" [dao]="unidadeDao" [selectRoute]="{route: ['configuracoes', 'unidade']}"></input-search>
        </div>
        <div class="row">
          <input-search [size]="3" label="Tipo de modalidade" controlName="tipo_modalidade_id" [control]="filter!.controls.tipo_modalidade_id" [dao]="tipoModalidadeDao" [selectRoute]="{route: ['cadastros', 'tipo-modalidade']}"></input-search>
          <input-select [size]="2" label="Data" itemTodos="- Nenhum -" [valueTodos]="null" controlName="data_filtro" [control]="filter!.controls.data_filtro" [items]="DATAS_FILTRO"></input-select>
          <input-datetime [size]="2" noIcon [disabled]="filter!.controls.data_filtro.value == null ? 'true' : undefined" label="Início" controlName="data_inicio" [control]="filter!.controls.data_inicio" labelInfo="Data início do período"></input-datetime>
          <input-datetime [size]="2" noIcon [disabled]="filter!.controls.data_filtro.value == null ? 'true' : undefined" label="Fim" controlName="data_fim" [control]="filter!.controls.data_fim" labelInfo="Data fim do período"></input-datetime>
      </div>
    </filter>
    <columns>
        <column title="#ID" field="numero" orderBy="numero" [minWidth]="50" orderBy="numero"></column>
        <column title="Usuário" [template]="columnUsuario" orderBy="usuario.nome">
            <ng-template let-row="row" #columnUsuario>
                <span> {{row.usuario?.nome || ""}}</span>
            </ng-template>
        </column>
        <column title="Programa" [template]="columnPrograma">
            <ng-template let-row="row" #columnPrograma>
                <span> {{row.programa?.nome || ""}}</span>
            </ng-template>
        </column>
        <column title="Unidade" [template]="columnUnidade">
            <ng-template let-row="row" #columnUnidade>
                <span> {{row.unidade?.nome || ""}}</span>
            </ng-template>
        </column>
        <column title="Modalidade" [template]="columnModalidade">
            <ng-template let-row="row" #columnModalidade>
                <span> {{row.tipo_modalidade?.nome || ""}}</span>
            </ng-template>
        </column>
        <column [titleTemplate]="titleVigencia" [template]="columnInicioVigencia" orderBy="data_inicio_vigencia">
            <ng-template let-header="header" #titleVigencia>
              Vigência de<br><order by="data_inicio_vigencia" [header]="header">Início</order>a<order by="data_fim_vigencia" [header]="header">Fim</order>
            </ng-template>
            <ng-template let-row="row" #columnInicioVigencia>
                <span> {{dao!.getDateFormatted(row.data_inicio_vigencia)+" até "+dao!.getDateFormatted(row.data_fim_vigencia)}}</span>
            </ng-template>
        </column>
        <column title="Termo de adesão" [template]="documento">
            <ng-template let-row="row" #documento>
                <span *ngIf="row.documento?.numero_processo?.length" class="badge bg-light text-dark" [attr.role]="row.documento?.numero_processo?.length ? 'button' : undefined" data-bs-toggle="tooltip" data-bs-placement="top" (click)="onProcessoClick(row)" [title]="allPages.getButtonTitle(row.documento?.numero_processo, row.documento?.numero_documento)">
                    <i [class]="'bi ' + (row.documento?.numero_processo?.length ? 'bi bi-folder-symlink' : 'bi bi-x-lg')"></i>
                    {{row.documento?.numero_processo?.length ? row.documento?.numero_processo : "Não atribuído"}}
                    <small *ngIf="row.documento?.numero_documento?.length"><br>Sei nº {{row.documento?.numero_documento}}</small>
                </span>
            </ng-template>
        </column>
        <column *ngIf="!selectable" type="options" [onEdit]="edit" [options]="options"></column>
    </columns>
    <report>
      <column title="Numero" [template]="reportNumero"><ng-template let-row="row" #reportNumero>{{row.numero}}</ng-template></column>
      <column title="Matricula usuário" [template]="reportMatricula"><ng-template let-row="row" #reportMatricula>{{row.usuario?.matricula || ""}}</ng-template></column>
      <column title="Início vigência" [template]="reportInicioVigencia"><ng-template let-row="row" #reportInicioVigencia>{{util.getDateTimeFormatted(row.data_inicio_vigencia)}}</ng-template></column>
      <!-- Adicionar os outros campos aqui -->
    </report>
    <pagination [rows]="rowsLimit"></pagination>
</grid>
