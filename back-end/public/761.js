"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[761],{3761:(E,u,n)=>{n.r(u),n.d(u,{ListenersModule:()=>P});var v=n(6733),m=n(5579),s=n(8239),p=n(5026),h=n(3972),d=n(922),o=n(755);let f=(()=>{class i extends d.x{constructor(e){super(e,"editor-montar"),this.injector=e,this.documentoDao=e.get(p.d)}ngOnInit(){super.ngOnInit()}documentoPendenteSei(e){var t=this;return(0,s.Z)(function*(){const r=yield t.documentoDao.documentoPendenteSei(e);if(r){const a=yield t.execute("setConteudoDocumento",[0,r.conteudo]);a?.length&&(yield t.documentoDao.update(r.id,{status:h.U.STATUS_GERADO,numero_documento:a}))}})()}loadToolbarButtons(e){var t=this;return(0,s.Z)(function*(){t.gb.toolbarButtons=[]})()}static#e=this.\u0275fac=function(t){return new(t||i)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:i,selectors:[["app-editor-montar"]],features:[o.qOj],decls:2,vars:0,template:function(t,r){1&t&&(o.TgZ(0,"p"),o._uU(1,"editor-montar works!"),o.qZA())}})}return i})(),y=(()=>{class i extends d.x{constructor(e){super(e,"petrvs-listener"),this.injector=e}ngOnInit(){}static#e=this.\u0275fac=function(t){return new(t||i)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:i,selectors:[["app-petrvs-listener"]],features:[o.qOj],decls:2,vars:0,template:function(t,r){1&t&&(o.TgZ(0,"p"),o._uU(1,"petrvs-listener works!"),o.qZA())}})}return i})();var b=n(361);let x=(()=>{class i extends d.x{constructor(e){super(e,"procedimento_escolher_tipo"),this.injector=e,this.tipoProcessoDao=e.get(b.n)}ngOnInit(){super.ngOnInit()}loadToolbarButtons(){var e=this;return(0,s.Z)(function*(){e.gb.toolbarButtons=[{icon:"bi bi-folder-check",color:"btn-outline-primary",hint:"Atualizar tipos de processos",onClick:e.atualizarTiposProcessos.bind(e)}]})()}atualizarTiposProcessos(){var e=this;return(0,s.Z)(function*(){let t=yield e.execute("getTiposProcessos",[]);(yield e.tipoProcessoDao.atualizar(t))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}static#e=this.\u0275fac=function(t){return new(t||i)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:i,selectors:[["app-procedimento-escolher-tipo"]],features:[o.qOj],decls:2,vars:0,template:function(t,r){1&t&&(o.TgZ(0,"p"),o._uU(1,"procedimento-escolher-tipo works!"),o.qZA())}})}return i})();var A=n(949),C=n(5316),T=n(8340),z=n(8543),D=n(9997),g=n(8644);const O=[{path:"editor-montar",component:f},{path:"procedimento-trabalhar",component:(()=>{class i extends d.x{constructor(e){super(e,"procedimento_trabalhar"),this.injector=e,this.dao=e.get(C.i),this.tipoDocumentoDao=e.get(T.Q)}loadToolbarButtons(e){var t=this;return(0,s.Z)(function*(){let r=[];if(e.includes("plano")&&r.push({icon:"bi bi-list-check",color:"btn-outline-primary",hint:"Gerar termo de ades\xe3o",onClick:t.gerarTermoAdesao.bind(t)}),e.includes("entrega")){let a=[];e.includes("concluir_entrega")&&a.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+t.lex.translate("entrega"),onClick:t.concluirEntrega.bind(t)}),r.push({icon:"bi bi-boxes",color:"btn-outline-secondary",hint:"Incluir "+t.lex.translate("entrega"),onClick:t.incluirEntrega.bind(t),items:a.length?a:void 0})}if(e.includes("atualizar")&&r.push({icon:"bi bi-file-check",color:"btn-outline-warning",hint:"Atualizar tipos de documentos",onClick:t.atualizarTiposDocumentos.bind(t)}),e.find(a=>["incluir","concluir","atividades"].includes(a))){let a=[];e.includes("incluir")&&a.push({icon:"bi bi-plus-circle",color:"btn-outline-primary",label:"Incluir "+t.lex.translate("atividade"),onClick:t.incluirAtividade.bind(t)}),e.includes("concluir")&&a.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+t.lex.translate("atividade"),onClick:t.concluirAtividade.bind(t)}),r.push({icon:"bi bi-activity",color:"btn-outline-success",hint:t.lex.translate("atividade"),onClick:t.atividades.bind(t),items:a.length?a:void 0})}t.gb.toolbarButtons=r})()}incluirAtividade(){var e=this;return(0,s.Z)(function*(){let t=yield e.execute("getSeiKeys",[]);t&&e.go.navigate({route:["gestao","atividade","new"]},{metadata:{sei:t},modal:!0})})()}atividades(){var e=this;return(0,s.Z)(function*(){let t=yield e.execute("getProcessoKeys",[]);t&&e.go.navigate({route:["gestao","atividade"],params:{filter:{numero_processo:t.numero_processo}}},{modal:!0,modalWidth:1200})})()}concluirAtividade(){var e=this;return(0,s.Z)(function*(){if(yield e.execute("getDocumentKeys",[])){const r=yield g.N.modalSelect({fixedFilter:[["status","==","INICIADO"]]});r&&(r.metadados?.pausado?(yield e.dialog.confirm("Atividade pausada","Para concluir \xe9 necess\xe1rio primeiro reiniciar a atividade. Deseja reiniciar?"))&&e.go.navigate({route:["gestao","atividade",r.id,"pausar"],params:{reiniciar:!0}},{modal:!0,modalClose:a=>{a?.length&&e.go.navigate({route:["gestao","atividade",r.id,"concluir"]},{modal:!0})}}):e.go.navigate({route:["gestao","atividade",r.id,"concluir"]},{modal:!0}))}})()}concluirEntrega(){var e=this;return(0,s.Z)(function*(){let t=yield e.execute("getProcessoKeys",[]);t&&e.go.navigate({route:["gestao","atividade","entrega","concluir"],params:{id_processo:t.id_processo}},{modal:!0})})()}incluirEntrega(){var e=this;return(0,s.Z)(function*(){let t=yield e.execute("getSeiKeys",[]);if(t){const r=yield g.N.modalSelect({fixedFilter:[["status","==","NAOCONCLUIDO"]]});if(r){const a=new z.l;a.id=e.dao.generateUuid(),a.usuario=e.auth.usuario,a.usuario_id=e.auth.usuario.id,a.atividade_id=r.id||"",a.comentarios=[],a._status="ADD",e.go.navigate({route:["gestao","atividade","tarefa"]},{metadata:{entrega:a,atividade:r,sei:t},modalClose:c=>{c&&(0,s.Z)(function*(){try{const l=e.injector.get(A.n);e.dialog.showSppinerOverlay("Salvando dados do formul\xe1rio"),yield l.save(c)}catch(l){e.dialog.alert("Error",l.message?l.message:l)}finally{e.dialog.closeSppinerOverlay()}})()}})}}})()}gerarTermoAdesao(){var e=this;return(0,s.Z)(function*(){const t=yield D.H.modalSelect();if(t){let r=yield e.execute("getProcessoKeys",[]);e.go.navigate({route:["gestao","plano-trabalho","termo"]},{metadata:{plano:t,processo:r},modalClose:a=>{a?.termo?.length&&(0,s.Z)(function*(){e.dialog.showSppinerOverlay("Gerando documento no sei...");try{const c=yield e.execute("incluirDocumento",[r.id_processo,a.codigo_tipo_documento]);if(c){const l=e.injector.get(p.d),S=Object.assign(new h.U,{especie:"TCR",conteudo:a?.termo,id_processo:r.id_processo,id_documento:c.id_documento,numero_processo:c.numero_processo,plano_trabalho_id:t.id,tipo_documento_id:a.tipo_documento_id,status:"AGUARDANDO_SEI"});yield l.save(S),yield e.execute("recarregarArvore",[c.urlReload]),yield e.execute("abrirEditor",[c.urlEditor,c.idUser])}}catch(c){e.dialog.alert("Error",c.message?c.message:c)}finally{e.dialog.closeSppinerOverlay()}})()}})}})()}atualizarTiposDocumentos(){var e=this;return(0,s.Z)(function*(){let t=yield e.execute("getTiposDocumentos",[]);(yield e.tipoDocumentoDao.atualizar(t))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}static#e=this.\u0275fac=function(t){return new(t||i)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:i,selectors:[["app-procedimento-trabalhar"]],features:[o.qOj],decls:2,vars:0,template:function(t,r){1&t&&(o.TgZ(0,"p"),o._uU(1,"procedimento-trabalhar works!"),o.qZA())}})}return i})()},{path:"procedimento-escolher-tipo",component:x},{path:"petrvs",component:y}];let Z=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=o.oAB({type:i});static#o=this.\u0275inj=o.cJS({imports:[m.Bz.forChild(O),m.Bz]})}return i})(),P=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=o.oAB({type:i});static#o=this.\u0275inj=o.cJS({imports:[v.ez,Z]})}return i})()}}]);