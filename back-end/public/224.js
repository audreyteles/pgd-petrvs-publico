"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[224],{6224:($,v,r)=>{r.r(v),r.d(v,{PreferenciaModule:()=>w});var u=r(6733),g=r(5579),f=r(1391),m=r(2314),l=r(8239),s=r(4040),h=r(1184),c=r(6898),C=r(5255),e=r(755),y=r(5512),Z=r(8820),T=r(2392),U=r(4603),Q=r(6848),x=r(7819),_=r(5560),q=r(2739);const E=["notificacoes"];function A(n,d){1&n&&(e.TgZ(0,"div",10)(1,"div",11),e._UZ(2,"span",12),e.qZA()())}function J(n,d){if(1&n&&(e.TgZ(0,"div",13)(1,"separator",14)(2,"div",3),e._UZ(3,"input-switch",15)(4,"input-switch",16),e.qZA()(),e.TgZ(5,"separator",17),e._UZ(6,"input-select",18),e.qZA()()),2&n){const a=e.oxw();e.xp6(1),e.Q6J("title","Prefer\xeancias de exibi\xe7\xe3o "+a.lex.translate("usu\xe1rio")),e.xp6(2),e.Q6J("size",12)("label","Ocultar menu lateral do sei no Controle de "+a.lex.translate("Processo")),e.xp6(1),e.Q6J("size",12),e.xp6(2),e.Q6J("items",a.lookup.THEMES)}}function D(n,d){if(1&n&&(e.TgZ(0,"separator",19),e._UZ(1,"notificacoes-config",20,21),e.qZA()),2&n){const a=e.oxw();e.xp6(1),e.Q6J("entity",a.entity)("disabled",a.formDisabled)}}let p=(()=>{class n extends h.F{constructor(a){super(a,c.b,C.q),this.injector=a,this.etiquetas=!1,this.carregando=!1,this.toolbarButtons=[{label:"Resetar",icon:"bi bi-backspace",onClick:()=>{this.loading=!0,this.dao.update(this.usuarioId,{config:new c.x}).then(t=>{this.initializeData(this.form)}).finally(()=>{this.loading=!1})}}],this.validate=(t,i)=>null,this.titleEdit=t=>"Editando "+this.lex.translate("Prefer\xeancia")+" "+this.lex.translate("do Usu\xe1rio")+": "+(t?.apelido||""),this.form=this.fh.FormBuilder({etiquetas:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null},theme:{default:null},ocultar_menu_sei:{default:!0},ocultar_container_petrvs:{default:!1}},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}ngOnInit(){super.ngOnInit(),this.urlParams.get("id")&&(this.usuarioId=this.urlParams.get("id")),this.etiquetas=!!this.queryParams.etiquetas}loadData(a,t){var i=this;return(0,l.Z)(function*(){let o=Object.assign({},t.value);o=i.util.fillForm(o,a.config||{}),o=i.util.fillForm(o,a.notificacoes||{}),t.patchValue(o)})()}initializeData(a){var t=this;return(0,l.Z)(function*(){t.carregando=!0;try{t.entity=yield t.dao.getById(t.usuarioId),yield t.loadData(t.entity,a)}finally{t.carregando=!1}})()}saveData(a){return new Promise((t,i)=>{this.notificacoes?.saveData();let o=this.util.fill(new c.x,this.form.value);Promise.all([this.auth.updateUsuarioConfig(this.usuarioId,o),this.auth.updateUsuarioNotificacoes(this.usuarioId,this.entity.notificacoes)]).then(K=>{this.usuarioId==this.auth.usuario.id?this.auth.authSession().then(W=>t(!this.isPanel)).catch(i):t(!this.isPanel)}).catch(i)})}addItemHandleEtiquetas(){let a;const t=this.form.controls.etiqueta_texto.value,i=this.util.textHash(t);return t?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,i)&&(a={key:i,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),a}static#e=this.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["preferencia-form-usuario"]],viewQuery:function(t,i){if(1&t&&(e.Gf(s.Q,5),e.Gf(E,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.editableForm=o.first),e.iGM(o=e.CRH())&&(i.notificacoes=o.first)}},inputs:{panel:"panel",usuarioId:"usuarioId"},features:[e.qOj],decls:12,vars:17,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"buttons"],[3,"form","noButtons","submit","cancel"],[1,"row"],["class","col-md-6",4,"ngIf"],["label","Etiquetas","multiselectStyle","inline","controlName","etiquetas",3,"size","addItemHandle"],["label","Texto","controlName","etiqueta_texto",3,"size"],["label","\xcdcone","icon","fas fa-sign-out-alt","controlName","etiqueta_icone","liveSearch","",3,"size","items"],["label","Cor","controlName","etiqueta_cor",3,"size"],["transparent","","title","Notifica\xe7\xf5es",4,"ngIf"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"col-md-6"],["transparent","",3,"title"],["scale","small","labelPosition","right","controlName","ocultar_menu_sei",3,"size","label"],["scale","small","labelPosition","right","label","Ocultar o container Petrvs","controlName","ocultar_container_petrvs",3,"size"],["transparent","","title","Tema"],["controlName","theme",3,"items"],["transparent","","title","Notifica\xe7\xf5es"],[3,"entity","disabled"],["notificacoes",""]],template:function(t,i){1&t&&(e.YNc(0,A,3,0,"div",0),e.TgZ(1,"div"),e._UZ(2,"toolbar",1),e.TgZ(3,"editable-form",2),e.NdJ("submit",function(){return i.onSaveData()})("cancel",function(){return i.onCancel()}),e.TgZ(4,"div",3),e.YNc(5,J,7,5,"div",4),e.TgZ(6,"div")(7,"input-multiselect",5),e._UZ(8,"input-text",6)(9,"input-select",7)(10,"input-color",8),e.qZA()()(),e.YNc(11,D,3,2,"separator",9),e.qZA()()),2&t&&(e.Q6J("ngIf",i.carregando),e.xp6(1),e.ekj("d-none",i.carregando),e.xp6(1),e.Q6J("buttons",i.toolbarButtons),e.xp6(1),e.Q6J("form",i.form)("noButtons",i.isPanel?"true":void 0),e.xp6(2),e.Q6J("ngIf",!i.etiquetas),e.xp6(1),e.Tol(i.etiquetas?"col-md-12":"col-md-6"),e.xp6(1),e.Q6J("size",12)("addItemHandle",i.addItemHandleEtiquetas.bind(i)),e.xp6(1),e.Q6J("size",5),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",3)("items",i.lookup.ICONES),e.xp6(1),e.Q6J("size",4),e.xp6(1),e.Q6J("ngIf",i.entity&&!i.etiquetas))},dependencies:[u.O5,y.n,s.Q,Z.a,T.m,U.p,Q.z,x.p,_.N,q.y]})}return n})();var N=r(929),b=r(2469),z=r(5316);function S(n,d){1&n&&(e.TgZ(0,"div",2)(1,"div",3),e._UZ(2,"span",4),e.qZA()())}let P=(()=>{class n extends h.F{constructor(a){super(a,b.H,z.i),this.injector=a,this.carregando=!1,this.validate=(t,i)=>null,this.titleEdit=t=>"Editando "+this.lex.translate("Prefer\xeancia")+" "+this.lex.translate("da Entidade")+": "+(t?.nome||""),this.form=this.fh.FormBuilder({},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}loadData(a,t){var i=this;return(0,l.Z)(function*(){let o=Object.assign({},t.value);t.patchValue(i.util.fillForm(o,a))})()}initializeData(a){var t=this;return(0,l.Z)(function*(){t.carregando=!0;try{t.entity=new b.H,yield t.loadData(t.entity,a)}finally{t.carregando=!1}})()}saveData(a){return new Promise((t,i)=>{t(!this.isPanel)})}static#e=this.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["preferencia-form-petrvs"]],viewQuery:function(t,i){if(1&t&&e.Gf(s.Q,5),2&t){let o;e.iGM(o=e.CRH())&&(i.editableForm=o.first)}},inputs:{panel:"panel"},features:[e.qOj],decls:4,vars:5,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"form","noButtons","submit","cancel"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,i){1&t&&(e.YNc(0,S,3,0,"div",0),e.TgZ(1,"div")(2,"editable-form",1),e.NdJ("submit",function(){return i.onSaveData()})("cancel",function(){return i.onCancel()}),e._uU(3," Em desenvolvimento "),e.qZA()()),2&t&&(e.Q6J("ngIf",i.carregando),e.xp6(1),e.ekj("d-none",i.carregando),e.xp6(1),e.Q6J("form",i.form)("noButtons",i.isPanel?"true":void 0))},dependencies:[u.O5,s.Q]})}return n})();var I=r(6384),F=r(4978);function O(n,d){if(1&n&&(e.TgZ(0,"tab",9),e._uU(1," Em desenvolvimento "),e.qZA()),2&n){const a=e.oxw();e.Q6J("label",a.lex.translate("Entidade"))}}let B=(()=>{class n extends N._{constructor(a){super(a),this.injector=a,this.mensagemCarregando="Carregando dados do formul\xe1rio...",this.mensagemSalvando="Salvando dados do formul\xe1rio...",this.form=this.fh.FormBuilder({})}get forceInvalid(){return!!this.petrvs?.form?.invalid||!!this.usuario?.form?.invalid}onSaveData(){var a=this;return(0,l.Z)(function*(){if(a.forceInvalid)a.petrvs?.form?.invalid||(a.editableForm.error="Form Petrvs com erro"),a.usuario?.form?.invalid||(a.editableForm.error="Form do usu\xe1rio com erro");else{a.submitting=!0;try{yield Promise.all([a.petrvs?.onSaveData(),a.usuario?.onSaveData()]),a.dialog.alert("Aten\xe7\xe3o","Algumas modifica\xe7\xf5es s\xf3 surtir\xe3o efeito ap\xf3s atualizar a p\xe1gina.\nPor motivos de seguran\xe7a esse procedimento, de atualizar a pagina, dever\xe1 ser executado pelo usu\xe1rio."),a.go.back()}catch(t){a.editableForm.error=t.message?t.message:t}finally{a.submitting=!1}}})()}onCancel(){this.close()}static#e=this.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-preferencia-form"]],viewQuery:function(t,i){if(1&t&&(e.Gf(s.Q,5),e.Gf(P,5),e.Gf(p,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.editableForm=o.first),e.iGM(o=e.CRH())&&(i.petrvs=o.first),e.iGM(o=e.CRH())&&(i.usuario=o.first)}},features:[e.qOj],decls:9,vars:6,consts:[[3,"form","forceInvalid","title","submit","cancel"],["display","","right",""],["key","USUARIO",3,"label"],["panel","",3,"usuarioId"],["usuario",""],["key","PETRVS","label","Petrvs"],["panel",""],["petrvs",""],["key","ENTIDADE",3,"label",4,"ngIf"],["key","ENTIDADE",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"editable-form",0),e.NdJ("submit",function(){return i.onSaveData()})("cancel",function(){return i.onCancel()}),e.TgZ(1,"tabs",1)(2,"tab",2),e._UZ(3,"preferencia-form-usuario",3,4),e.qZA(),e.TgZ(5,"tab",5),e._UZ(6,"preferencia-form-petrvs",6,7),e.qZA(),e.YNc(8,O,2,1,"tab",8),e.qZA()()),2&t&&(e.Q6J("form",i.form)("forceInvalid",i.forceInvalid)("title",i.isModal?"":i.title),e.xp6(2),e.Q6J("label",i.lex.translate("Usu\xe1rio")),e.xp6(1),e.Q6J("usuarioId",i.auth.usuario.id),e.xp6(5),e.Q6J("ngIf",i.auth.entidade))},dependencies:[u.O5,s.Q,I.n,F.i,P,p]})}return n})();var R=r(1214),G=r(3937);function j(n,d){1&n&&(e.TgZ(0,"div",6)(1,"div",7),e._UZ(2,"span",8),e.qZA()())}const M=[{path:"",component:B,canActivate:[f.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias"}},{path:"usuario/:id",component:p,canActivate:[f.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias do Usu\xe1rio"}},{path:"unidade/:id",component:(()=>{class n extends h.F{constructor(a){super(a,G.b,R.J),this.injector=a,this.etiquetas=!1,this.carregando=!1,this.toolbarButtons=[{label:"Resetar",icon:"bi bi-backspace",onClick:()=>{this.loading=!0,this.dao.update(this.usuarioId,{config:new c.x}).then(t=>{this.initializeData(this.form)}).finally(()=>{this.loading=!1})}}],this.validate=(t,i)=>null,this.form=this.fh.FormBuilder({etiquetas:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null},theme:{default:null},ocultar_menu_sei:{default:!0},ocultar_container_petrvs:{default:!1}},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}ngOnInit(){super.ngOnInit(),this.urlParams.get("id")&&(this.usuarioId=this.urlParams.get("id")),this.etiquetas=!!this.queryParams.etiquetas}loadData(a,t){return(0,l.Z)(function*(){let i=Object.assign({},t.value);t.patchValue(i)})()}initializeData(a){var t=this;return(0,l.Z)(function*(){t.carregando=!0;try{t.entity=yield t.dao.getById(t.usuarioId),yield t.loadData(t.entity,a)}finally{t.carregando=!1}})()}saveData(a){return new Promise((t,i)=>{let o=this.util.fill(new c.x,this.form.value);Promise.all([this.auth.updateUsuarioConfig(this.usuarioId,o),this.auth.updateUsuarioNotificacoes(this.usuarioId,this.entity.notificacoes)]).then(K=>{this.usuarioId==this.auth.usuario.id?this.auth.authSession().then(W=>t(!this.isPanel)).catch(i):t(!this.isPanel)}).catch(i)})}addItemHandleEtiquetas(){let a;const t=this.form.controls.etiqueta_texto.value,i=this.util.textHash(t);return t?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,i)&&(a={key:i,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),a}static#e=this.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-preferencia-form-unidade"]],viewQuery:function(t,i){if(1&t&&e.Gf(s.Q,5),2&t){let o;e.iGM(o=e.CRH())&&(i.editableForm=o.first)}},inputs:{panel:"panel",usuarioId:"usuarioId"},features:[e.qOj],decls:7,vars:7,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"buttons"],[3,"title","form","disabled","submit","cancel"],["display","","right",""],["key","ETIQUETAS","label","Etiquetas"],["key","ATRIBUICOES","label","Atribui\xe7\xf5es"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,i){1&t&&(e.YNc(0,j,3,0,"div",0),e.TgZ(1,"div"),e._UZ(2,"toolbar",1),e.TgZ(3,"editable-form",2),e.NdJ("submit",function(){return i.onSaveData()})("cancel",function(){return i.onCancel()}),e.TgZ(4,"tabs",3),e._UZ(5,"tab",4)(6,"tab",5),e.qZA()()()),2&t&&(e.Q6J("ngIf",i.carregando),e.xp6(1),e.ekj("d-none",i.carregando),e.xp6(1),e.Q6J("buttons",i.toolbarButtons),e.xp6(1),e.Q6J("title",i.isModal?"":i.title)("form",i.form)("disabled",i.formDisabled))},dependencies:[u.O5,y.n,s.Q,I.n,F.i]})}return n})(),canActivate:[f.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias da Unidade"}}];let V=(()=>{class n{static#e=this.\u0275fac=function(t){return new(t||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[g.Bz.forChild(M),g.Bz]})}return n})();var Y=r(2662),X=r(2133),L=r(2864);let w=(()=>{class n{static#e=this.\u0275fac=function(t){return new(t||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[u.ez,Y.K,X.UX,V,L.UteisModule]})}return n})()}}]);