{"version":3,"file":"9242.js","mappings":";;;;;;;;;;;;;;;AAA0D;AAKpD,MAAOC,qBAAsB,SAAQD,6CAAI;EAY3CE,YAAmBC,IAAU;IAAI,KAAK,EAAE;IAXjC,KAAAC,EAAE,GAAW,EAAE,CAAC,CAAC;IASjB,KAAAC,WAAW,GAA2B,EAAE;IAEL,IAAI,CAACC,cAAc,CAACH,IAAI,CAAC;EAAE;;AACxE;AAEK,MAAOI,iBAAkB,SAAQP,6CAAI;EAevCE,YAAmBC,IAAU;IAAI,KAAK,EAAE;IALjC,KAAAE,WAAW,GAAkC,EAAE;IAE/C,KAAAG,UAAU,GAAW,EAAE,CAAC,CAAC;IACzB,KAAAC,UAAU,GAAW,EAAE,CAAC,CAAC;IAEU,IAAI,CAACH,cAAc,CAACH,IAAI,CAAC;EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjCwB;AAC/B;AACe;AACb;AACA;AAEb;AACY;AAC6B;AAEP;AACU;;;;;;;;;;;;;;;AAQ7F,MAAOgB,oBAAqB,SAAQH,6EAAwC;EAYhFd,YAAmBkB,QAAkB;IACnC,KAAK,CAACA,QAAQ,EAAEL,iEAAO,EAAED,8EAAiB,CAAC;IAD1B,KAAAM,QAAQ,GAARA,QAAQ;IAuCpB,KAAAC,QAAQ,GAAG,CAACC,OAAwB,EAAEC,WAAmB,KAAI;MAClE,IAAIC,MAAM,GAAG,IAAI;MACjB,IAAID,WAAW,IAAI,KAAK,IAAI,CAAC,IAAI,CAACE,IAAI,CAACC,UAAU,CAACJ,OAAO,CAACK,KAAK,CAAC,EAAE;QAChEH,MAAM,GAAG,UAAU;;MAErB,IAAG,CAAC,iBAAiB,CAAC,CAACI,OAAO,CAACL,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAACM,GAAG,EAAEC,aAAa,CAACR,OAAO,CAACK,KAAK,CAAC,EAAE;QAC3FH,MAAM,GAAG,UAAU;;MAErB,OAAOA,MAAM;IACf,CAAC;IAEM,KAAAO,cAAc,GAAIC,IAAgB,IAAI;MAC3C,IAAI,CAAC,IAAI,CAACC,WAAW,EAAEC,QAAQ,CAACC,kBAAkB,CAACR,KAAK,EAAES,MAAM,EAAE;QAChE,OAAO,8DAA8D;;MAEvE,MAAMC,iBAAiB,GAAG,EAAE;MAC5B,IAAI,CAACC,mBAAmB,EAAEC,IAAI,EAAEC,KAAK,CAACC,OAAO,CAAEC,iBAAiB,IAAI;QAClE,IAAIA,iBAAiB,CAACjC,UAAU,IAAI,EAAE,EAAE4B,iBAAiB,CAACM,IAAI,CAAC;UAAEC,UAAU,EAAEF,iBAAiB;UAAEG,IAAI,EAAE;QAAkB,CAAE,CAAC;MAC7H,CAAC,CAAC;MACF,IAAIR,iBAAiB,CAACD,MAAM,EAAE,OAAO,+EAA+E;MACpH,OAAOU,SAAS;IAClB,CAAC;IAsDM,KAAAC,SAAS,GAAIC,MAAe,IAAY;MAC7C,OAAO,WAAW,GAAG,IAAI,CAACC,GAAG,CAACC,SAAS,CAAC,SAAS,CAAC,GAAG,IAAI,IAAIF,MAAM,EAAEG,IAAI,IAAI,EAAE,CAAC;IAClF,CAAC;IAlHC,IAAI,CAACC,SAAS,GAAGhC,QAAQ,CAACiC,GAAG,CAAmB1C,4EAAgB,CAAC;IACjE,IAAI,CAAC2C,UAAU,GAAGlC,QAAQ,CAACiC,GAAG,CAAoBxC,8EAAiB,CAAC;IACpE,IAAI,CAAC0C,aAAa,GAAGnC,QAAQ,CAACiC,GAAG,CAA8BnC,mGAA2B,CAAC;IAC3F,IAAI,CAACsC,gBAAgB,GAAGpC,QAAQ,CAACiC,GAAG,CAA0BzC,2FAAuB,CAAC;IACtF,IAAI,CAACoB,IAAI,GAAG,IAAI,CAACyB,EAAE,CAACC,WAAW,CAAC;MAC9BC,KAAK,EAAE;QAAEC,OAAO,EAAE;MAAE,CAAE;MACtBT,IAAI,EAAE;QAAES,OAAO,EAAE;MAAE,CAAE;MACrBC,GAAG,EAAE;QAAED,OAAO,EAAE;MAAE,CAAE;MACpBE,SAAS,EAAE;QAAEF,OAAO,EAAE;MAAE,CAAE;MAC1BG,OAAO,EAAE;QAAEH,OAAO,EAAE;MAAE,CAAE;MACxBI,QAAQ,EAAE;QAAEJ,OAAO,EAAE;MAAE,CAAE;MACzBK,EAAE,EAAE;QAAEL,OAAO,EAAE;MAAE,CAAE;MACnBM,IAAI,EAAE;QAAEN,OAAO,EAAE;MAAI,CAAE;MACvBO,QAAQ,EAAE;QAAEP,OAAO,EAAE;MAAE,CAAE;MACzBQ,wBAAwB,EAAE;QAAER,OAAO,EAAE;MAAE,CAAE;MACzCS,SAAS,EAAE;QAAET,OAAO,EAAE;MAAI,CAAE;MAC5BU,eAAe,EAAE;QAAEV,OAAO,EAAE;MAAI;KACjC,EAAE,IAAI,CAACW,KAAK,EAAE,IAAI,CAAClD,QAAQ,CAAC;IAC7B,IAAI,CAACY,WAAW,GAAG,IAAI,CAACwB,EAAE,CAACC,WAAW,CAAC;MACrCvB,kBAAkB,EAAE;QAAEyB,OAAO,EAAE;MAAE;KAClC,EAAE,IAAI,CAACW,KAAK,EAAE,IAAI,CAAClD,QAAQ,CAAC;IAC7B,IAAI,CAACmD,YAAY,GAAG,IAAI,CAAChB,gBAAgB,CAACiB,OAAO,EAAE;IACnD,IAAI,CAACC,IAAI,GAAG,CAAC,oBAAoB,CAAC;EACpC;EAEaC,QAAQA,CAAC3B,MAAe,EAAEhB,IAAe;IAAA,IAAA4C,KAAA;IAAA,OAAAC,mHAAA;MACpD,IAAIC,SAAS,GAAGC,MAAM,CAACC,MAAM,CAAC,EAAE,EAAEhD,IAAI,CAACL,KAAK,CAAC;MAC7CK,IAAI,CAACiD,UAAU,CAACL,KAAI,CAACnD,IAAI,CAACyD,QAAQ,CAACJ,SAAS,EAAE9B,MAAM,CAAC,CAAC;MACtD4B,KAAI,CAAC3C,WAAW,CAACC,QAAQ,CAACC,kBAAkB,CAACgD,QAAQ,CAACnC,MAAM,CAACoC,OAAO,EAAEC,OAAO,EAAEjF,EAAE,CAAC;MAClF,MAAMwE,KAAI,CAACtC,mBAAmB,EAAEqC,QAAQ,CAAC3B,MAAM,CAAC;IAAC;EACnD;EAEOsC,cAAcA,CAACtD,IAAe;IACnC,IAAI,CAACgB,MAAM,GAAG,IAAIjC,iEAAO,EAAE;IAC3B,IAAI,CAAC4D,QAAQ,CAAC,IAAI,CAAC3B,MAAM,EAAEhB,IAAI,CAAC;EAClC;EAyBOuD,QAAQA,CAACvD,IAAgB;IAAA,IAAAwD,MAAA;IAC9B,OAAO,IAAIC,OAAO;MAAA,IAAAC,IAAA,GAAAb,mHAAA,CAAU,WAAOc,OAAO,EAAEC,MAAM,EAAI;QACpDJ,MAAI,CAAClD,mBAAoB,CAACC,IAAK,CAACsD,OAAO,EAAE;QACzC,IAAIC,OAAO,GAAGN,MAAI,CAAC/D,IAAI,CAACsE,IAAI,CAAC,IAAIhF,iEAAO,EAAE,EAAEyE,MAAI,CAACxC,MAAO,CAAC;QACzD8C,OAAO,GAAGN,MAAI,CAAC/D,IAAI,CAACyD,QAAQ,CAACY,OAAO,EAAEN,MAAI,CAACxD,IAAK,CAACL,KAAK,CAAC;QACvDmE,OAAO,CAACE,UAAU,GAAGR,MAAI,CAACvD,WAAW,EAAEC,QAAQ,CAACC,kBAAkB,CAACR,KAAK;QACxE,IAAIsE,uBAAuB,GAA4BT,MAAI,CAAClD,mBAAmB,EAAEE,KAAK,IAAI,EAAE;QAC5F,IAAI0D,yBAAyB,GAAa,EAAE;QAC5CD,uBAAuB,CAACE,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,OAAO,IAAI,QAAQ,CAAC,CAAC5D,OAAO,CAAC,CAAC2D,CAAC,EAACE,CAAC,KAAKJ,yBAAyB,CAACvD,IAAI,CAAC2D,CAAC,CAAC,CAAC;QAC9G,IAAIC,oBAAoB,GAAGN,uBAAuB,CAACO,SAAS,CAACC,EAAE,IAAIA,EAAE,CAACpG,WAAW,CAACqG,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACrG,IAAIC,eAAe,GAAYJ,oBAAoB,IAAI,CAAC,CAAC,IAAIT,OAAO,CAACE,UAAU,IAAIC,uBAAuB,CAACM,oBAAoB,CAAC,CAAC9F,UAAU;QAC3I;;;;;;;;;;QAUA,IAAImG,eAAe,GAAYL,oBAAoB,IAAI,CAAC,CAAC,IAAIN,uBAAuB,CAACM,oBAAoB,CAAC,CAAClG,WAAW,CAACqG,QAAQ,CAAC,QAAQ,CAAC;QACzI,IAAGC,eAAe,IAAIC,eAAe,EAAE;UACrCpB,MAAI,CAACqB,UAAU,GAAG,KAAK;UACvB,MAAMrB,MAAI,CAACsB,MAAM,CAACC,KAAK,CAAC,8BAA8B,EAAE,+HAA+H,CAAC;UACxLnB,MAAM,CAAC,KAAK,CAAC;SACd,MAAM;UACL,IAAI;YACF,MAAMJ,MAAI,CAAC3D,GAAG,EAAEmF,IAAI,CAACjC,MAAM,CAACC,MAAM,CAACc,OAAO,EAAE;cAAC,YAAY,EAAEN,MAAI,CAACvD,WAAW,EAAEC,QAAQ,CAACC,kBAAkB,CAACR;YAAK,CAAC,CAAC,CAAC,CAACsF,IAAI;cAAA,IAAAC,KAAA,GAAArC,mHAAA,CAAC,WAAMsC,YAAY,EAAG;gBAC1I,IAAIR,eAAe,EAAE;kBAAK;kBACxB,IAAGJ,oBAAoB,IAAI,CAAC,CAAC,EAAEN,uBAAuB,CAACM,oBAAoB,CAAC,CAAClG,WAAW,GAAG4F,uBAAuB,CAACM,oBAAoB,CAAC,CAAClG,WAAW,CAAC8F,MAAM,CAACC,CAAC,IAAIA,CAAC,IAAI,QAAQ,CAAC;kBAC/K,IAAIgB,wBAAwB,GAAGnB,uBAAuB,CAACO,SAAS,CAACC,EAAE,IAAIA,EAAE,CAAChG,UAAU,IAAIqF,OAAO,CAACE,UAAU,CAAC;kBAC3GoB,wBAAwB,IAAI,CAAC,CAAC,GAAGnB,uBAAuB,CAACtD,IAAI,CAACoC,MAAM,CAACC,MAAM,CAAC,IAAI/E,2FAAqB,EAAG,EAAE;oBAAEQ,UAAU,EAAEqF,OAAO,CAACE,UAAU;oBAAExF,UAAU,EAAE2G,YAAY,CAAC/G,EAAE;oBAAEC,WAAW,EAAE,CAAC,QAAQ;kBAAC,CAAE,CAAC,CAAC,GAAG4F,uBAAuB,CAACmB,wBAAwB,CAAC,CAAC/G,WAAW,CAACsC,IAAI,CAAC,QAAQ,CAAC;kBACnR4D,oBAAoB,GAAGN,uBAAuB,CAACO,SAAS,CAACC,EAAE,IAAIA,EAAE,CAACpG,WAAW,CAACqG,QAAQ,CAAC,QAAQ,CAAC,CAAC;;gBAEnG;gBACAR,yBAAyB,CAACzD,OAAO,CAAC6D,CAAC,IAAG;kBACpC;kBACA,IAAGA,CAAC,IAAIC,oBAAoB,EAAEN,uBAAuB,CAACK,CAAC,CAAC,CAACjG,WAAW,GAAG,EAAE;gBAC3E,CAAC,CAAC;gBACF4F,uBAAuB,CAACxD,OAAO,CAACgE,EAAE,IAAIA,EAAE,CAACjG,UAAU,GAAG2G,YAAY,CAAC/G,EAAE,CAAC;gBACtE,MAAMoF,MAAI,CAACjC,aAAa,CAAC8D,cAAc,CAACpB,uBAAkD,CAAC;cAC7F,CAAC;cAAA,iBAAAqB,GAAA;gBAAA,OAAAJ,KAAA,CAAAK,KAAA,OAAAC,SAAA;cAAA;YAAA,IAAC;YACF7B,OAAO,CAAC,IAAI,CAAC;WACd,CAAC,OAAO8B,KAAU,EAAE;YACnB,IAAIjC,MAAI,CAACkC,YAAY,EAAElC,MAAI,CAACkC,YAAY,CAACD,KAAK,GAAGA,KAAK;YACtDjC,MAAI,CAACqB,UAAU,GAAG,KAAK;;;MAG7B,CAAC;MAAA,iBAAAc,EAAA,EAAAC,GAAA;QAAA,OAAAlC,IAAA,CAAA6B,KAAA,OAAAC,SAAA;MAAA;IAAA,IAAC;EACJ;EAAC,QAAAK,CAAA;qBA5HU1G,oBAAoB,EAAA2G,gEAAA,CAAAA,oDAAA;EAAA;EAAA,QAAAG,EAAA;UAApB9G,oBAAoB;IAAA+G,SAAA;IAAAC,SAAA,WAAAC,2BAAAC,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;mEACpB3H,2GAAqB;mEACrBO,wGAA0B;;;;;;;;;;;;;;;;QCvBvC6G,6DAAA,uBAAwJ;QAA9CA,yDAAA,oBAAAW,8DAAA;UAAA,OAAUH,GAAA,CAAAI,UAAA,EAAY;QAAA,EAAC,oBAAAC,8DAAA;UAAA,OAAWL,GAAA,CAAAM,QAAA,EAAU;QAAA,EAArB;QAC7Hd,6DAAA,cAAoB;QAIJA,wDAAA,yBAAmG;QACvGA,2DAAA,EAAM;QACNA,6DAAA,aAAiC;QAEzBA,wDAAA,oBAA2M;QAI/MA,2DAAA,EAAM;QACNA,6DAAA,cAAiB;QACbA,wDAAA,sBAAkG;QAEtGA,2DAAA,EAAM;QACNA,6DAAA,cAAiB;QACbA,wDAAA,wBAAyL;QAE7LA,2DAAA,EAAM;QACNA,6DAAA,cAAiB;QACbA,wDAAA,wBAA0G;QAG9GA,2DAAA,EAAM;QAIlBA,6DAAA,eAA+C;QAEvCA,wDAAA,wBAAkK;QACtKA,2DAAA,EAAM;QAEVA,6DAAA,eAA8D;QAC1DA,wDAAA,qBAAmJ;QAEvJA,2DAAA,EAAM;;;QAtCCA,yDAAA,SAAAQ,GAAA,CAAAtG,IAAA,CAAc,aAAAsG,GAAA,CAAAU,YAAA,WAAAV,GAAA,CAAAW,OAAA,QAAAX,GAAA,CAAAY,KAAA;QAKQpB,wDAAA,GAAqC;QAArCA,yDAAA,QAAAQ,GAAA,CAAAtG,IAAA,CAAAE,QAAA,CAAAiC,QAAA,CAAAxC,KAAA,CAAqC;QAItCmG,wDAAA,GAA2E;QAA3EA,yDAAA,cAAAQ,GAAA,CAAAc,IAAA,CAAAC,eAAA,gCAAAvG,SAAA,CAA2E;QAA0EgF,0DAAA,iBAAmB;QACxKA,wDAAA,GAA2E;QAA3EA,yDAAA,cAAAQ,GAAA,CAAAc,IAAA,CAAAC,eAAA,gCAAAvG,SAAA,CAA2E;QAAsDgF,0DAAA,kBAAoB;QACrJA,wDAAA,GAA4E;QAA5EA,yDAAA,cAAAQ,GAAA,CAAAc,IAAA,CAAAC,eAAA,iCAAAvG,SAAA,CAA4E;QAAgEgF,0DAAA,kBAAoB;QACvJA,wDAAA,GAAU;QAAVA,yDAAA,WAAU;QAGnBA,wDAAA,GAAU;QAAVA,yDAAA,WAAU;QAAiCA,0DAAA,kBAAoB;QAC/DA,wDAAA,GAAU;QAAVA,yDAAA,WAAU;QAAuCA,0DAAA,kBAAoB;QAGnEA,wDAAA,GAA8E;QAA9EA,yDAAA,cAAAQ,GAAA,CAAAc,IAAA,CAAAC,eAAA,mCAAAvG,SAAA,CAA8E,mBAAAwF,GAAA,CAAAlF,SAAA;QACrD0E,wDAAA,GAAU;QAAVA,yDAAA,WAAU,gCAAAQ,GAAA,CAAArG,WAAA,CAAAC,QAAA,CAAAC,kBAAA,SAAAmG,GAAA,CAAAhF,UAAA;QAGnCwE,wDAAA,GAAU;QAAVA,yDAAA,WAAU,UAAAQ,GAAA,CAAAiB,MAAA,CAAAC,EAAA;QACX1B,wDAAA,GAAU;QAAVA,yDAAA,WAAU,UAAAQ,GAAA,CAAAiB,MAAA,CAAAE,IAAA;QACX3B,wDAAA,GAAU;QAAVA,yDAAA,WAAU;QAA2FA,0DAAA,kBAAoB;QAO/HA,wDAAA,GAAoE;QAApEA,yDAAA,kCAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,sBAAoE,YAAAoF,GAAA,CAAA9D,YAAA;QAGnEsD,wDAAA,GAAsC;QAAtCA,yDAAA,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,0BAAsC;QACjC4E,wDAAA,GAA8G;QAA9GA,yDAAA,uCAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,yFAA8G;QACnF4E,wDAAA,GAAiB;QAAjBA,yDAAA,WAAAQ,GAAA,CAAAtF,MAAA,CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCT;AAEH;AACqB;AAIpB;AAEG;AACJ;;;;;;;;;;;;;;ICVhE8E,6DAAA,WAA2B;IAAQA,qDAAA,GAAiC;IAAAA,2DAAA,EAAS;;;;IAA1CA,wDAAA,GAAiC;IAAjCA,gEAAA,iBAAAiC,MAAA,CAAA/G,MAAA,kBAAA+G,MAAA,CAAA/G,MAAA,CAAAG,IAAA,EAAiC;;;;;IACpE2E,wDAAA,oBAAyN;;;;IAA5KA,yDAAA,8BAAAkC,MAAA,CAAA/G,GAAA,CAAAC,SAAA,iHAAA8G,MAAA,CAAA/G,GAAA,CAAAC,SAAA,0BAA+J;;;;;IAIhM4E,6DAAA,aAAQ;IAAAA,qDAAA,GAA6B;IAAAA,2DAAA,EAAS;IAAAA,6DAAA,WAAM;IAACA,qDAAA,GAA0F;IAAAA,2DAAA,EAAO;IAAAA,wDAAA,SAAI;IAC1JA,6DAAA,WAAM;IAAAA,qDAAA,GAA6B;IAAAA,2DAAA,EAAO;;;;IADlCA,wDAAA,GAA6B;IAA7BA,gEAAA,CAAAmC,OAAA,CAAAC,aAAA,OAA6B;IAAgBpC,wDAAA,GAA0F;IAA1FA,iEAAA,MAAAmC,OAAA,CAAAG,QAAA,8CAAAH,OAAA,CAAAI,cAAA,kBAA0F;IACzIvC,wDAAA,GAA6B;IAA7BA,iEAAA,KAAAmC,OAAA,CAAAK,YAAA,YAA6B;;;;;IAGnCxC,wDAAA,2BAAyG;;;;IAAlFA,yDAAA,YAAW,QAAAyC,MAAA,CAAAjH,UAAA;;;;;IAKlCwE,6DAAA,UAAuC;IACnCA,wDAAA,gBAAsN;IAC1NA,2DAAA,EAAM;;;;;IADKA,wDAAA,GAAkE;IAAlEA,yDAAA,UAAA0C,OAAA,CAAAjB,MAAA,CAAAkB,QAAA,CAAAD,OAAA,CAAAjB,MAAA,CAAAmB,uBAAA,EAAAC,KAAA,QAAkE,SAAAH,OAAA,CAAAjB,MAAA,CAAAqB,OAAA,CAAAJ,OAAA,CAAAjB,MAAA,CAAAmB,uBAAA,EAAAC,KAAA,kBAAAH,OAAA,CAAAjB,MAAA,CAAAsB,QAAA,CAAAL,OAAA,CAAAjB,MAAA,CAAAmB,uBAAA,EAAAC,KAAA;;;;;IAD7E7C,yDAAA,IAAAiD,wDAAA,kBAEM;;;;IAFajD,yDAAA,YAAAkD,OAAA,CAAA3K,WAAA,CAAkB;;;;;IAKrCyH,6DAAA,4BAAoJ;IAChJA,wDAAA,uBAAgI;IACpIA,2DAAA,EAAoB;;;;IAFyBA,yDAAA,WAAU,kBAAAmD,OAAA,CAAAC,aAAA,CAAAC,IAAA,CAAAF,OAAA,uBAAAA,OAAA,CAAAG,gBAAA,CAAAD,IAAA,CAAAF,OAAA;IACrCnD,wDAAA,GAAW;IAAXA,yDAAA,YAAW,UAAAmD,OAAA,CAAAI,eAAA;;;ADHvC,MAAOpK,0BAA2B,SAAQ0I,+EAAa;EAG3D,IAAarI,OAAOA,CAACK,KAAkC;IAAI,KAAK,CAACL,OAAO,GAAGK,KAAK;EAAE;EAAE,IAAIL,OAAOA,CAAA;IAAkC,OAAO,KAAK,CAACA,OAAO;EAAE;EACvJ,IAAa0B,MAAMA,CAACrB,KAA0B;IAAI,KAAK,CAACqB,MAAM,GAAGrB,KAAK;EAAE;EAAE,IAAIqB,MAAMA,CAAA;IAA0B,OAAO,KAAK,CAACA,MAAM;EAAE;EACnI,IAAasI,SAASA,CAAC3J,KAAyB;IAAI,KAAK,CAAC2J,SAAS,GAAG3J,KAAK;EAAE;EAAE,IAAI2J,SAASA,CAAA;IAAyB,OAAO,KAAK,CAACA,SAAS;EAAE;EAS7IpL,YAAmBkB,QAAkB;IACnC,KAAK,CAACA,QAAQ,CAAC;IADE,KAAAA,QAAQ,GAARA,QAAQ;IAPpB,KAAAoB,KAAK,GAA4B,EAAE;IAKnC,KAAA6I,eAAe,GAAiB,EAAE;IAoDlC,KAAAhK,QAAQ,GAAG,CAACC,OAAwB,EAAEC,WAAmB,KAAI;MAClE,IAAIC,MAAM,GAAG,IAAI;MACjB,IAAI,CAAC,YAAY,EAAE,aAAa,CAAC,CAACkF,QAAQ,CAACnF,WAAW,CAAC,IAAI,CAACD,OAAO,CAACK,KAAK,EAAES,MAAM,EAAE;QAAEZ,MAAM,GAAG,aAAa;;MAC3G,IAAID,WAAW,IAAI,YAAY,IAAI,IAAI,CAACgB,IAAI,EAAEgJ,MAAM,IAAI,IAAI,CAAC/I,KAAK,CAACgJ,GAAG,CAAClF,CAAC,IAAIA,CAAC,CAAClG,EAAE,CAAC,CAACsG,QAAQ,CAACpF,OAAO,CAACK,KAAK,CAAC,EAAEH,MAAM,GAAG,oFAAoF;MACxM,OAAOA,MAAM;IACf,CAAC;IAEM,KAAAO,cAAc,GAAIC,IAAgB,IAAI;MAC3C,IAAI3B,WAAW,GAAiB2B,IAAK,CAACE,QAAQ,CAAC7B,WAAW,CAACsB,KAAK;MAChE,IAAI,IAAI,CAACF,IAAI,CAACgK,UAAU,CAAC,CAAC,QAAQ,EAAE,mBAAmB,EAAE,iBAAiB,CAAC,EAAEpL,WAAW,CAACmL,GAAG,CAACE,EAAE,IAAIA,EAAE,CAACC,GAAG,CAAC,IAAI,EAAE,CAAC,CAACvJ,MAAM,GAAG,CAAC,EAAE;QAC5H,OAAO,yFAAyF;;MAElG,OAAOU,SAAS;IAClB,CAAC;IA7DC,IAAI,CAAC8I,iBAAiB,GAAGxK,QAAQ,CAACiC,GAAG,CAAoBuG,kFAAiB,CAAC;IAC3E,IAAI,CAACrG,aAAa,GAAGnC,QAAQ,CAACiC,GAAG,CAA8BnC,mGAA2B,CAAC;IAC3F,IAAI,CAACoC,UAAU,GAAGlC,QAAQ,CAACiC,GAAG,CAAoBxC,8EAAiB,CAAC;IACpE,IAAI,CAACgL,UAAU,GAAGzK,QAAQ,CAACiC,GAAG,CAAoBvC,8EAAiB,CAAC;IACpE,IAAI,CAACkB,IAAI,GAAG,IAAI,CAACyB,EAAE,CAACC,WAAW,CAAC;MAC9BjD,UAAU,EAAE;QAAEmD,OAAO,EAAE;MAAE,CAAE;MAC3BvD,WAAW,EAAE;QAAEuD,OAAO,EAAEd;MAAS,CAAE;MACnCgJ,UAAU,EAAE;QAAElI,OAAO,EAAE;MAAE;KAC1B,EAAE,IAAI,CAACW,KAAK,EAAE,IAAI,CAAClD,QAAQ,CAAC;EAC/B;EAEA0K,QAAQA,CAAA;IACN,KAAK,CAACA,QAAQ,EAAE;IAChB,IAAI,CAACC,SAAS,GAAG,IAAI,CAACC,QAAQ,EAAED,SAAS,IAAI,IAAI,CAAChJ,MAAM,EAAE5C,EAAE;IAC5D,IAAI,CAACiL,eAAe,GAAG,IAAI,CAACa,WAAW,GAAG,IAAI,CAAC3C,MAAM,CAACmB,uBAAuB,CAACvE,MAAM,CAAE2F,UAAU,IAAKA,UAAU,CAACH,GAAG,IAAI,QAAQ,CAAC,GAAG,IAAI,CAACpC,MAAM,CAACmB,uBAAuB;EACxK;EAEAyB,eAAeA,CAAA;IAAA,IAAAvH,KAAA;IACbC,mHAAA,CAAC,aAAW;MACV,MAAMD,KAAI,CAACD,QAAQ,CAAC;QAAEvE,EAAE,EAAEwE,KAAI,CAACoH;MAAS,CAAE,EAAEpH,KAAI,CAAC5C,IAAI,CAAC;IACxD,CAAC,EAAC,CAAE;EACN;EAEA;;;;;EAKa2C,QAAQA,CAAC3B,MAAkB,EAAEhB,IAA4B;IAAA,IAAAwD,MAAA;IAAA,OAAAX,mHAAA;MACpE,IAAI7B,MAAM,CAAC5C,EAAE,EAAE;QACb,IAAIgM,WAAW,GAA4B,EAAE;QAC7C,IAAI;UACF,IAAI5K,MAAM,SAASiE,OAAO,CAAC4G,GAAG,CAAC,CAC7B7G,MAAI,CAACqG,UAAU,CAACS,OAAO,CAACtJ,MAAM,CAAC5C,EAAE,CAAC,EAClCoF,MAAI,CAACjC,aAAc,CAACgJ,eAAe,CAAC,EAAE,EAAEvJ,MAAM,CAAC5C,EAAE,CAAC,CACnD,CAAC;UACFoF,MAAI,CAACxC,MAAM,GAAGxB,MAAM,CAAC,CAAC,CAAE;UACxB4K,WAAW,GAAG5K,MAAM,CAAC,CAAC,CAAC,CAAC4K,WAAW,CAACjG,MAAM,CAACC,CAAC,IAAIA,CAAC,CAAC/F,WAAW,EAAE+B,MAAM,GAAG,CAAC,CAAC;SAC3E,SAAS;UACRoD,MAAI,CAAChD,KAAK,GAAG,EAAE;UACf4J,WAAW,CAAC3J,OAAO,CAAC6D,CAAC,IAAId,MAAI,CAAChD,KAAK,EAAEG,IAAI,CAAC6C,MAAI,CAACoG,iBAAiB,CAACY,mBAAmB,CAAClG,CAAC,EAAEA,CAAC,CAAClG,EAAE,EAAE4C,MAAM,CAAC5C,EAAE,EAAEkG,CAAC,CAACjG,WAAW,CAAC,CAAC,CAAC;UACzHmF,MAAI,CAAChD,KAAK,GAAGgD,MAAI,CAACoG,iBAAiB,CAACa,OAAO,CAACjH,MAAI,CAAChD,KAAK,CAAC;UACvDgD,MAAI,CAACjB,KAAK,CAACmI,aAAa,EAAE;UAC1BlH,MAAI,CAACjD,IAAK,CAACoK,OAAO,GAAG,KAAK;;;IAE7B;EACH;EAiBA;;;;EAIaC,aAAaA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAAhI,mHAAA;MACxB,IAAIgI,MAAI,CAACtK,IAAI,EAAEsK,MAAI,CAACtK,IAAI,CAACkF,KAAK,GAAG,EAAE;MACnC,IAAIqF,IAAI,GAAG;QACT1M,EAAE,EAAEyM,MAAI,CAACtJ,aAAc,CAACwJ,YAAY,EAAE;QACtCtM,UAAU,EAAE,EAAE;QACdJ,WAAW,EAAE;OACA;MACf,OAAOyM,IAAI;IAAC;EACd;EAEO5B,aAAaA,CAAA;IAClB,IAAI1J,MAAM,GAAGsB,SAAS;IACtB,MAAMnB,KAAK,GAAG,IAAI,CAAC4H,MAAM,CAACsB,QAAQ,CAAC,IAAI,CAACtB,MAAM,CAACmB,uBAAuB,EAAE,IAAI,CAAC1I,IAAK,CAACE,QAAQ,CAAC4J,UAAU,CAACnK,KAAK,CAAC;IAC7G,MAAMgK,GAAG,GAAG,IAAI,CAAC3J,IAAK,CAACE,QAAQ,CAAC4J,UAAU,CAACnK,KAAK;IAChD,IAAIA,KAAK,EAAES,MAAM,IAAI,IAAI,CAACX,IAAI,CAACuL,kBAAkB,CAAC,IAAI,CAAChL,IAAK,CAACE,QAAQ,CAAC4J,UAAU,CAACnK,KAAK,EAAEgK,GAAG,CAAC,EAAE;MAC5F,MAAMsB,IAAI,GAAG,IAAI,CAAC1D,MAAM,CAACqB,OAAO,CAAC,IAAI,CAACrB,MAAM,CAACmB,uBAAuB,EAAE,IAAI,CAAC1I,IAAK,CAACE,QAAQ,CAAC4J,UAAU,CAACnK,KAAK,CAAC;MAC3G,MAAMuL,KAAK,GAAG,IAAI,CAAC3D,MAAM,CAACkB,QAAQ,CAAC,IAAI,CAAClB,MAAM,CAACmB,uBAAuB,EAAE,IAAI,CAAC1I,IAAK,CAACE,QAAQ,CAAC4J,UAAU,CAACnK,KAAK,CAAC;MAC7GH,MAAM,GAAG;QACPmK,GAAG,EAAEA,GAAG;QACRhK,KAAK,EAAEA,KAAK;QACZsL,IAAI,EAAEA,IAAI;QACVC,KAAK,EAAEA;OACR;MACD,IAAI,CAAClL,IAAK,CAACE,QAAQ,CAAC4J,UAAU,CAAC3G,QAAQ,CAAC,EAAE,CAAC;;IAE7C,OAAO3D,MAAM;EACf;EAEA;;;;;EAKa2L,cAAcA,CAACnL,IAAe,EAAEoL,GAAQ;IAAA,IAAAC,MAAA;IAAA,OAAAxI,mHAAA;MACnD7C,IAAI,CAACE,QAAQ,CAACzB,UAAU,CAAC0E,QAAQ,CAACkI,MAAI,CAAC9K,IAAI,EAAEgJ,MAAM,GAAG6B,GAAG,CAAC3M,UAAU,GAAG2M,GAAG,CAAChN,EAAE,CAAC;MAC9E4B,IAAI,CAACE,QAAQ,CAAC7B,WAAW,CAAC8E,QAAQ,CAACkI,MAAI,CAACzB,iBAAiB,CAAC0B,oBAAoB,CAACF,GAAG,CAAC/M,WAAW,CAAC,CAAC;MAChG2B,IAAI,CAACE,QAAQ,CAAC4J,UAAU,CAAC3G,QAAQ,CAAC,EAAE,CAAC;IAAC;EACxC;EAEA;;;;;EAKaoI,gBAAgBA,CAACH,GAA0B;IAAA,IAAAI,MAAA;IAAA,OAAA3I,mHAAA;MACtD,IAAI4I,YAAY,GAAGD,MAAI,CAACxK,MAAO,CAACG,IAAI;MACpC,IAAIuK,WAAW,GAAGN,GAAG,CAAC9C,YAAY;MAClC,IAAI8C,GAAG,CAAC/M,WAAW,CAAC+B,MAAM,IAAI,CAAC,IAAIgL,GAAG,CAAC/M,WAAW,CAAC,CAAC,CAAC,IAAI,QAAQ,EAAE;QACjE,MAAMmN,MAAI,CAAC1G,MAAM,CAACC,KAAK,CAAC,sBAAsB,EAAE,iEAAiE,GAAGyG,MAAI,CAACvK,GAAG,CAACC,SAAS,CAAC,WAAW,CAAC,GAAG,GAAG,GAAGsK,MAAI,CAACvK,GAAG,CAACC,SAAS,CAAC,aAAa,CAAC,GAAG,sBAAsB,GAAGsK,MAAI,CAACvK,GAAG,CAACC,SAAS,CAAC,WAAW,CAAC,GAAG,IAAI,IAAIsK,MAAI,CAACtB,WAAW,GAAG,sBAAsB,GAAG,gDAAgD,GAAGsB,MAAI,CAACvK,GAAG,CAACC,SAAS,CAAC,YAAY,CAAC,GAAG,GAAG,CAAC,CAAC;OAC3Y,MAAM;QACL,IAAI2C,OAAO,SAAS2H,MAAI,CAAC1G,MAAM,CAACjB,OAAO,CAAC,UAAU,EAAE,6DAA6D,GAAG4H,YAAY,GAAG,gBAAgB,GAAGC,WAAW,GAAG,KAAK,CAAC;QAC1K,IAAI7H,OAAO,EAAE;UACX,IAAI8H,GAAuB;UAC3B,IAAI;YACF,IAAI,CAACH,MAAI,CAACtB,WAAW,EAAE;cAAK;cAC1BsB,MAAI,CAACb,OAAO,GAAG,IAAI;cACnB,MAAMa,MAAI,CAACjK,aAAa,CAAC8D,cAAc,CAAC,CAACmG,MAAI,CAAC5B,iBAAiB,CAACY,mBAAmB,CAACY,GAAG,EAAEA,GAAG,CAAChN,EAAE,EAAEoN,MAAI,CAACxK,MAAO,CAAC5C,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC6G,IAAI,CAAC2G,QAAQ,IAAG;gBACtI,IAAID,GAAG,GAAGC,QAAQ,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,SAAS,CAACJ,GAAG,EAAEvL,MAAM,CAAC,EAAE2L,SAAS,CAACJ,GAAG,EAAE;kBAAE,IAAIH,MAAI,CAACjL,IAAI,EAAEiL,MAAI,CAACjL,IAAI,CAACkF,KAAK,GAAGkG,GAAG;;gBAAG;cACjH,CAAC,CAAC;cACF,MAAMH,MAAI,CAAC7I,QAAQ,CAAC;gBAAEvE,EAAE,EAAEoN,MAAI,CAACxK,MAAO,CAAC5C;cAAE,CAAE,EAAEoN,MAAI,CAACxL,IAAI,CAAC;aACxD,MAAM;cAAqB;cAC1B+C,MAAM,CAACC,MAAM,CAACoI,GAAG,EAAE;gBAAE,SAAS,EAAE,QAAQ;gBAAE,aAAa,EAAE;cAAE,CAAE,CAAC;cAC9D,OAAO,KAAK;;WAEf,CAAC,OAAOY,CAAM,EAAE;YACfR,MAAI,CAACb,OAAO,GAAG,KAAK;WACrB,SAAS;YACRa,MAAI,CAACb,OAAO,GAAG,KAAK;;UAEtB;;;;MAGJ,OAAO,KAAK;IAAC;EACf;EAEA;;;;;EAKOvB,gBAAgBA,CAACgC,GAAe;IACrC,OAAOA,GAAG,CAACzB,GAAG,IAAI,QAAQ;EAC5B;EAEA;;;;;;EAMatE,cAAcA,CAACrF,IAAe,EAAEoL,GAA0B;IAAA,IAAAa,MAAA;IAAA,OAAApJ,mHAAA;MACrE7C,IAAI,CAACE,QAAQ,CAAC7B,WAAW,CAAC8E,QAAQ,CAAC8I,MAAI,CAAC1E,MAAM,CAAC2E,gBAAgB,CAAClM,IAAK,CAACE,QAAQ,CAAC7B,WAAW,CAACsB,KAAK,CAAC,CAAC;MACtG;;MAEI,IAAI8F,KAAK,GAAQ3E,SAAS;MAC1B;MACA,IAAI,CAAC2E,KAAK,EAAE;QACV,IAAI5B,OAAO,GAAG,IAAI;QAClB,IAAIsI,CAAC,GAAGF,MAAI,CAACrC,iBAAiB,CAACwC,eAAe,CAACpM,IAAI,EAAEoL,GAAG,CAAC/M,WAAW,IAAI,EAAE,CAAC;QAC3E,IAAI8N,CAAC,CAAC/L,MAAM,EAAEyD,OAAO,SAASoI,MAAI,CAACnH,MAAM,CAACjB,OAAO,CAAC,kCAAkC,EAAEsI,CAAC,CAAC/L,MAAM,IAAI,CAAC,GAAG,IAAI,GAAG+L,CAAC,CAAC,CAAC,CAAC,GAAG,iBAAiB,GAAG,mBAAmB,GAAGA,CAAC,CAACzJ,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;QACjL,IAAI1C,IAAK,CAACE,QAAQ,CAAC7B,WAAW,CAACsB,KAAK,CAACS,MAAM,IAAIyD,OAAO,EAAE;UACtDoI,MAAI,CAACtB,OAAO,GAAG,IAAI;UACnB,IAAI;YACF,IAAI0B,gBAAgB,GAA2BrM,IAAK,CAACE,QAAQ,CAAC7B,WAAW,CAACsB,KAAK,CAAC6J,GAAG,CAAEpF,CAAa,IAAKA,CAAC,CAACuF,GAAG,CAAC;YAC7G,IAAI,CAACsC,MAAI,CAAC/B,WAAW,EAAE;cAAE;cACvB,MAAM+B,MAAI,CAAC1K,aAAa,CAAC8D,cAAc,CAAC,CAAC4G,MAAI,CAACrC,iBAAiB,CAACY,mBAAmB,CAACY,GAAG,EAAEpL,IAAK,CAACE,QAAQ,CAACzB,UAAU,CAACkB,KAAK,EAAEsM,MAAI,CAACjL,MAAO,CAAC5C,EAAE,EAAEiO,gBAAgB,CAAC,CAAC,CAAC,CAACpH,IAAI,CAAC2G,QAAQ,IAAG;gBAC7K,IAAID,GAAuB;gBAC3B,IAAIA,GAAG,GAAGC,QAAQ,EAAEC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,SAAS,CAACJ,GAAG,EAAEvL,MAAM,CAAC,EAAE2L,SAAS,CAACJ,GAAG,EAAE;kBAAE,IAAIM,MAAI,CAAC1L,IAAI,EAAE0L,MAAI,CAAC1L,IAAK,CAACkF,KAAK,GAAGkG,GAAG;;gBAAG;cACnH,CAAC,CAAC;cACF,MAAMM,MAAI,CAACtJ,QAAQ,CAAC;gBAAEvE,EAAE,EAAE6N,MAAI,CAACjL,MAAO,CAAC5C;cAAE,CAAE,EAAE6N,MAAI,CAACjM,IAAI,CAAC;cACvD,IAAIiM,MAAI,CAAC1L,IAAI,EAAE0L,MAAI,CAAC1L,IAAK,CAACkF,KAAK,GAAG,EAAE;aACrC,MAAM;cAAiB;cACtBwG,MAAI,CAACK,cAAc,CAAClB,GAAG,EAAEiB,gBAAgB,CAAC;;WAE7C,CAAC,OAAO5G,KAAU,EAAE;YACnB,IAAIwG,MAAI,CAAC1L,IAAI,EAAE0L,MAAI,CAAC1L,IAAI,CAACkF,KAAK,GAAGA,KAAK;YACtC,MAAMwG,MAAI,CAACtJ,QAAQ,CAAC;cAAEvE,EAAE,EAAE6N,MAAI,CAACjL,MAAO,CAAC5C;YAAE,CAAE,EAAE6N,MAAI,CAACjM,IAAI,CAAC;WACxD,SAAS;YACRiM,MAAI,CAACtB,OAAO,GAAG,KAAK;;;OAGzB,MAAM;QACL,IAAIsB,MAAI,CAAC1L,IAAI,EAAE0L,MAAI,CAAC1L,IAAI,CAACkF,KAAK,GAAG,SAAS,GAAG,GAAG,GAAGA,KAAK;QACxDwG,MAAI,CAACK,cAAc,CAAClB,GAAG,EAAEpL,IAAI,CAACE,QAAQ,CAAC7B,WAAW,CAACsB,KAAK,CAAC6J,GAAG,CAAEpF,CAAa,IAAKA,CAAC,CAACuF,GAAG,CAAC,CAAC;;MAEzF,OAAO7I,SAAS;IAAC;EACnB;EAEOwL,cAAcA,CAAClB,GAA0B,EAAE/M,WAAmC;IACnF,IAAIkO,KAAK,GAAG,IAAI,CAAC/L,KAAM,CAACgE,SAAS,CAACJ,CAAC,IAAIA,CAAC,CAAC,IAAI,CAAC,IAAIgH,GAAG,CAAC,IAAI,CAAC,CAAC;IAC5D,IAAI,CAAC5K,KAAM,CAAC+L,KAAM,CAAC,GAAG,IAAI,CAAC3C,iBAAiB,CAACY,mBAAmB,CAC9D;MAAEpM,EAAE,EAAEgN,GAAG,CAAChN,EAAE;MAAE8J,aAAa,EAAE,IAAI,CAAC7E,OAAO,EAAEmJ,YAAY,EAAExL,MAAM,CAACyL,KAAK;MAAEnE,YAAY,EAAE,IAAI,CAACjF,OAAO,EAAEmJ,YAAY,EAAExL,MAAM,CAACG,IAAI;MAAEkH,cAAc,EAAE,IAAI,CAAChF,OAAO,EAAEmJ,YAAY,EAAExL,MAAM,CAAC0L;IAAM,CAAE,EACzL,IAAI,CAAC1M,IAAK,CAACE,QAAQ,CAACzB,UAAU,CAACkB,KAAK,EAAE,IAAI,CAACqB,MAAO,CAAC5C,EAAE,EAAEC,WAAW,CACnE;IACD,IAAI,CAACkE,KAAK,CAACmI,aAAa,EAAE;EAC5B;EAAC,QAAA7E,CAAA;qBA1NU5G,0BAA0B,EAAA6G,gEAAA,CAAAA,oDAAA;EAAA;EAAA,QAAAG,EAAA;UAA1BhH,0BAA0B;IAAAiH,SAAA;IAAAC,SAAA,WAAAwG,iCAAAtG,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;mEAC1BqB,iFAAa;;;;;;;;;;;;;;;;;;;;QCpB1B5B,6DAAA,iBACkJ;QAC9IA,yDAAA,IAAA8G,0CAAA,kBAAoF;QACpF9G,yDAAA,IAAA+G,+CAAA,uBAAyN;QACzN/G,6DAAA,cAAS;QAEDA,yDAAA,IAAAgH,iDAAA,gCAAAhH,qEAAA,CAGc;QACdA,yDAAA,IAAAkH,iDAAA,gCAAAlH,qEAAA,CAEc;QAClBA,2DAAA,EAAS;QACTA,6DAAA,iBAA+G;QAC3GA,yDAAA,KAAAmH,kDAAA,gCAAAnH,qEAAA,CAIc;QACdA,yDAAA,KAAAoH,kDAAA,gCAAApH,qEAAA,CAIc;QAClBA,2DAAA,EAAS;QACTA,wDAAA,iBAAgC;QACpCA,2DAAA,EAAU;;;;;;;QA3BFA,yDAAA,UAAAQ,GAAA,CAAA9F,KAAA,CAAe,2BAAA8F,GAAA,CAAAtG,IAAA,4BAAAsG,GAAA,CAAAsE,aAAA,CAAAzB,IAAA,CAAA7C,GAAA,WAAAA,GAAA,CAAA6E,cAAA,CAAAhC,IAAA,CAAA7C,GAAA,aAAAA,GAAA,CAAAiF,gBAAA,CAAApC,IAAA,CAAA7C,GAAA,WAAAA,GAAA,CAAAjB,cAAA,CAAA8D,IAAA,CAAA7C,GAAA;QAEhBR,wDAAA,GAAkB;QAAlBA,yDAAA,UAAAQ,GAAA,CAAA4D,WAAA,CAAkB;QACbpE,wDAAA,GAAkB;QAAlBA,yDAAA,UAAAQ,GAAA,CAAA4D,WAAA,CAAkB;QAElBpE,wDAAA,GAAmC;QAAnCA,yDAAA,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,aAAmC,aAAAiM,GAAA,kBAAAC,GAAA;QASnCtH,wDAAA,GAAsC;QAAtCA,yDAAA,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,0BAAsC,aAAAmM,GAAA,kBAAAC,GAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZiB;AAEL;AACE;AACA;AACb;AACY;;;;;;;;;;;;;;;ICRnExH,6DAAA,aAAkC;IAAAA,qDAAA,GAAS;IAAAA,2DAAA,EAAK;;;;IAAdA,wDAAA,GAAS;IAATA,gEAAA,CAAA0H,MAAA,CAAAtG,KAAA,CAAS;;;;;IAKvCpB,wDAAA,cAAuC;;;;;IAW3BA,wDAAA,0BAAsF;;;;IAArEA,yDAAA,QAAA2H,MAAA,CAAAtL,QAAA,CAAoB,qBAAAsL,MAAA,CAAAtM,IAAA;;;;;IAQrC2E,6DAAA,aAAQ;IAAAA,qDAAA,GAA0B;IAAAA,2DAAA,EAAS;;;;IAAnCA,wDAAA,GAA0B;IAA1BA,gEAAA,EAAA4H,MAAA,CAAAC,MAAA,kBAAAD,MAAA,CAAAC,MAAA,CAAAxM,IAAA,QAA0B;;;ADT5C,MAAOyM,oBAAqB,SAAQL,6EAAwC;EAMhFrP,YAAmBkB,QAAkB;IACnC,KAAK,CAACA,QAAQ,EAAEL,iEAAO,EAAED,8EAAiB,CAAC;IAD1B,KAAAM,QAAQ,GAARA,QAAQ;IAwBpB,KAAAyO,WAAW,GAAI1J,MAAiB,IAAI;MACzC,IAAI3E,MAAM,GAAU,EAAE;MACtB,IAAI2E,MAAM,EAAEjE,QAAQ,CAAC4D,OAAO,EAAEnE,KAAK,EAAES,MAAM,EAAE;QAC3CZ,MAAM,CAACmB,IAAI,CAAC,CAAC,MAAM,EAAE,MAAM,EAAE,GAAG,GAAGwD,MAAM,EAAEjE,QAAQ,CAAC4D,OAAO,EAAEnE,KAAK,CAACmO,IAAI,EAAE,CAACC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;;MAErG,IAAI5J,MAAM,EAAEjE,QAAQ,CAACzB,UAAU,EAAEkB,KAAK,EAAES,MAAM,EAAE;QAC9CZ,MAAM,CAACmB,IAAI,CAAC,CAAC,SAAS,EAAE,IAAI,EAAEwD,MAAM,EAAEjE,QAAQ,CAACzB,UAAU,CAACkB,KAAK,CAAC,CAAC;;MAEnE,IAAIwE,MAAM,EAAEjE,QAAQ,CAACmC,SAAS,EAAE1C,KAAK,EAAES,MAAM,EAAE;QAC7CZ,MAAM,CAACmB,IAAI,CAAC,CAAC,WAAW,EAAE,IAAI,EAAEwD,MAAM,EAAEjE,QAAQ,CAACmC,SAAS,EAAE1C,KAAK,CAAC,CAAC;;MAErE,OAAOH,MAAM;IACf,CAAC;IAlCC,IAAI,CAAC8B,UAAU,GAAGlC,QAAQ,CAACiC,GAAG,CAAoBxC,8EAAiB,CAAC;IACpE,IAAI,CAACuC,SAAS,GAAGhC,QAAQ,CAACiC,GAAG,CAAmB1C,4EAAgB,CAAC;IACjE;IACA,IAAI,CAACuI,KAAK,GAAG,IAAI,CAACjG,GAAG,CAACC,SAAS,CAAC,UAAU,CAAC;IAC3C,IAAI,CAAC8M,IAAI,GAAG,cAAc;IAC1B,IAAI,CAACtL,IAAI,GAAG,CAAC,gBAAgB,CAAC;IAC9B,IAAI,CAACyB,MAAM,GAAG,IAAI,CAAC1C,EAAE,CAACC,WAAW,CAAC;MAChCoC,OAAO,EAAE;QAAElC,OAAO,EAAE;MAAE,CAAE;MACxBnD,UAAU,EAAE;QAAEmD,OAAO,EAAE;MAAE,CAAE;MAC3BS,SAAS,EAAE;QAAET,OAAO,EAAE;MAAI;KAC3B,CAAC;IACF,IAAI,CAACqM,SAAS,CAAC,IAAI,CAACC,kBAAkB,EAAE,UAAU,CAAC;IACnD;EACF;;EAEOC,cAAcA,CAAC/C,GAAQ;IAC5B,IAAI5L,MAAM,GAAoB,EAAE;IAChC;IACA,IAAI,IAAI,CAAC4H,IAAI,CAACC,eAAe,CAAC,gBAAgB,CAAC,EAAE7H,MAAM,CAACmB,IAAI,CAAC;MAAEyN,KAAK,EAAE,aAAa;MAAEnD,IAAI,EAAE,iBAAiB;MAAGoD,OAAO,EAAGvK,OAAgB,IAAI;QAAG,IAAI,CAACwK,EAAE,CAACC,QAAQ,CAAC;UAAEC,KAAK,EAAE,CAAC,eAAe,EAAE,SAAS,EAAE,EAAE,EAAE1K,OAAO,CAAC1F,EAAE,EAAE,YAAY;QAAC,CAAE,EAAE;UAAE6L,QAAQ,EAAE;YAAED,SAAS,EAAEoB,GAAG,CAAChN;UAAE;QAAE,CAAE,CAAC;MAAE;IAAC,CAAC,CAAC;IACjR,OAAOoB,MAAM;EACf;EAAC,QAAAqG,CAAA;qBA5BU+H,oBAAoB,EAAA9H,gEAAA,CAAAA,oDAAA;EAAA;EAAA,QAAAG,EAAA;UAApB2H,oBAAoB;IAAA1H,SAAA;IAAAC,SAAA,WAAAsI,2BAAApI,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;mEACpBqB,iFAAa;;;;;;;;;;;;;QChB1B5B,yDAAA,IAAA4I,kCAAA,gBAAgD;QAChD5I,6DAAA,cAGqD;QAFvBA,yDAAA,oBAAA6I,qDAAAC,MAAA;UAAA,OAAUtI,GAAA,CAAAuI,QAAA,CAAAD,MAAA,CAAgB;QAAA,EAAC;QAGrD9I,yDAAA,IAAAgJ,uCAAA,qBAAuC;QACvChJ,6DAAA,gBAAiL;QAEzKA,wDAAA,oBAA0K;QAG9KA,2DAAA,EAAM;QAEVA,6DAAA,cAAS;QAEDA,yDAAA,KAAAiJ,4CAAA,gCAAAjJ,qEAAA,CAEc;QAClBA,2DAAA,EAAS;QACTA,wDAAA,kBAAyC;QAGzCA,6DAAA,kBAAoE;QAChEA,yDAAA,KAAAkJ,4CAAA,iCAAAlJ,qEAAA,CAEc;QAClBA,2DAAA,EAAS;QACTA,wDAAA,kBAAiH;QACrHA,2DAAA,EAAU;QACVA,wDAAA,sBAA4C;QAChDA,2DAAA,EAAO;;;;;QA9BFA,yDAAA,UAAAQ,GAAA,CAAAW,OAAA,CAAc;QACbnB,wDAAA,GAAW;QAAXA,yDAAA,QAAAQ,GAAA,CAAAzG,GAAA,CAAW,QAAAyG,GAAA,CAAA2I,GAAA,aAAA3I,GAAA,CAAA4I,OAAA,aAAA5I,GAAA,CAAA6I,OAAA,UAAA7I,GAAA,CAAA5D,IAAA,gBAAA4D,GAAA,CAAA8I,UAAA,YAAA9I,GAAA,CAAAc,IAAA,CAAAC,eAAA,8BAAAf,GAAA,CAAAc,IAAA,CAAAC,eAAA;QAIHvB,wDAAA,GAAiB;QAAjBA,yDAAA,UAAAQ,GAAA,CAAA8I,UAAA,CAAiB;QACnBtJ,wDAAA,GAAe;QAAfA,yDAAA,SAAAQ,GAAA,CAAAnC,MAAA,CAAe,UAAAmC,GAAA,CAAAuH,WAAA,YAAAvH,GAAA,CAAA+I,YAAA,CAAAlG,IAAA,CAAA7C,GAAA,qBAAAA,GAAA,CAAAgJ,oBAAA,CAAAnG,IAAA,CAAA7C,GAAA,iBAAAA,GAAA,CAAA8I,UAAA,IAAA9I,GAAA,CAAAiJ,eAAA;QAEHzJ,wDAAA,GAAU;QAAVA,yDAAA,WAAU,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,6BAAAoF,GAAA,CAAAnC,MAAA,CAAAjE,QAAA,CAAA4D,OAAA;QAAkHgC,0DAAA,kBAAoB;QAC9IA,wDAAA,GAAU;QAAVA,yDAAA,WAAU,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,kCAAAoF,GAAA,CAAAnC,MAAA,CAAAjE,QAAA,CAAAzB,UAAA,SAAA6H,GAAA,CAAAhF,UAAA;QACVwE,wDAAA,GAAU;QAAVA,yDAAA,WAAU,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,uBAAAoF,GAAA,CAAAnC,MAAA,CAAAjE,QAAA,CAAAmC,SAAA,SAAAiE,GAAA,CAAAlF,SAAA;QAIH0E,wDAAA,GAAkB;QAAlBA,yDAAA,mBAAkB,aAAA0J,GAAA;QAQnC1J,wDAAA,GAAiC;QAAjCA,yDAAA,UAAAQ,GAAA,CAAArF,GAAA,CAAAC,SAAA,WAAiC,aAAAuO,GAAA;QAKlB3J,wDAAA,GAAe;QAAfA,yDAAA,WAAAQ,GAAA,CAAAoJ,IAAA,CAAe,mBAAApJ,GAAA,CAAA6H,cAAA,CAAAhF,IAAA,CAAA7C,GAAA,cAAAA,GAAA,CAAAqJ,OAAA;QAE9B7J,wDAAA,GAAkB;QAAlBA,yDAAA,SAAAQ,GAAA,CAAAsJ,SAAA,CAAkB;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5BqB;AACD;AACa;AACU;AACA;AACkB;;;AAE/F,MAAMI,MAAM,GAAW,CACrB;EAAEC,IAAI,EAAE,EAAE;EAAEC,SAAS,EAAEtC,sFAAoB;EAAEuC,WAAW,EAAE,CAACL,gEAAS,CAAC;EAAEnM,OAAO,EAAE;IAAEyM,MAAM,EAAEL,6EAAcA;EAAA,CAAE;EAAEM,qBAAqB,EAAE,QAAQ;EAAElS,IAAI,EAAE;IAAE+I,KAAK,EAAE;EAAU;AAAE,CAAE,EAC1K;EAAE+I,IAAI,EAAE,KAAK;EAAEC,SAAS,EAAE/Q,sFAAoB;EAAEgR,WAAW,EAAE,CAACL,gEAAS,CAAC;EAAEnM,OAAO,EAAE;IAAEyM,MAAM,EAAEL,6EAAcA;EAAA,CAAE;EAAEM,qBAAqB,EAAE,QAAQ;EAAElS,IAAI,EAAE;IAAE+I,KAAK,EAAE,qBAAqB;IAAEoJ,KAAK,EAAE;EAAI;AAAE,CAAE,EACrM;EAAEL,IAAI,EAAE,UAAU;EAAEC,SAAS,EAAE/Q,sFAAoB;EAAEgR,WAAW,EAAE,CAACL,gEAAS,CAAC;EAAEnM,OAAO,EAAE;IAAEyM,MAAM,EAAEL,6EAAcA;EAAA,CAAE;EAAEM,qBAAqB,EAAE,QAAQ;EAAElS,IAAI,EAAE;IAAE+I,KAAK,EAAE,mBAAmB;IAAEoJ,KAAK,EAAE;EAAI;AAAE,CAAE,EACxM;EAAEL,IAAI,EAAE,aAAa;EAAEC,SAAS,EAAE/Q,sFAAoB;EAAEgR,WAAW,EAAE,CAACL,gEAAS,CAAC;EAAEnM,OAAO,EAAE;IAAEyM,MAAM,EAAEL,6EAAcA;EAAA,CAAE;EAAEM,qBAAqB,EAAE,QAAQ;EAAElS,IAAI,EAAE;IAAE+I,KAAK,EAAE,oBAAoB;IAAEoJ,KAAK,EAAE;EAAI;AAAE,CAAE,EAC5M;EAAEL,IAAI,EAAE,2BAA2B;EAAEC,SAAS,EAAEjR,wGAA0B;EAAEkR,WAAW,EAAE,CAACL,gEAAS,CAAC;EAAEnM,OAAO,EAAE;IAAEyM,MAAM,EAAEL,6EAAcA;EAAA,CAAE;EAAEM,qBAAqB,EAAE,QAAQ;EAAElS,IAAI,EAAE;IAAE+I,KAAK,EAAE,wBAAwB;IAAEoJ,KAAK,EAAE;EAAI;AAAE,CAAE,CACrO;AAMK,MAAOC,oBAAoB;EAAA,QAAA1K,CAAA;qBAApB0K,oBAAoB;EAAA;EAAA,QAAAtK,EAAA;UAApBsK;EAAoB;EAAA,QAAAC,EAAA;cAHrBX,yDAAY,CAACY,QAAQ,CAACT,MAAM,CAAC,EAC7BH,yDAAY;EAAA;;;sHAEXU,oBAAoB;IAAAG,OAAA,GAAAC,yDAAA;IAAAC,OAAA,GAFrBf,yDAAY;EAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;ACjBuB;AAEiB;AACa;AACL;AACK;AACxB;AAC0C;;AAgBzF,MAAOmB,aAAa;EAAA,QAAAnL,CAAA;qBAAbmL,aAAa;EAAA;EAAA,QAAA/K,EAAA;UAAb+K;EAAa;EAAA,QAAAR,EAAA;cANtBK,yDAAY,EACZC,kFAAgB,EAChBC,+DAAmB,EACnBR,yEAAoB;EAAA;;;sHAGXS,aAAa;IAAAC,YAAA,GAXtBrD,sFAAoB,EACpBzO,sFAAoB,EACpBF,wGAA0B;IAAAyR,OAAA,GAG1BG,yDAAY,EACZC,kFAAgB,EAChBC,+DAAmB,EACnBR,yEAAoB;EAAA;AAAA","sources":["./src/app/models/unidade-integrante.model.ts","./src/app/modules/configuracoes/usuario/usuario-form/usuario-form.component.ts","./src/app/modules/configuracoes/usuario/usuario-form/usuario-form.component.html","./src/app/modules/configuracoes/usuario/usuario-integrante/usuario-integrante.component.ts","./src/app/modules/configuracoes/usuario/usuario-integrante/usuario-integrante.component.html","./src/app/modules/configuracoes/usuario/usuario-list/usuario-list.component.ts","./src/app/modules/configuracoes/usuario/usuario-list/usuario-list.component.html","./src/app/modules/configuracoes/usuario/usuario-routing.module.ts","./src/app/modules/configuracoes/usuario/usuario.module.ts"],"sourcesContent":["import { Base, IntegranteAtribuicao } from './base.model';\r\nimport { UnidadeIntegranteAtribuicao } from './unidade-integrante-atribuicao.model';\r\nimport { Unidade } from './unidade.model';\r\nimport { Usuario } from './usuario.model';\r\n\r\nexport class IntegranteConsolidado extends Base {\r\n    public id: string = \"\"; /* Utilizado somente para garantir o funcionamento do grid */\r\n    public usuario_id?: string;\r\n    public usuario_nome?: string;\r\n    public usuario_apelido?: string;\r\n    public usuario_url_foto?: string;\r\n    public unidade_id?: string;\r\n    public unidade_nome?: string;\r\n    public unidade_sigla?: string;\r\n    public unidade_codigo?: string;\r\n    public atribuicoes: IntegranteAtribuicao[] = [];\r\n\r\n    public constructor(data?: any) { super(); this.initialization(data); }\r\n};\r\n\r\nexport class UnidadeIntegrante extends Base {\r\n    public unidade?: Unidade;\r\n    public usuario?: Usuario;\r\n    public lotado?: UnidadeIntegranteAtribuicao; \r\n    public gestor?: UnidadeIntegranteAtribuicao; \r\n    public gestor_substituto?: UnidadeIntegranteAtribuicao; \r\n    public gestor_delegado?: UnidadeIntegranteAtribuicao; \r\n    public homologador_plano_entrega?: UnidadeIntegranteAtribuicao; \r\n    public avaliador_plano_entrega?: UnidadeIntegranteAtribuicao; \r\n    public avaliador_plano_trabalho?: UnidadeIntegranteAtribuicao; \r\n    public atribuicoes: UnidadeIntegranteAtribuicao[] = [];\r\n    \r\n    public usuario_id: string = \"\"; /* Usuário vinculado */\r\n    public unidade_id: string = \"\"; /* Unidade Vinculada */\r\n    \r\n    public constructor(data?: any) { super(); this.initialization(data); }\r\n}\r\n\r\n\r\n ","import { Component, Injector, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormGroup } from '@angular/forms';\r\nimport { EditableFormComponent } from 'src/app/components/editable-form/editable-form.component';\r\nimport { PerfilDaoService } from 'src/app/dao/perfil-dao.service';\r\nimport { PlanoTrabalhoDaoService } from 'src/app/dao/plano-trabalho-dao.service';\r\nimport { UnidadeDaoService } from 'src/app/dao/unidade-dao.service';\r\nimport { UsuarioDaoService } from 'src/app/dao/usuario-dao.service';\r\nimport { IIndexable } from 'src/app/models/base.model';\r\nimport { Usuario } from 'src/app/models/usuario.model';\r\nimport { PageFormBase } from 'src/app/modules/base/page-form-base';\r\nimport { UsuarioIntegranteComponent } from '../usuario-integrante/usuario-integrante.component';\r\nimport { TemplateDataset } from 'src/app/modules/uteis/templates/template.service';\r\nimport { UnidadeIntegranteDaoService } from 'src/app/dao/unidade-integrante-dao.service';\r\nimport { IntegranteConsolidado, UnidadeIntegrante } from 'src/app/models/unidade-integrante.model';\r\nimport { InputSearchComponent } from 'src/app/components/input/input-search/input-search.component';\r\n\r\n@Component({\r\n  selector: 'app-usuario-form',\r\n  templateUrl: './usuario-form.component.html',\r\n  styleUrls: ['./usuario-form.component.scss']\r\n})\r\nexport class UsuarioFormComponent extends PageFormBase<Usuario, UsuarioDaoService> {\r\n  @ViewChild(EditableFormComponent, { static: false }) public editableForm?: EditableFormComponent;\r\n  @ViewChild(UsuarioIntegranteComponent, { static: false }) public unidadesIntegrantes?: UsuarioIntegranteComponent;\r\n  @ViewChild('lotacao', { static: false }) public lotacao?: InputSearchComponent;\r\n\r\n  public formLotacao: FormGroup;\r\n  public perfilDao: PerfilDaoService;\r\n  public unidadeDao: UnidadeDaoService;\r\n  public integranteDao: UnidadeIntegranteDaoService;\r\n  public planoTrabalhoDao: PlanoTrabalhoDaoService;\r\n  public planoDataset: TemplateDataset[];\r\n\r\n  constructor(public injector: Injector) {\r\n    super(injector, Usuario, UsuarioDaoService);\r\n    this.perfilDao = injector.get<PerfilDaoService>(PerfilDaoService);\r\n    this.unidadeDao = injector.get<UnidadeDaoService>(UnidadeDaoService);\r\n    this.integranteDao = injector.get<UnidadeIntegranteDaoService>(UnidadeIntegranteDaoService);\r\n    this.planoTrabalhoDao = injector.get<PlanoTrabalhoDaoService>(PlanoTrabalhoDaoService);\r\n    this.form = this.fh.FormBuilder({\r\n      email: { default: \"\" },\r\n      nome: { default: \"\" },\r\n      cpf: { default: \"\" },\r\n      matricula: { default: \"\" },\r\n      apelido: { default: \"\" },\r\n      telefone: { default: \"\" },\r\n      uf: { default: \"\" },\r\n      sexo: { default: null },\r\n      url_foto: { default: \"\" },\r\n      texto_complementar_plano: { default: \"\" },\r\n      perfil_id: { default: null },\r\n      data_nascimento: { default: null },\r\n    }, this.cdRef, this.validate);\r\n    this.formLotacao = this.fh.FormBuilder({\r\n      unidade_lotacao_id: { default: \"\" },\r\n    }, this.cdRef, this.validate);\r\n    this.planoDataset = this.planoTrabalhoDao.dataset();\r\n    this.join = [\"lotacao.unidade:id\"];\r\n  }\r\n\r\n  public async loadData(entity: Usuario, form: FormGroup): Promise<void> {\r\n    let formValue = Object.assign({}, form.value);\r\n    form.patchValue(this.util.fillForm(formValue, entity));\r\n    this.formLotacao.controls.unidade_lotacao_id.setValue(entity.lotacao?.unidade?.id);\r\n    await this.unidadesIntegrantes?.loadData(entity);\r\n  }\r\n\r\n  public initializeData(form: FormGroup): void {\r\n    this.entity = new Usuario();\r\n    this.loadData(this.entity, form);\r\n  }\r\n\r\n  public validate = (control: AbstractControl, controlName: string) => {\r\n    let result = null;\r\n    if (controlName == \"cpf\" && !this.util.validarCPF(control.value)) {\r\n      result = \"Inválido\";\r\n    }\r\n    if(['data_nascimento'].indexOf(controlName) >= 0 && !this.dao?.validDateTime(control.value)) {\r\n      result = \"Inválido\";\r\n    }\r\n    return result;\r\n  }\r\n\r\n  public formValidation = (form?: FormGroup) => {\r\n    if (!this.formLotacao?.controls.unidade_lotacao_id.value?.length) {\r\n      return \"É obrigatória a definição da unidade de lotação do servidor!\";\r\n    }\r\n    const erros_atribuicoes = [];\r\n    this.unidadesIntegrantes?.grid?.items.forEach((unidadeIntegrante) => {\r\n      if (unidadeIntegrante.unidade_id == '') erros_atribuicoes.push({ integrante: unidadeIntegrante, erro: 'Falta unidade_id' })\r\n    });\r\n    if (erros_atribuicoes.length) return \"Na aba 'Atribuições' há unidade não salva. Salve-a antes de salvar o usuário!\"\r\n    return undefined;\r\n  }\r\n\r\n  public saveData(form: IIndexable): Promise<boolean> {\r\n    return new Promise<boolean>(async (resolve, reject) => {\r\n      this.unidadesIntegrantes!.grid!.confirm();\r\n      let usuario = this.util.fill(new Usuario(), this.entity!);\r\n      usuario = this.util.fillForm(usuario, this.form!.value);\r\n      usuario.lotacao_id = this.formLotacao?.controls.unidade_lotacao_id.value;\r\n      let integrantesConsolidados: IntegranteConsolidado[] = this.unidadesIntegrantes?.items || [];\r\n      let indicesIntegrantesExcluir: number[] = [];\r\n      integrantesConsolidados.filter(x => x._status == \"DELETE\").forEach((x,i) => indicesIntegrantesExcluir.push(i));\r\n      let indiceVinculoLotacao = integrantesConsolidados.findIndex(ic => ic.atribuicoes.includes(\"LOTADO\"));\r\n      let lotacaoAlterada: boolean = indiceVinculoLotacao == -1 || usuario.lotacao_id != integrantesConsolidados[indiceVinculoLotacao].unidade_id;\r\n      /* Caso não tenha lotação na lista de atribuições adiciona uma\r\n      if (indiceVinculoLotacao < 0) {\r\n        const unidadeIntegrante = integrantesConsolidados.find(ic => ic.unidade_id == usuario.lotacao_id) || new IntegranteConsolidado({\r\n          usuario_id: usuario.id,\r\n          _status: \"ADD\"\r\n        });\r\n        unidadeIntegrante.atribuicoes.push(\"LOTADO\");\r\n        if(integrantesConsolidados.indexOf(unidadeIntegrante) < 0) integrantesConsolidados.push(unidadeIntegrante);\r\n        indiceVinculoLotacao = integrantesConsolidados.findIndex(ic => ic.atribuicoes.includes(\"LOTADO\"));\r\n      }*/\r\n      let usuarioEhGestor: boolean = indiceVinculoLotacao != -1 && integrantesConsolidados[indiceVinculoLotacao].atribuicoes.includes(\"GESTOR\");\r\n      if(lotacaoAlterada && usuarioEhGestor) {\r\n        this.submitting = false;\r\n        await this.dialog.alert(\"PROIBIDO ALTERAR A LOTAÇÃO !\", \"Não é possível alterar a lotação de um servidor que exerce a função de Gestor Titular da Unidade onde atualmente está lotado.\");\r\n        reject(false);\r\n      } else {\r\n        try {\r\n          await this.dao?.save(Object.assign(usuario, {'lotacao_id': this.formLotacao?.controls.unidade_lotacao_id.value})).then(async usuarioBanco => {\r\n            if (lotacaoAlterada) {    // garantindo a coerência entre o campo de lotação do usuário e o vínculo de lotado dos integrantes\r\n              if(indiceVinculoLotacao != -1) integrantesConsolidados[indiceVinculoLotacao].atribuicoes = integrantesConsolidados[indiceVinculoLotacao].atribuicoes.filter(x => x != \"LOTADO\");\r\n              let indiceNovaUnidadeLotacao = integrantesConsolidados.findIndex(ic => ic.unidade_id == usuario.lotacao_id);\r\n              indiceNovaUnidadeLotacao == -1 ? integrantesConsolidados.push(Object.assign(new IntegranteConsolidado (), { unidade_id: usuario.lotacao_id, usuario_id: usuarioBanco.id, atribuicoes: [\"LOTADO\"] })) : integrantesConsolidados[indiceNovaUnidadeLotacao].atribuicoes.push(\"LOTADO\");\r\n              indiceVinculoLotacao = integrantesConsolidados.findIndex(ic => ic.atribuicoes.includes(\"LOTADO\"));\r\n            }\r\n            // uma vez garantida a coerência entre o campo de lotação do usuário e o vínculo de lotado dos integrantes, vamos tratar do eventual vínculo a ser excluído \r\n            indicesIntegrantesExcluir.forEach(i => {\r\n              //integrantesConsolidados[i].atribuicoes = i != indiceVinculoLotacao ? [] : [\"LOTADO\"];\r\n              if(i != indiceVinculoLotacao) integrantesConsolidados[i].atribuicoes = [];\r\n            });\r\n            integrantesConsolidados.forEach(ic => ic.usuario_id = usuarioBanco.id);\r\n            await this.integranteDao.saveIntegrante(integrantesConsolidados as IntegranteConsolidado[]);\r\n          });\r\n          resolve(true);\r\n        } catch (error: any) {\r\n          if (this.editableForm) this.editableForm.error = error;\r\n          this.submitting = false;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  public titleEdit = (entity: Usuario): string => {\r\n    return \"Editando \" + this.lex.translate(\"Usuário\") + ': ' + (entity?.nome || \"\");\r\n  }\r\n\r\n}\r\n\r\n/*\r\nTESTES A SEREM REALIZADOS NO FORM USUARIOS\r\n\r\n- Para verificar Lotação x Atribuições\r\n\r\nCENÁRIO: CAMINHO FELIZ\r\nFormulário completo do usuário\r\n1. Incluir um usuário com lotação definida e sem atribuições.\r\n2. Incluir um usuário com lotação definida e na mesma unidade inserir novas atribuições compatíveis (não deve estar disponível a atribuição 'LOTADO').\r\n3. Incluir um usuário com lotação definida e na mesma unidade e em várias outras inserir atribuições compatíveis diversas.\r\n4. Alterar um usuário, mudando sua lotação através da aba 'Principal', para uma unidade que não existe ainda na aba 'Atribuições'.\r\n5. Alterar um usuário, mudando sua lotação através da aba 'Principal', para uma unidade que já existe na aba 'Atribuições'.\r\n6. Alterar um usuário, apagando uma ou mais atribuições de uma mesma unidade.\r\n7. Alterar um usuário, apagando o vínculo completo com uma unidade distinta da sua lotação.\r\n8. Tentar incluir um usuário que já existe (mesmo e-mail funcional) e que foi desativado (apagado virtualmente).\r\n9. Tentar incluir um usuário que já existe (mesmo cpf) e que foi desativado (apagado virtualmente).\r\n\r\nCENÁRIO: CAMINHO ALTERNATIVO\r\nFormulário completo do usuário\r\n1. Incluir um usuário com lotação definida e com atribuições repetidas em uma mesma unidade.\r\n2. Incluir um usuário com lotação definida e com atribuições incompatíveis em uma mesma unidade (mais de uma atribuição de gestor).\r\n3. Alterar um usuário apagando sua atribuição de LOTADO na aba 'Atribuições'. \r\n4. Alterar um usuário inserindo atribuições repetidas em uma mesma unidade.\r\n5. Alterar um usuário inserindo atribuições incompatíveis em uma mesma unidade.\r\n6. Alterar um usuário apagando o vínculo completo com a unidade de sua lotação.\r\n7. Alterar um usuário apagando vários vínculos completos com diversas unidades, sem incluir a unidade de lotação.\r\n8. Alterar um usuário apagando vários vínculos completos com diversas unidades, incluindo sua unidade de lotação.\r\n9. Alterar um usuário inserindo a atribuição de 'Gestor' a mais de uma unidade.\r\n\r\nCENÁRIO: CAMINHO ALTERNATIVO\r\nFormulário de 'Atribuições' (menu de opções: ...)\r\n1. Alterar um usuário apagando sua atribuição de LOTADO. \r\n2. Alterar um usuário inserindo atribuições repetidas em uma mesma unidade.\r\n3. Alterar um usuário inserindo atribuições incompatíveis em uma mesma unidade.\r\n4. Alterar um usuário apagando o vínculo completo com a unidade de sua lotação.\r\n5. Alterar um usuário apagando vários vínculos completos com diversas unidades, sem incluir a unidade de lotação.\r\n6. Alterar um usuário apagando vários vínculos completos com diversas unidades, incluindo sua unidade de lotação.\r\n7. Alterar um usuário inserindo a atribuição de 'Gestor' a mais de uma unidade.\r\n\r\n */","<editable-form [form]=\"form!\" [disabled]=\"formDisabled\" [title]=\"isModal ? '' : title\" initialFocus=\"cpf\" (submit)=\"onSaveData()\" (cancel)=\"onCancel()\">\r\n    <tabs display right>\r\n        <tab key=\"PRINCIPAL\" label=\"Principal\">\r\n            <div class=\"row\">\r\n                <div class=\"form-group col-md-3 text-center\">\r\n                    <profile-picture [url]=\"form!.controls.url_foto.value\" class=\"mt-5\" [size]=\"150\"></profile-picture>\r\n                </div>\r\n                <div class=\"form-group col-md-9\">\r\n                    <div class=\"row\">\r\n                        <input-text [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_CPF') ? 'true' : undefined\" [size]=\"3\" label=\"CPF\" controlName=\"cpf\" [maskFormat]=\"'000.000.000-00'\" [attr.maxlength]=15 required></input-text>\r\n                        <input-text [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_MAT') ? 'true' : undefined\" [size]=\"2\" label=\"Matrícula\" controlName=\"matricula\" [attr.maxlength]=250 required></input-text>\r\n                        <input-text [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_MAIL') ? 'true' : undefined\" [size]=\"4\" label=\"E-mail\" controlName=\"email\" textCase=\"lower\" [attr.maxlength]=250 required></input-text>\r\n                        <input-datetime date [size]=\"3\" label=\"Nascimento\" noIcon controlName=\"data_nascimento\" [labelInfo]=\"'Data de nascimento'\"></input-datetime>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <input-text [size]=\"8\" label=\"Nome\" controlName=\"nome\" [attr.maxlength]=250 required></input-text>\r\n                        <input-text [size]=\"4\" label=\"Apelido\" controlName=\"apelido\" [attr.maxlength]=250 required></input-text>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <input-select [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_PERFIL') ? 'true' : undefined\" [size]=\"4\" label=\"Perfil\" controlName=\"perfil_id\" [dao]=\"perfilDao\" required></input-select>\r\n                        <input-search #lotacao label=\"Lotação\" [size]=\"8\" [emptyValue]=\"null\" [control]=\"formLotacao!.controls.unidade_lotacao_id\" controlName=\"unidade_lotacao_id\" [dao]=\"unidadeDao\" labelInfo=\"Unidade de lotação do Usuário\" required></input-search>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <input-select [size]=\"4\" label=\"UF\" icon=\"bi bi-flag\" controlName=\"uf\" [items]=\"lookup.UF\"></input-select>\r\n                        <input-radio [size]=\"4\" label=\"Sexo\" controlName=\"sexo\" [items]=\"lookup.SEXO\"></input-radio>\r\n                        <input-text [size]=\"4\" label=\"Telefone\" controlName=\"telefone\" [maskFormat]=\"'(00) 0000-0000||(00) 0 0000-0000'\" [attr.maxlength]=250></input-text>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </tab>\r\n        <tab key=\"CONFIGURACOES\" label=\"Configurações\">\r\n            <div class=\"row\">\r\n                <input-editor [label]=\"'Texto complementar ' + lex.translate('Plano de Trabalho')\" controlName=\"texto_complementar_plano\" [dataset]=\"planoDataset\"></input-editor>\r\n            </div>\r\n        </tab>\r\n        <tab key=\"ATRIBUICOES\" [label]=\"lex.translate('Atribuições')\">\r\n            <top-alert type=\"alert\" [message]=\"'A alteração ' + lex.translate('de lotação') + ' só pode ser realizada através da abra Principal!'\"></top-alert>\r\n            <usuario-integrante #unidadesIntegrantes noPersist [entity]=\"entity\"></usuario-integrante>\r\n        </tab>\r\n    </tabs>\r\n</editable-form>","import { Component, Injector, Input, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormGroup } from '@angular/forms';\r\nimport { GridComponent } from 'src/app/components/grid/grid.component';\r\nimport { InputSearchComponent } from 'src/app/components/input/input-search/input-search.component';\r\nimport { UnidadeDaoService } from 'src/app/dao/unidade-dao.service';\r\nimport { UnidadeIntegranteDaoService } from 'src/app/dao/unidade-integrante-dao.service';\r\nimport { IIndexable, IntegranteAtribuicao } from 'src/app/models/base.model';\r\nimport { IntegranteConsolidado } from 'src/app/models/unidade-integrante.model';\r\nimport { Usuario } from 'src/app/models/usuario.model';\r\nimport { PageFrameBase } from 'src/app/modules/base/page-frame-base';\r\nimport { LookupItem } from 'src/app/services/lookup.service';\r\nimport { IntegranteService } from 'src/app/services/integrante.service';\r\nimport { UsuarioDaoService } from 'src/app/dao/usuario-dao.service';\r\n\r\n@Component({\r\n  selector: 'usuario-integrante',\r\n  templateUrl: './usuario-integrante.component.html',\r\n  styleUrls: ['./usuario-integrante.component.scss']\r\n})\r\nexport class UsuarioIntegranteComponent extends PageFrameBase {\r\n  @ViewChild(GridComponent, { static: false }) public grid?: GridComponent;\r\n  @ViewChild('unidade', { static: false }) public unidade?: InputSearchComponent;\r\n  @Input() set control(value: AbstractControl | undefined) { super.control = value; } get control(): AbstractControl | undefined { return super.control; }\r\n  @Input() set entity(value: Usuario | undefined) { super.entity = value; } get entity(): Usuario | undefined { return super.entity; }\r\n  @Input() set noPersist(value: string | undefined) { super.noPersist = value; } get noPersist(): string | undefined { return super.noPersist; }\r\n\r\n  public items: IntegranteConsolidado[] = [];\r\n  public integranteService: IntegranteService;\r\n  public integranteDao: UnidadeIntegranteDaoService;\r\n  public unidadeDao: UnidadeDaoService;\r\n  public usuarioDao: UsuarioDaoService;\r\n  public tiposAtribuicao: LookupItem[] = [];\r\n\r\n  constructor(public injector: Injector) {\r\n    super(injector);\r\n    this.integranteService = injector.get<IntegranteService>(IntegranteService);\r\n    this.integranteDao = injector.get<UnidadeIntegranteDaoService>(UnidadeIntegranteDaoService);\r\n    this.unidadeDao = injector.get<UnidadeDaoService>(UnidadeDaoService);\r\n    this.usuarioDao = injector.get<UsuarioDaoService>(UsuarioDaoService);\r\n    this.form = this.fh.FormBuilder({\r\n      unidade_id: { default: \"\" },\r\n      atribuicoes: { default: undefined },\r\n      atribuicao: { default: \"\" },\r\n    }, this.cdRef, this.validate);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.entity_id = this.metadata?.entity_id || this.entity?.id;\r\n    this.tiposAtribuicao = this.isNoPersist ? this.lookup.UNIDADE_INTEGRANTE_TIPO.filter((atribuicao) => atribuicao.key != \"LOTADO\") : this.lookup.UNIDADE_INTEGRANTE_TIPO;\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    (async () => {\r\n      await this.loadData({ id: this.entity_id }, this.form);\r\n    })();\r\n  }\r\n\r\n  /**\r\n   * Método chamado na inicialização do componente para carregar todas as unidades-integrantes do usuário.\r\n   * @param entity \r\n   * @param form \r\n   */\r\n  public async loadData(entity: IIndexable, form?: FormGroup | undefined) {\r\n    if (entity.id) {\r\n      let integrantes: IntegranteConsolidado[] = [];\r\n      try {\r\n        let result = await Promise.all([\r\n          this.usuarioDao.getById(entity.id),\r\n          this.integranteDao!.loadIntegrantes(\"\", entity.id)\r\n        ]);\r\n        this.entity = result[0]!;\r\n        integrantes = result[1].integrantes.filter(x => x.atribuicoes?.length > 0);\r\n      } finally {\r\n        this.items = [];\r\n        integrantes.forEach(i => this.items?.push(this.integranteService.completarIntegrante(i, i.id, entity.id, i.atribuicoes)));\r\n        this.items = this.integranteService.ordenar(this.items);\r\n        this.cdRef.detectChanges();\r\n        this.grid!.loading = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  public validate = (control: AbstractControl, controlName: string) => {\r\n    let result = null;\r\n    if ([\"unidade_id\", \"atribuicoes\"].includes(controlName) && !control.value?.length) { result = \"Obrigatório\"; }\r\n    if (controlName == \"unidade_id\" && this.grid?.adding && this.items.map(i => i.id).includes(control.value)) result = \"O usuário já é integrante desta unidade. Edite-a, ao invés de incluí-la novamente!\";\r\n    return result;\r\n  }\r\n\r\n  public formValidation = (form?: FormGroup) => {\r\n    let atribuicoes: LookupItem[] = form!.controls.atribuicoes.value;\r\n    if (this.util.array_diff(['GESTOR', 'GESTOR_SUBSTITUTO', 'GESTOR_DELEGADO'], atribuicoes.map(na => na.key) || []).length < 2) {\r\n      return \"A um mesmo servidor só pode ser atribuída uma função de gestor, para uma mesma Unidade!\";\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Método chamado para inserir uma atribuição no grid, seja este componente persistente ou não.\r\n   * @returns \r\n   */\r\n  public async addIntegrante() {\r\n    if (this.grid) this.grid.error = '';\r\n    let novo = {\r\n      id: this.integranteDao!.generateUuid(),\r\n      unidade_id: \"\",\r\n      atribuicoes: []\r\n    } as IIndexable;\r\n    return novo;\r\n  }\r\n\r\n  public addItemHandle(): LookupItem | undefined {\r\n    let result = undefined;\r\n    const value = this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO, this.form!.controls.atribuicao.value);\r\n    const key = this.form!.controls.atribuicao.value;\r\n    if (value?.length && this.util.validateLookupItem(this.form!.controls.atribuicao.value, key)) {\r\n      const icon = this.lookup.getIcon(this.lookup.UNIDADE_INTEGRANTE_TIPO, this.form!.controls.atribuicao.value);\r\n      const color = this.lookup.getColor(this.lookup.UNIDADE_INTEGRANTE_TIPO, this.form!.controls.atribuicao.value);\r\n      result = {\r\n        key: key,\r\n        value: value,\r\n        icon: icon,\r\n        color: color\r\n      };\r\n      this.form!.controls.atribuicao.setValue(\"\");\r\n    }\r\n    return result;\r\n  };\r\n\r\n  /**\r\n   * Método chamado na edição de uma atribuição do usuário\r\n   * @param form \r\n   * @param row \r\n   */\r\n  public async loadIntegrante(form: FormGroup, row: any) {\r\n    form.controls.unidade_id.setValue(this.grid?.adding ? row.unidade_id : row.id);\r\n    form.controls.atribuicoes.setValue(this.integranteService.converterAtribuicoes(row.atribuicoes));\r\n    form.controls.atribuicao.setValue(\"\");\r\n  }\r\n\r\n  /**\r\n   * Método chamado para a exclusão de uma atribuição do grid, seja este componente persistente ou não. \r\n   * @param row \r\n   * @returns \r\n   */\r\n  public async removeIntegrante(row: IntegranteConsolidado) {\r\n    let nomeServidor = this.entity!.nome;\r\n    let nomeUnidade = row.unidade_nome;\r\n    if (row.atribuicoes.length == 1 && row.atribuicoes[0] == \"LOTADO\") {\r\n      await this.dialog.alert(\"IMPOSSÍVEL EXCLUIR !\", \"Um vínculo não pode ser excluído quando sua única atribuição é \" + this.lex.translate('a lotação') + \" \" + this.lex.translate('do servidor') + \". Se quiser alterar \" + this.lex.translate('a lotação') + \", \" + (this.isNoPersist ? \"use a aba Principal.\" : \"utilize a aba Principal na edição do cadastro \" + this.lex.translate('do usuário') + \".\"));\r\n    } else {\r\n      let confirm = await this.dialog.confirm(\"Exclui ?\", \"Deseja realmente excluir todas as atribuições do servidor '\" + nomeServidor + \"' na unidade '\" + nomeUnidade + \"' ?\");\r\n      if (confirm) {\r\n        let msg: string | undefined;\r\n        try {\r\n          if (!this.isNoPersist) {    // se persistente\r\n            this.loading = true;\r\n            await this.integranteDao.saveIntegrante([this.integranteService.completarIntegrante(row, row.id, this.entity!.id, [])]).then(resposta => {\r\n              if (msg = resposta.find(v => v._metadata.msg?.length)?._metadata.msg) { if (this.grid) this.grid.error = msg; };\r\n            });\r\n            await this.loadData({ id: this.entity!.id }, this.form);\r\n          } else {                    // se não persistente\r\n            Object.assign(row, { '_status': \"DELETE\", 'atribuicoes': [] });\r\n            return false;\r\n          }\r\n        } catch (e: any) {\r\n          this.loading = false;\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n        //return msg ? false : true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Garante que não será possível excluir a lotação de um servidor por este caminho\r\n   * @param row Atribuição do servidor na unidade\r\n   * @returns \r\n   */\r\n  public deleteItemHandle(row: LookupItem): boolean | undefined | void {\r\n    return row.key != \"LOTADO\";\r\n  };\r\n\r\n  /**\r\n   * Método chamado no salvamento de uma unidade-integrante (new/edit), seja este componente persistente ou não.\r\n   * @param form \r\n   * @param row \r\n   * @returns \r\n   */\r\n  public async saveIntegrante(form: FormGroup, row: IntegranteConsolidado) {\r\n    form.controls.atribuicoes.setValue(this.lookup.uniqueLookupItem(form!.controls.atribuicoes.value));\r\n/*     if (this.grid) this.grid!.error = \"\";\r\n    this.cdRef.detectChanges(); */\r\n    let error: any = undefined;\r\n    //error = this.formValidation(form);\r\n    if (!error) {\r\n      let confirm = true;\r\n      let n = this.integranteService.alterandoGestor(form, row.atribuicoes || []);\r\n      if (n.length) confirm = await this.dialog.confirm(\"Confirma a Alteração de Gestor ?\", n.length == 1 ? \"O \" + n[0] + \" será alterado.\" : \"Serão alterados: \" + n.join(', ') + \".\");\r\n      if (form!.controls.atribuicoes.value.length && confirm) {\r\n        this.loading = true;\r\n        try {\r\n          let novasAtribuicoes: IntegranteAtribuicao[] = form!.controls.atribuicoes.value.map((x: LookupItem) => x.key);\r\n          if (!this.isNoPersist) { // se persistente\r\n            await this.integranteDao.saveIntegrante([this.integranteService.completarIntegrante(row, form!.controls.unidade_id.value, this.entity!.id, novasAtribuicoes)]).then(resposta => {\r\n              let msg: string | undefined;\r\n              if (msg = resposta?.find(v => v._metadata.msg?.length)?._metadata.msg) { if (this.grid) this.grid!.error = msg; };\r\n            });\r\n            await this.loadData({ id: this.entity!.id }, this.form);\r\n            if (this.grid) this.grid!.error = \"\";\r\n          } else {                // se não persistente\r\n            this.substituirItem(row, novasAtribuicoes);\r\n          }\r\n        } catch (error: any) {\r\n          if (this.grid) this.grid.error = error;\r\n          await this.loadData({ id: this.entity!.id }, this.form);\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      }\r\n    } else {\r\n      if (this.grid) this.grid.error = \"ATENÇÃO\" + \"&\" + error;\r\n      this.substituirItem(row, form.controls.atribuicoes.value.map((x: LookupItem) => x.key));\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  public substituirItem(row: IntegranteConsolidado, atribuicoes: IntegranteAtribuicao[]){\r\n    let index = this.items!.findIndex(x => x[\"id\"] == row[\"id\"]);\r\n    this.items![index!] = this.integranteService.completarIntegrante(\r\n      { id: row.id, unidade_sigla: this.unidade?.selectedItem?.entity.sigla, unidade_nome: this.unidade?.selectedItem?.entity.nome, unidade_codigo: this.unidade?.selectedItem?.entity.codigo },\r\n      this.form!.controls.unidade_id.value, this.entity!.id, atribuicoes\r\n    );\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n\r\n}\r\n","<grid #grid [items]=\"items\" [minHeight]=\"500\" [form]=\"form!\" [hasDelete]=\"true\" editable\r\n    [add]=\"addIntegrante.bind(this)\" [load]=\"loadIntegrante.bind(this)\" [remove]=\"removeIntegrante.bind(this)\" [save]=\"saveIntegrante.bind(this)\">\r\n    <span *ngIf=\"!isNoPersist\"><strong>{{ 'Servidor: ' + entity?.nome }}</strong></span>\r\n    <top-alert *ngIf=\"!isNoPersist\" type=\"alert\" [message]=\"'Para alterar ' + lex.translate('a lotação') + ' é necessário utilizar a abra Principal na edição do cadastro ' + lex.translate('do usuário') + '!'\"></top-alert>\r\n    <columns>\r\n        <column [title]=\"lex.translate('Unidades')\" [template]=\"columnUnidade\" [editTemplate]=\"editUnidade\">\r\n            <ng-template let-row=\"row\" #columnUnidade>\r\n                <strong>{{ row.unidade_sigla || '' }}</strong><span> {{ row.informal ? '(Unidade Informal)' : '(Código: ' + (row.unidade_codigo || '') + ')' }}</span><br>\r\n                <span>{{ row.unidade_nome || '' }} </span>\r\n            </ng-template>\r\n            <ng-template let-row=\"row\" #editUnidade>\r\n                <input-search #unidade [size]=\"12\" label icon controlName=\"unidade_id\" [dao]=\"unidadeDao\"></input-search>\r\n            </ng-template>\r\n        </column>\r\n        <column [title]=\"lex.translate('Atribuições')\" [template]=\"columnAtribuicoes\" [editTemplate]=\"editAtribuicoes\">\r\n            <ng-template let-row=\"row\" #columnAtribuicoes>\r\n                <div *ngFor=\"let a of row.atribuicoes\">\r\n                    <badge [color]=\"lookup.getColor(lookup.UNIDADE_INTEGRANTE_TIPO, a || '')\" [icon]=\"lookup.getIcon(lookup.UNIDADE_INTEGRANTE_TIPO, a || '')\" [label]=\"lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, a || '')\"></badge><br>\r\n                </div>\r\n            </ng-template>\r\n            <ng-template let-row=\"row\" #editAtribuicoes>\r\n                <input-multiselect controlName=\"atribuicoes\" [size]=\"8\" [addItemHandle]=\"addItemHandle.bind(this)\" [deleteItemHandle]=\"deleteItemHandle.bind(this)\">\r\n                    <input-select [size]=\"12\" label=\"\" icon=\"fas fa-sign-out-alt\" controlName=\"atribuicao\" [items]=\"tiposAtribuicao\"></input-select>\r\n                </input-multiselect>\r\n            </ng-template>\r\n        </column>\r\n        <column type=\"options\"></column>\r\n    </columns>\r\n</grid>\r\n","import { Component, Injector, ViewChild } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { GridComponent } from 'src/app/components/grid/grid.component';\r\nimport { ToolbarButton } from 'src/app/components/toolbar/toolbar.component';\r\nimport { PerfilDaoService } from 'src/app/dao/perfil-dao.service';\r\nimport { UnidadeDaoService } from 'src/app/dao/unidade-dao.service';\r\nimport { UsuarioDaoService } from 'src/app/dao/usuario-dao.service';\r\nimport { Usuario } from 'src/app/models/usuario.model';\r\nimport { PageListBase } from 'src/app/modules/base/page-list-base';\r\n\r\n@Component({\r\n  selector: 'app-usuario-list',\r\n  templateUrl: './usuario-list.component.html',\r\n  styleUrls: ['./usuario-list.component.scss']\r\n})\r\nexport class UsuarioListComponent extends PageListBase<Usuario, UsuarioDaoService> {\r\n  @ViewChild(GridComponent, { static: false }) public grid?: GridComponent;\r\n\r\n  public unidadeDao: UnidadeDaoService;\r\n  public perfilDao: PerfilDaoService;\r\n\r\n  constructor(public injector: Injector) {\r\n    super(injector, Usuario, UsuarioDaoService);\r\n    this.unidadeDao = injector.get<UnidadeDaoService>(UnidadeDaoService);\r\n    this.perfilDao = injector.get<PerfilDaoService>(PerfilDaoService);\r\n    /* Inicializações */\r\n    this.title = this.lex.translate(\"Usuários\");\r\n    this.code = \"MOD_CFG_USER\";\r\n    this.join = [\"perfil:id,nome\"];\r\n    this.filter = this.fh.FormBuilder({\r\n      usuario: { default: \"\" },\r\n      unidade_id: { default: \"\" },\r\n      perfil_id: { default: null }\r\n    });\r\n    this.addOption(this.OPTION_INFORMACOES, \"MOD_USER\");\r\n    //this.addOption(this.OPTION_EXCLUIR, \"MOD_USER_EXCL\");       // Tratar de forma diferenciada a exclusão de usuário\r\n  }\r\n\r\n  public dynamicOptions(row: any): ToolbarButton[] {\r\n    let result: ToolbarButton[] = [];\r\n    // Testa se o usuário logado possui permissão para gerenciar as atribuições do usuário do grid\r\n    if (this.auth.hasPermissionTo(\"MOD_USER_ATRIB\")) result.push({ label: \"Atribuições\", icon: \"bi bi-list-task\",  onClick: (usuario: Usuario) => { this.go.navigate({ route: ['configuracoes', 'usuario', '', usuario.id, 'integrante'] }, { metadata: { entity_id: row.id } }); }});\r\n    return result;\r\n  }\r\n\r\n  public filterWhere = (filter: FormGroup) => {\r\n    let result: any[] = [];\r\n    if (filter?.controls.usuario?.value?.length) {\r\n      result.push([\"nome\", \"like\", \"%\" + filter?.controls.usuario?.value.trim().replace(\" \", \"%\") + \"%\"]);\r\n    }\r\n    if (filter?.controls.unidade_id?.value?.length) {\r\n      result.push([\"lotacao\", \"==\", filter?.controls.unidade_id.value]);\r\n    }\r\n    if (filter?.controls.perfil_id?.value?.length) {\r\n      result.push([\"perfil_id\", \"==\", filter?.controls.perfil_id?.value]);\r\n    }\r\n    return result;\r\n  }\r\n}\r\n","<h3 *ngIf=\"!isModal\" class=\"my-2\">{{title}}</h3>\r\n<grid [dao]=\"dao\" [add]=\"add\" [orderBy]=\"orderBy\" [groupBy]=\"groupBy\" [join]=\"join\"\r\n    [selectable]=\"selectable\" (select)=\"onSelect($event)\"\r\n    [hasAdd]=\"auth.hasPermissionTo('MOD_USER_INCL')\"\r\n    [hasEdit]=\"auth.hasPermissionTo('MOD_USER_EDT')\">\r\n    <toolbar *ngIf=\"!selectable\"></toolbar>\r\n    <filter [form]=\"filter\" [where]=\"filterWhere\" [submit]=\"filterSubmit.bind(this)\" [collapseChange]=\"filterCollapseChange.bind(this)\" [collapsed]=\"!selectable && filterCollapsed\">\r\n        <div class=\"row\">\r\n            <input-text [size]=\"4\" [label]=\"lex.translate('Usuário')\" controlName=\"usuario\" [control]=\"filter!.controls.usuario\" placeholder=\"Nome\" [attr.maxlength]=250></input-text>\r\n            <input-search [size]=\"4\" [label]=\"lex.translate('Lotação')\" [control]=\"filter!.controls.unidade_id\" controlName=\"unidade_id\" [dao]=\"unidadeDao\"></input-search>\r\n            <input-select [size]=\"4\" [label]=\"lex.translate('Perfil')\" controlName=\"perfil_id\" nullable [control]=\"filter!.controls.perfil_id\" [dao]=\"perfilDao\"></input-select>\r\n        </div>\r\n    </filter>\r\n    <columns>\r\n        <column icon=\"bi-person\" [align]=\"'center'\" [template]=\"columnFoto\">\r\n            <ng-template let-row=\"row\" #columnFoto>\r\n                <profile-picture [url]=\"row.url_foto\" [size]=\"40\" [hint]=\"row.nome\"></profile-picture>\r\n            </ng-template>\r\n        </column>\r\n        <column title=\"CPF\" field=\"cpf\"></column>\r\n        <column title=\"Matrícula\" field=\"matricula\"></column>\r\n        <column title=\"Nome\" field=\"nome\" orderBy=\"nome\"></column>\r\n        <column [title]=\"lex.translate('Perfil')\" [template]=\"columnPerfil\">\r\n            <ng-template let-row=\"row\" #columnPerfil>\r\n                <strong>{{row.perfil?.nome || \"\"}}</strong>\r\n            </ng-template>\r\n        </column>\r\n        <column type=\"options\" [onEdit]=\"edit\" [dynamicOptions]=\"dynamicOptions.bind(this)\" [options]=\"options\"></column>\r\n    </columns>\r\n    <pagination [rows]=\"rowsLimit\"></pagination>\r\n</grid>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { AuthGuard } from 'src/app/guards/auth.guard';\r\nimport { ConfigResolver } from 'src/app/resolvies/config.resolver';\r\nimport { UsuarioFormComponent } from './usuario-form/usuario-form.component';\r\nimport { UsuarioListComponent } from './usuario-list/usuario-list.component';\r\nimport { UsuarioIntegranteComponent } from './usuario-integrante/usuario-integrante.component';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: UsuarioListComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Usuários\" } },\r\n  { path: 'new', component: UsuarioFormComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Inclusão de Usuário\", modal: true } },\r\n  { path: ':id/edit', component: UsuarioFormComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Edição de Usuário\", modal: true } },\r\n  { path: ':id/consult', component: UsuarioFormComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Consulta a Usuário\", modal: true } },\r\n  { path: ':id/:idUsuario/integrante', component: UsuarioIntegranteComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Atribuições do Usuário\", modal: true } },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class UsuarioRoutingModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { UsuarioRoutingModule } from './usuario-routing.module';\r\nimport { UsuarioListComponent } from './usuario-list/usuario-list.component';\r\nimport { ComponentsModule } from 'src/app/components/components.module';\r\nimport { UsuarioFormComponent } from './usuario-form/usuario-form.component';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { UsuarioIntegranteComponent } from './usuario-integrante/usuario-integrante.component';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    UsuarioListComponent,\r\n    UsuarioFormComponent,\r\n    UsuarioIntegranteComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ComponentsModule,\r\n    ReactiveFormsModule,\r\n    UsuarioRoutingModule\r\n  ]\r\n})\r\nexport class UsuarioModule { }\r\n"],"names":["Base","IntegranteConsolidado","constructor","data","id","atribuicoes","initialization","UnidadeIntegrante","usuario_id","unidade_id","EditableFormComponent","PerfilDaoService","PlanoTrabalhoDaoService","UnidadeDaoService","UsuarioDaoService","Usuario","PageFormBase","UsuarioIntegranteComponent","UnidadeIntegranteDaoService","UsuarioFormComponent","injector","validate","control","controlName","result","util","validarCPF","value","indexOf","dao","validDateTime","formValidation","form","formLotacao","controls","unidade_lotacao_id","length","erros_atribuicoes","unidadesIntegrantes","grid","items","forEach","unidadeIntegrante","push","integrante","erro","undefined","titleEdit","entity","lex","translate","nome","perfilDao","get","unidadeDao","integranteDao","planoTrabalhoDao","fh","FormBuilder","email","default","cpf","matricula","apelido","telefone","uf","sexo","url_foto","texto_complementar_plano","perfil_id","data_nascimento","cdRef","planoDataset","dataset","join","loadData","_this","_asyncToGenerator","formValue","Object","assign","patchValue","fillForm","setValue","lotacao","unidade","initializeData","saveData","_this2","Promise","_ref","resolve","reject","confirm","usuario","fill","lotacao_id","integrantesConsolidados","indicesIntegrantesExcluir","filter","x","_status","i","indiceVinculoLotacao","findIndex","ic","includes","lotacaoAlterada","usuarioEhGestor","submitting","dialog","alert","save","then","_ref2","usuarioBanco","indiceNovaUnidadeLotacao","saveIntegrante","_x3","apply","arguments","error","editableForm","_x","_x2","_","i0","ɵɵdirectiveInject","Injector","_2","selectors","viewQuery","UsuarioFormComponent_Query","rf","ctx","ɵɵelementStart","ɵɵlistener","UsuarioFormComponent_Template_editable_form_submit_0_listener","onSaveData","UsuarioFormComponent_Template_editable_form_cancel_0_listener","onCancel","ɵɵelement","ɵɵelementEnd","ɵɵproperty","formDisabled","isModal","title","ɵɵadvance","auth","hasPermissionTo","ɵɵattribute","lookup","UF","SEXO","GridComponent","PageFrameBase","IntegranteService","ɵɵtext","ɵɵtextInterpolate","ctx_r1","ctx_r2","row_r11","unidade_sigla","ɵɵtextInterpolate1","informal","unidade_codigo","unidade_nome","ctx_r6","ctx_r15","getColor","UNIDADE_INTEGRANTE_TIPO","a_r16","getIcon","getValue","ɵɵtemplate","UsuarioIntegranteComponent_ng_template_11_div_0_Template","row_r14","ctx_r10","addItemHandle","bind","deleteItemHandle","tiposAtribuicao","noPersist","adding","map","array_diff","na","key","integranteService","usuarioDao","atribuicao","ngOnInit","entity_id","metadata","isNoPersist","ngAfterViewInit","integrantes","all","getById","loadIntegrantes","completarIntegrante","ordenar","detectChanges","loading","addIntegrante","_this3","novo","generateUuid","validateLookupItem","icon","color","loadIntegrante","row","_this4","converterAtribuicoes","removeIntegrante","_this5","nomeServidor","nomeUnidade","msg","resposta","find","v","_metadata","e","_this6","uniqueLookupItem","n","alterandoGestor","novasAtribuicoes","substituirItem","index","selectedItem","sigla","codigo","UsuarioIntegranteComponent_Query","UsuarioIntegranteComponent_span_2_Template","UsuarioIntegranteComponent_top_alert_3_Template","UsuarioIntegranteComponent_ng_template_6_Template","ɵɵtemplateRefExtractor","UsuarioIntegranteComponent_ng_template_8_Template","UsuarioIntegranteComponent_ng_template_11_Template","UsuarioIntegranteComponent_ng_template_13_Template","_r3","_r5","_r7","_r9","PageListBase","ctx_r0","row_r6","row_r7","perfil","UsuarioListComponent","filterWhere","trim","replace","code","addOption","OPTION_INFORMACOES","dynamicOptions","label","onClick","go","navigate","route","UsuarioListComponent_Query","UsuarioListComponent_h3_0_Template","UsuarioListComponent_Template_grid_select_1_listener","$event","onSelect","UsuarioListComponent_toolbar_2_Template","UsuarioListComponent_ng_template_10_Template","UsuarioListComponent_ng_template_16_Template","add","orderBy","groupBy","selectable","filterSubmit","filterCollapseChange","filterCollapsed","_r2","_r4","edit","options","rowsLimit","RouterModule","AuthGuard","ConfigResolver","routes","path","component","canActivate","config","runGuardsAndResolvers","modal","UsuarioRoutingModule","_3","forChild","imports","i1","exports","CommonModule","ComponentsModule","ReactiveFormsModule","UsuarioModule","declarations"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}