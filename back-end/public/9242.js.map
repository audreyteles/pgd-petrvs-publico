{"version":3,"file":"9242.js","mappings":"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","sources":["./src/app/modules/configuracoes/usuario/usuario-form/usuario-form.component.ts","./src/app/modules/configuracoes/usuario/usuario-form/usuario-form.component.html","./src/app/modules/configuracoes/usuario/usuario-integrante/usuario-integrante.component.ts","./src/app/modules/configuracoes/usuario/usuario-integrante/usuario-integrante.component.html","./src/app/modules/configuracoes/usuario/usuario-list/usuario-list.component.ts","./src/app/modules/configuracoes/usuario/usuario-list/usuario-list.component.html","./src/app/modules/configuracoes/usuario/usuario-routing.module.ts","./src/app/modules/configuracoes/usuario/usuario.module.ts"],"sourcesContent":["import { Component, Injector, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormGroup } from '@angular/forms';\r\nimport { EditableFormComponent } from 'src/app/components/editable-form/editable-form.component';\r\nimport { PerfilDaoService } from 'src/app/dao/perfil-dao.service';\r\nimport { PlanoTrabalhoDaoService } from 'src/app/dao/plano-trabalho-dao.service';\r\nimport { UnidadeDaoService } from 'src/app/dao/unidade-dao.service';\r\nimport { UsuarioDaoService } from 'src/app/dao/usuario-dao.service';\r\nimport { IIndexable } from 'src/app/models/base.model';\r\nimport { Usuario } from 'src/app/models/usuario.model';\r\nimport { PageFormBase } from 'src/app/modules/base/page-form-base';\r\nimport { UsuarioIntegranteComponent } from '../usuario-integrante/usuario-integrante.component';\r\nimport { TemplateDataset } from 'src/app/modules/uteis/templates/template.service';\r\nimport { UnidadeIntegranteDaoService } from 'src/app/dao/unidade-integrante-dao.service';\r\nimport { IntegranteConsolidado } from 'src/app/models/unidade-integrante.model';\r\nimport { InputSearchComponent } from 'src/app/components/input/input-search/input-search.component';\r\n\r\n@Component({\r\n  selector: 'app-usuario-form',\r\n  templateUrl: './usuario-form.component.html',\r\n  styleUrls: ['./usuario-form.component.scss']\r\n})\r\nexport class UsuarioFormComponent extends PageFormBase<Usuario, UsuarioDaoService> {\r\n  @ViewChild(EditableFormComponent, { static: false }) public editableForm?: EditableFormComponent;\r\n  @ViewChild(UsuarioIntegranteComponent, { static: false }) public unidadesIntegrantes?: UsuarioIntegranteComponent;\r\n  @ViewChild('lotacao', { static: false }) public lotacao?: InputSearchComponent;\r\n\r\n  //public perfilDao: PerfilDaoService;\r\n  public unidadeDao: UnidadeDaoService;\r\n  public integranteDao: UnidadeIntegranteDaoService;\r\n  public planoTrabalhoDao: PlanoTrabalhoDaoService;\r\n  public planoDataset: TemplateDataset[];\r\n\r\n  constructor(public injector: Injector) {\r\n    super(injector, Usuario, UsuarioDaoService);\r\n    //this.perfilDao = injector.get<PerfilDaoService>(PerfilDaoService);\r\n    this.unidadeDao = injector.get<UnidadeDaoService>(UnidadeDaoService);\r\n    this.integranteDao = injector.get<UnidadeIntegranteDaoService>(UnidadeIntegranteDaoService);\r\n    this.planoTrabalhoDao = injector.get<PlanoTrabalhoDaoService>(PlanoTrabalhoDaoService);\r\n    this.form = this.fh.FormBuilder({\r\n      email: { default: \"\" },\r\n      nome: { default: \"\" },\r\n      cpf: { default: \"\" },\r\n      matricula: { default: \"\" },\r\n      apelido: { default: \"\" },\r\n      telefone: { default: \"\" },\r\n      uf: { default: \"\" },\r\n      sexo: { default: null },\r\n      url_foto: { default: \"\" },\r\n      texto_complementar_plano: { default: \"\" },\r\n      //perfil_id: { default: null },\r\n      data_nascimento: { default: null },\r\n    }, this.cdRef, this.validate);\r\n    this.planoDataset = this.planoTrabalhoDao.dataset();\r\n  }\r\n\r\n  public async loadData(entity: Usuario, form: FormGroup): Promise<void> {\r\n    let formValue = Object.assign({}, form.value);\r\n    form.patchValue(this.util.fillForm(formValue, entity));\r\n    await this.unidadesIntegrantes?.loadData(entity);\r\n  }\r\n\r\n  public initializeData(form: FormGroup): void {\r\n    this.entity = new Usuario();\r\n    this.loadData(this.entity, form);\r\n  }\r\n\r\n  public validate = (control: AbstractControl, controlName: string) => {\r\n    let result = null;\r\n    if (controlName == \"cpf\" && !this.util.validarCPF(control.value)) {\r\n      result = \"Inválido\";\r\n    }\r\n    if(['data_nascimento'].indexOf(controlName) >= 0 && !this.dao?.validDateTime(control.value)) {\r\n      result = \"Inválido\";\r\n    }\r\n    return result;\r\n  }\r\n\r\n  public formValidation = (form?: FormGroup) => {\r\n    if (!this.unidadesIntegrantes?.grid?.items.find((item, index, array) => item.atribuicoes.includes('LOTADO'))) {\r\n      return \"É obrigatória a definição \" + this.lex.translate('da unidade') + \" \" + this.lex.translate('de lotação') + \" \" + this.lex.translate('do servidor') + \"! Defina-a na aba 'Atribuições'.\";\r\n    }\r\n    if (this.unidadesIntegrantes?.grid?.items.find((item, index, array) => !(item.unidade_id.length && item.usuario_id.length))) return \"Na aba 'Atribuições' há \" + this.lex.translate('unidade') + \" com edição não concluída. Conclua-a antes de salvar \" + this.lex.translate('o servidor') + \"!\"\r\n    return undefined;\r\n  }\r\n\r\n  public saveData(form: IIndexable): Promise<boolean> {\r\n    return new Promise<boolean>(async (resolve, reject) => {\r\n      this.unidadesIntegrantes!.grid!.confirm();\r\n      let usuario = this.util.fill(new Usuario(), this.entity!);\r\n      usuario = this.util.fillForm(usuario, this.form!.value);\r\n      usuario.perfil_id = this.unidadesIntegrantes?.formPerfil.controls.perfil_id.value;\r\n      let integrantesConsolidados: IntegranteConsolidado[] = this.unidadesIntegrantes?.items || [];\r\n      let indiceVinculoLotacao = integrantesConsolidados.findIndex(ic => ic.atribuicoes.includes(\"LOTADO\"));\r\n      integrantesConsolidados.forEach((item, index, array) => { if(index != indiceVinculoLotacao && item._status == 'DELETE') item.atribuicoes = []; });\r\n      usuario.integrantes = integrantesConsolidados;\r\n          resolve(usuario);\r\n    });\r\n  }\r\n\r\n  public titleEdit = (entity: Usuario): string => {\r\n    return \"Editando \" + this.lex.translate(\"Usuário\") + ': ' + (entity?.nome || \"\");\r\n  }\r\n\r\n}\r\n\r\n/*\r\nTESTES MÍNIMOS RECOMENDADOS PARA A VALIDAÇÃO DO COMPONENTE - USUARIO-FORM\r\n\r\n- Para verificar Lotação x Atribuições\r\n\r\nCENÁRIO: CAMINHO FELIZ\r\nFormulário completo do usuário\r\n1. Incluir um usuário com lotação definida e sem atribuições.\r\n2. Incluir um usuário com lotação definida e na mesma unidade inserir novas atribuições compatíveis (não deve estar disponível a atribuição 'LOTADO').\r\n3. Incluir um usuário com lotação definida e na mesma unidade e em várias outras inserir atribuições compatíveis diversas.\r\n4. Alterar um usuário, mudando sua lotação através da aba 'Principal', para uma unidade que não existe ainda na aba 'Atribuições'.\r\n5. Alterar um usuário, mudando sua lotação através da aba 'Principal', para uma unidade que já existe na aba 'Atribuições'.\r\n6. Alterar um usuário, apagando uma ou mais atribuições de uma mesma unidade.\r\n7. Alterar um usuário, apagando o vínculo completo com uma unidade distinta da sua lotação.\r\n8. Tentar incluir um usuário que já existe (mesmo e-mail funcional) e que foi desativado (apagado virtualmente).\r\n9. Tentar incluir um usuário que já existe (mesmo cpf) e que foi desativado (apagado virtualmente).\r\n\r\nCENÁRIO: CAMINHO ALTERNATIVO\r\nFormulário completo do usuário\r\n1. Incluir um usuário com lotação definida e com atribuições repetidas em uma mesma unidade.\r\n2. Incluir um usuário com lotação definida e com atribuições incompatíveis em uma mesma unidade (mais de uma atribuição de gestor).\r\n3. Alterar um usuário apagando sua atribuição de LOTADO na aba 'Atribuições'. \r\n4. Alterar um usuário inserindo atribuições repetidas em uma mesma unidade.\r\n5. Alterar um usuário inserindo atribuições incompatíveis em uma mesma unidade.\r\n6. Alterar um usuário apagando o vínculo completo com a unidade de sua lotação.\r\n7. Alterar um usuário apagando vários vínculos completos com diversas unidades, sem incluir a unidade de lotação.\r\n8. Alterar um usuário apagando vários vínculos completos com diversas unidades, incluindo sua unidade de lotação.\r\n9. Alterar um usuário inserindo a atribuição de 'Gestor' a mais de uma unidade.\r\n\r\nCENÁRIO: CAMINHO ALTERNATIVO\r\nFormulário de 'Atribuições' (menu de opções: ...)\r\n1. Alterar um usuário apagando sua atribuição de LOTADO. \r\n2. Alterar um usuário inserindo atribuições repetidas em uma mesma unidade.\r\n3. Alterar um usuário inserindo atribuições incompatíveis em uma mesma unidade.\r\n4. Alterar um usuário apagando o vínculo completo com a unidade de sua lotação.\r\n5. Alterar um usuário apagando vários vínculos completos com diversas unidades, sem incluir a unidade de lotação.\r\n6. Alterar um usuário apagando vários vínculos completos com diversas unidades, incluindo sua unidade de lotação.\r\n7. Alterar um usuário inserindo a atribuição de 'Gestor' a mais de uma unidade.\r\n\r\n */","<editable-form [form]=\"form!\" [disabled]=\"formDisabled\" [title]=\"isModal ? '' : title\" initialFocus=\"cpf\" (submit)=\"onSaveData()\" (cancel)=\"onCancel()\">\r\n    <tabs display right>\r\n        <tab key=\"PRINCIPAL\" label=\"Principal\">\r\n            <div class=\"row\">\r\n                <div class=\"form-group col-md-3 text-center\">\r\n                    <profile-picture [url]=\"form!.controls.url_foto.value\" class=\"mt-5\" [size]=\"150\"></profile-picture>\r\n                </div>\r\n                <div class=\"form-group col-md-9\">\r\n                    <div class=\"row\">\r\n                        <input-text [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_CPF') ? 'true' : undefined\" [size]=\"3\" label=\"CPF\" controlName=\"cpf\" [maskFormat]=\"'000.000.000-00'\" [attr.maxlength]=15 required></input-text>\r\n                        <input-text [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_MAT') ? 'true' : undefined\" [size]=\"2\" label=\"Matrícula\" controlName=\"matricula\" [attr.maxlength]=250 required></input-text>\r\n                        <input-text [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_MAIL') ? 'true' : undefined\" [size]=\"4\" label=\"E-mail\" controlName=\"email\" textCase=\"lower\" [attr.maxlength]=250 required></input-text>\r\n                        <input-datetime date [size]=\"3\" label=\"Nascimento\" noIcon controlName=\"data_nascimento\" [labelInfo]=\"'Data de nascimento'\"></input-datetime>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <input-text [size]=\"5\" label=\"Nome\" controlName=\"nome\" [attr.maxlength]=250 required></input-text>\r\n                        <input-text [size]=\"3\" label=\"Apelido\" controlName=\"apelido\" [attr.maxlength]=250 required></input-text>\r\n                        <input-radio [size]=\"3\" label=\"Sexo\" controlName=\"sexo\" [items]=\"lookup.SEXO\"></input-radio>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <input-select [size]=\"4\" label=\"UF\" icon=\"bi bi-flag\" controlName=\"uf\" [items]=\"lookup.UF\"></input-select>\r\n                        <input-text [size]=\"4\" label=\"Telefone\" controlName=\"telefone\" [maskFormat]=\"'(00) 0000-0000||(00) 0 0000-0000'\" [attr.maxlength]=250></input-text>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </tab>\r\n        <tab key=\"CONFIGURACOES\" label=\"Configurações\">\r\n            <div class=\"row\">\r\n                <input-editor [label]=\"'Texto complementar ' + lex.translate('Plano de Trabalho')\" controlName=\"texto_complementar_plano\" [dataset]=\"planoDataset\"></input-editor>\r\n            </div>\r\n        </tab>\r\n        <tab key=\"ATRIBUICOES\" [label]=\"lex.translate('Atribuições')\">\r\n            <top-alert type=\"alert\" [message]=\"'É impossível excluir ' + lex.translate('a lotação') + ' ' + lex.translate('do servidor') + '. Para alterá-la, lote-o em outra ' + lex.translate('unidade') + '!'\"></top-alert>\r\n<!--             <div class=\"row\">\r\n                <input-select [size]=\"4\" [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_PERFIL') ? 'true' : undefined\" [size]=\"4\" [label]=\"lex.translate('Perfil')\" controlName=\"perfil_id\" [dao]=\"perfilDao\" required></input-select>\r\n                <div class=\"col\">\r\n                    <top-alert type=\"warning\" [message]=\"'Ao conceder a ' + lex.translate('um usuário') + ' a atribuição de ' + lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, 'GESTOR') + ', ' + lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, 'GESTOR_SUBSTITUTO') + ' ou de ' + lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, 'GESTOR_DELEGADO') + ' em ' + lex.translate('uma unidade') + ', deve lhe ser concedido também ' + lex.translate('o nível de acesso') + ' correspondente.'\"></top-alert>\r\n                </div>\r\n            </div> -->\r\n            <usuario-integrante #unidadesIntegrantes noPersist [entity]=\"entity\"></usuario-integrante>\r\n        </tab>\r\n    </tabs>\r\n</editable-form>","import { Component, Injector, Input, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormGroup } from '@angular/forms';\r\nimport { GridComponent } from 'src/app/components/grid/grid.component';\r\nimport { InputSearchComponent } from 'src/app/components/input/input-search/input-search.component';\r\nimport { UnidadeDaoService } from 'src/app/dao/unidade-dao.service';\r\nimport { UnidadeIntegranteDaoService } from 'src/app/dao/unidade-integrante-dao.service';\r\nimport { IIndexable, IntegranteAtribuicao } from 'src/app/models/base.model';\r\nimport { IntegranteConsolidado } from 'src/app/models/unidade-integrante.model';\r\nimport { Usuario } from 'src/app/models/usuario.model';\r\nimport { PageFrameBase } from 'src/app/modules/base/page-frame-base';\r\nimport { LookupItem } from 'src/app/services/lookup.service';\r\nimport { IntegranteService } from 'src/app/services/integrante.service';\r\nimport { UsuarioDaoService } from 'src/app/dao/usuario-dao.service';\r\nimport { PerfilDaoService } from 'src/app/dao/perfil-dao.service';\r\n\r\n@Component({\r\n  selector: 'usuario-integrante',\r\n  templateUrl: './usuario-integrante.component.html',\r\n  styleUrls: ['./usuario-integrante.component.scss']\r\n})\r\nexport class UsuarioIntegranteComponent extends PageFrameBase {\r\n  @ViewChild(GridComponent, { static: false }) public grid?: GridComponent;\r\n  @ViewChild('unidade', { static: false }) public unidade?: InputSearchComponent;\r\n  @Input() set control(value: AbstractControl | undefined) { super.control = value; } get control(): AbstractControl | undefined { return super.control; }\r\n  @Input() set entity(value: Usuario | undefined) { super.entity = value; } get entity(): Usuario | undefined { return super.entity; }\r\n  @Input() set noPersist(value: string | undefined) { super.noPersist = value; } get noPersist(): string | undefined { return super.noPersist; }\r\n\r\n  public formPerfil: FormGroup;\r\n  public items: IntegranteConsolidado[] = [];\r\n  public integranteService: IntegranteService;\r\n  public integranteDao: UnidadeIntegranteDaoService;\r\n  public unidadeDao: UnidadeDaoService;\r\n  public usuarioDao: UsuarioDaoService;\r\n  public perfilDao: PerfilDaoService;\r\n  public perfilUsuario: string = \"\";\r\n\r\n  constructor(public injector: Injector) {\r\n    super(injector);\r\n    this.integranteService = injector.get<IntegranteService>(IntegranteService);\r\n    this.integranteDao = injector.get<UnidadeIntegranteDaoService>(UnidadeIntegranteDaoService);\r\n    this.unidadeDao = injector.get<UnidadeDaoService>(UnidadeDaoService);\r\n    this.usuarioDao = injector.get<UsuarioDaoService>(UsuarioDaoService);\r\n    this.perfilDao = injector.get<PerfilDaoService>(PerfilDaoService);\r\n    this.form = this.fh.FormBuilder({\r\n      unidade_id: { default: \"\" },\r\n      atribuicoes: { default: undefined },\r\n      atribuicao: { default: \"\" },\r\n    }, this.cdRef, this.validate);\r\n    this.formPerfil = this.fh.FormBuilder({\r\n      perfil_id: { default: \"\" }\r\n    }, this.cdRef, this.validate);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n    this.entity = this.entity ?? this.metadata?.entity;\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    (async () => {\r\n      await this.loadData(this.entity || {}, this.form);\r\n    })();\r\n  }\r\n\r\n  public async loadData(entity: IIndexable, form?: FormGroup | undefined) {\r\n    if (entity.id) {\r\n      let integrantes: IntegranteConsolidado[] = [];\r\n      try {\r\n        await this.integranteDao!.carregarIntegrantes(\"\", entity.id).then(resposta => integrantes = resposta.integrantes.filter(x => x.atribuicoes?.length > 0));\r\n      } finally {\r\n        this.perfilUsuario = entity.perfil_id;\r\n        this.formPerfil.controls.perfil_id.setValue(this.perfilUsuario);\r\n        this.items = [];\r\n        integrantes.forEach(i => this.items?.push(this.integranteService.completarIntegrante(i, i.id, entity.id, i.atribuicoes)));\r\n        this.items = this.integranteService.ordenarIntegrantes(this.items);\r\n        this.cdRef.detectChanges();\r\n        this.grid!.loading = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  public async salvarPerfil() {\r\n    this.submitting = true;\r\n    this.usuarioDao?.update(this.entity!.id, { perfil_id: this.formPerfil.controls.perfil_id.value }, []).then(usuario => {\r\n      this.perfilUsuario = usuario.perfil_id;\r\n      this.submitting = false;\r\n    });\r\n  }\r\n\r\n  public validate = (control: AbstractControl, controlName: string) => {\r\n    let result = null;\r\n    if ([\"unidade_id\", \"atribuicoes\"].includes(controlName) && !control.value?.length) { result = \"Obrigatório\"; }\r\n    if (controlName == \"unidade_id\" && this.grid?.adding && this.items.map(i => i.id).includes(control.value)) result = \"O usuário já é integrante desta unidade. Edite-a, ao invés de incluí-la novamente!\";\r\n    return result;\r\n  }\r\n\r\n  public formValidation = (form?: FormGroup) => {\r\n    let atribuicoes: LookupItem[] = form!.controls.atribuicoes.value;\r\n    if (this.util.array_diff(['GESTOR', 'GESTOR_SUBSTITUTO', 'GESTOR_DELEGADO'], atribuicoes.map(na => na.key) || []).length < 2) {\r\n      return \"A um mesmo servidor só pode ser atribuída uma função de gestor (titular, substituto ou delegado), para uma mesma Unidade!\";\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  public addItemHandle(): LookupItem | undefined {\r\n    let result = undefined;\r\n    const value = this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO, this.form!.controls.atribuicao.value);\r\n    const key = this.form!.controls.atribuicao.value;\r\n    if (value?.length && this.util.validateLookupItem(this.form!.controls.atribuicao.value, key)) {\r\n      const icon = this.lookup.getIcon(this.lookup.UNIDADE_INTEGRANTE_TIPO, this.form!.controls.atribuicao.value);\r\n      const color = this.lookup.getColor(this.lookup.UNIDADE_INTEGRANTE_TIPO, this.form!.controls.atribuicao.value);\r\n      result = {\r\n        key: key,\r\n        value: value,\r\n        icon: icon,\r\n        color: color\r\n      };\r\n      this.form!.controls.atribuicao.setValue(\"\");\r\n    }\r\n    return result;\r\n  };\r\n\r\n  public deleteItemHandle(row: LookupItem): boolean | undefined | void {\r\n    return row.key != \"LOTADO\";\r\n  };\r\n\r\n  /**\r\n   * Método chamado na edição de uma atribuição do usuário\r\n   * @param form \r\n   * @param row \r\n   */\r\n  public async carregarIntegrante(form: FormGroup, row: any) {\r\n    form.controls.unidade_id.setValue(this.grid?.adding ? row.unidade_id : row.id);\r\n    form.controls.atribuicoes.setValue(this.integranteService.converterAtribuicoes(row.atribuicoes));\r\n    form.controls.atribuicao.setValue(\"\");\r\n  }\r\n\r\n  /**\r\n * Método chamado para inserir uma atribuição no grid, seja este componente persistente ou não.\r\n * @returns \r\n */\r\n  public async adicionarIntegrante() {\r\n    if (this.grid) this.grid.error = '';\r\n    let novo = {\r\n      id: this.integranteDao!.generateUuid(),\r\n      unidade_id: \"\",\r\n      atribuicoes: []\r\n    } as IIndexable;\r\n    return novo;\r\n  }\r\n\r\n  /**\r\n   * Método chamado para a exclusão de uma atribuição do grid, seja este componente persistente ou não. \r\n   * @param row \r\n   * @returns \r\n   */\r\n  public async removerIntegrante(row: IntegranteConsolidado) {\r\n    if (row.atribuicoes.includes(\"LOTADO\")) {\r\n      await this.dialog.alert(\"IMPOSSÍVEL EXCLUIR !\", \"O vínculo que inclui \" + this.lex.translate('a lotação') + \" \" + this.lex.translate('do servidor') + \" não pode ser excluído. Se deseja excluir as demais atribuições, edite o vínculo. Se deseja alterar \" + this.lex.translate('a lotação') + \", lote-o em outra \" + this.lex.translate('Unidade') + \".\");\r\n    } else {\r\n      let confirm = await this.dialog.confirm(\"Exclui ?\", \"Deseja realmente excluir todas as atribuições de \" + this.entity!.nome.toUpperCase() + \" \" + this.lex.translate('na unidade') + \" \" + row.unidade_sigla?.toUpperCase() + \" ?\");\r\n      if (confirm) {\r\n        let msg: string | undefined;\r\n        try {\r\n          if (!this.isNoPersist) {    // se persistente\r\n            this.loading = true;\r\n            await this.integranteDao.salvarIntegrantes([this.integranteService.completarIntegrante(row, row.id, this.entity!.id, [])]).then(resposta => {\r\n              if (msg = resposta.find(v => v._metadata.msg?.length)?._metadata.msg) { if (this.grid) this.grid.error = msg; };\r\n            });\r\n            await this.loadData({ id: this.entity!.id }, this.form);\r\n          } else {                    // se não persistente\r\n            Object.assign(row, { '_status': \"DELETE\", 'atribuicoes': [] });\r\n            return false;\r\n          }\r\n        } finally {\r\n          this.loading = false;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Método chamado no salvamento de uma unidade-integrante (new/edit), seja este componente persistente ou não.\r\n   * @param form \r\n   * @param row \r\n   * @returns \r\n   */\r\n  public async salvarIntegrante(form: FormGroup, row: IntegranteConsolidado) {\r\n    let novasAtribuicoes = this.lookup.uniqueLookupItem(form!.controls.atribuicoes.value);\r\n    form.controls.atribuicoes.setValue(novasAtribuicoes);\r\n    if (this.grid) this.grid.error = \"\";\r\n    this.cdRef.detectChanges();\r\n    let error = this.formValidation(form);\r\n    if (!error) {\r\n      let itensGrid = this.grid?.items as IntegranteConsolidado[] || [];\r\n      let confirm = true;\r\n      let alteracaoGestor = this.integranteService.haAlteracaoGestor(novasAtribuicoes.map(x => x.key), Object.assign(row, { unidade_sigla: this.unidade?.selectedItem?.entity.sigla }), itensGrid, this.entity?.nome || \"\");\r\n      if (alteracaoGestor[0] != 'nenhuma') {\r\n        confirm = await this.dialog.confirm(\"CONFIRMA A ALTERAÇÃO DA CHEFIA ?\", alteracaoGestor[2]);\r\n        if (confirm) {\r\n          switch (alteracaoGestor[0]) {\r\n            case 'ganho':\r\n              // Se for o caso, elimina a atribuição de LOTADO da antiga lotação\r\n              if (alteracaoGestor[3]) {\r\n                let indiceAntigaLotacao = this.grid?.items.findIndex(x => x.atribuicoes.includes('LOTADO'));\r\n                if (indiceAntigaLotacao) this.grid!.items[indiceAntigaLotacao].atribuicoes = (this.grid!.items[indiceAntigaLotacao].atribuicoes as string[]).filter(x => x != 'LOTADO');\r\n              }\r\n              break;\r\n            case 'troca':\r\n              // Garante que a unidade da antiga gerência perderá as atribuições de GESTOR e LOTADO\r\n              this.grid!.items[alteracaoGestor[1]].atribuicoes = (this.grid!.items[alteracaoGestor[1]].atribuicoes as string[]).filter(x => !['GESTOR', 'LOTADO'].includes(x));\r\n              break;\r\n          }\r\n          // Insere a atribuição de LOTADO na nova gerência, apenas para fins de atualização da tela do usuário, pois o back-end já faria isso automaticamente.\r\n          novasAtribuicoes = this.integranteService.inserirAtribuicao(novasAtribuicoes, 'LOTADO');\r\n          form.controls.atribuicoes.setValue(novasAtribuicoes);\r\n          this.loading = true;\r\n        } else return undefined;\r\n      } else {\r\n        let alteracaoLotacao = this.integranteService.haAlteracaoLotacao(form, Object.assign(row, { unidade_sigla: this.unidade?.selectedItem?.entity.sigla }), itensGrid, this.entity?.nome || \"\");\r\n        if (alteracaoLotacao[0]) {\r\n          if (this.grid?.items[alteracaoLotacao[1]].atribuicoes.includes('GESTOR')) {\r\n            await this.dialog.alert(\"IMPOSSÍVEL ALTERAR A LOTAÇÃO !\", alteracaoLotacao[3]);\r\n            return undefined;\r\n          } else {\r\n            confirm = await this.dialog.confirm(\"CONFIRMA A ALTERAÇÃO DA LOTAÇÃO ?\", alteracaoLotacao[2]);\r\n            if (confirm) this.grid!.items[alteracaoLotacao[1]].atribuicoes = (this.grid!.items[alteracaoLotacao[1]].atribuicoes as string[]).filter(x => x != 'LOTADO'); else return undefined;\r\n          }\r\n        }\r\n      }\r\n      try {\r\n        if (!this.isNoPersist) { // se persistente\r\n          await this.integranteDao.salvarIntegrantes([this.integranteService.completarIntegrante(row, form!.controls.unidade_id.value, this.entity!.id, novasAtribuicoes.map(x => x.key))]).then(resposta => {\r\n            let msg: string | undefined;\r\n            if (msg = resposta?.find(v => v._metadata.msg?.length)?._metadata.msg) { if (this.grid) this.grid!.error = msg; };\r\n          });\r\n          //TODO: se retornar uma mensagem de erro, ela será exibida?\r\n          await this.loadData({ id: this.entity!.id }, this.form);\r\n          if (this.grid) this.grid!.error = \"\";\r\n        } else {                // se não persistente\r\n          row.id = this.unidade?.selectedEntity.id,\r\n            this.grid!.items = this.integranteService.substituirItem({\r\n              id: row.id,\r\n              itens: this.grid?.items || [],\r\n              apelidoOuSigla: this.unidade?.selectedItem?.entity.sigla,\r\n              nome: this.unidade?.selectedItem?.entity.nome,\r\n              codigo: this.unidade?.selectedItem?.entity.codigo\r\n            }, novasAtribuicoes.map((x: LookupItem) => x.key), new Usuario(this.entity!));\r\n          this.cdRef.detectChanges();\r\n        }\r\n      } catch (error: any) {\r\n        if (this.grid) this.grid.error = error;\r\n        await this.loadData({ id: this.entity!.id }, this.form);\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    } else {\r\n      await this.dialog.alert(\"IMPOSSÍVEL INCLUIR/ALTERAR A UNIDADE !\", error);\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  public isNoButtons() {\r\n    return this.isNoPersist ? 'true' : (this.formPerfil.controls.perfil_id.value == this.perfilUsuario ? 'true' : undefined)\r\n  }\r\n\r\n  /* \r\n  \r\n  TESTES MÍNIMOS RECOMENDADOS PARA A VALIDAÇÃO DO COMPONENTE - USUARIO-INTEGRANTE\r\n\r\n  CENÁRIO: CAMINHO FELIZ\r\n  Formulário completo do usuário - aba 'Atribuições'\r\n  1. Perder a gerência\r\n  2. Assumir a gerência da unidade em que já está lotado\r\n  3. Assumir a gerência de uma unidade em que não está lotado (unidade já existente do grid)\r\n  4. Assumir a gerência de uma unidade em que não está lotado (unidade ainda não existente do grid)\r\n  5. Trocar de gerência, assumindo a de uma unidade que já existe no grid\r\n  6. Trocar de gerência, assumindo a de uma unidade que ainda não existe no grid\r\n  7. Alterar atribuições (exceto gerência e lotação) em uma unidade que já existe no grid\r\n  8. Alterar atribuições (exceto gerência e lotação) em uma unidade que ainda não existe no grid\r\n  9. Alterar a lotação de um usuário para uma unidade que já está no grid\r\n  10. Alterar a lotação de um usuário para uma unidade que ainda não está no grid\r\n  11. Realizar várias das ações acima ao mesmo tempo (ações que sejam coerentes e não conflitantes), antes de salvar o formulário\r\n  12. Excluir o vínculo completo do usuário com uma unidade em que ele não é lotado\r\n\r\n  CENÁRIO: CAMINHO FELIZ\r\n  Formulário de Atribuições do usuário - grupo de botões opcionais (...)\r\n  1. Perder a gerência\r\n  2. Assumir a gerência da unidade em que já está lotado\r\n  3. Assumir a gerência de uma unidade em que não está lotado (unidade já existente do grid)\r\n  4. Assumir a gerência de uma unidade em que não está lotado (unidade ainda não existente do grid)\r\n  5. Trocar de gerência, assumindo a de uma unidade que já existe no grid\r\n  6. Trocar de gerência, assumindo a de uma unidade que ainda não existe no grid\r\n  7. Alterar atribuições (exceto gerência e lotação) em uma unidade que já existe no grid\r\n  8. Alterar atribuições (exceto gerência e lotação) em uma unidade que ainda não existe no grid\r\n  9. Alterar a lotação de um usuário para uma unidade que já está no grid\r\n  10. Alterar a lotação de um usuário para uma unidade que ainda não está no grid\r\n  11. Excluir o vínculo completo do usuário com uma unidade em que ele não é lotado\r\n\r\n  \r\n  */\r\n\r\n}\r\n","<span *ngIf=\"!isNoPersist\"><strong>{{ 'Servidor: ' + entity?.nome }}</strong></span>\r\n\r\n<div class=\"row\">\r\n    <div class=\"col-4\">\r\n        <editable-form [form]=\"formPerfil!\" [noButtons]=\"isNoButtons()\" [disabled]=\"formDisabled\" title=\"\" (submit)=\"salvarPerfil()\">\r\n            <div class=\"row\">\r\n                <input-select [disabled]=\"!auth.hasPermissionTo('MOD_CFG_USER_PERFIL') ? 'true' : undefined\" [label]=\"lex.translate('Perfil')\" controlName=\"perfil_id\" [dao]=\"perfilDao\" required></input-select>\r\n            </div>\r\n        </editable-form>\r\n    </div>\r\n    <div class=\"col\">\r\n        <top-alert type=\"warning\" [message]=\"'Ao conceder a ' + lex.translate('um usuário') + ' a atribuição de ' + lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, 'GESTOR') + ', ' + lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, 'GESTOR_SUBSTITUTO') + ' ou de ' + lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, 'GESTOR_DELEGADO') + ' em ' + lex.translate('uma unidade') + ', deve lhe ser concedido também ' + lex.translate('o nível de acesso') + ' correspondente.'\"></top-alert>\r\n    </div>\r\n</div>\r\n\r\n<grid #grid [items]=\"items\" [minHeight]=\"500\" [form]=\"form!\" [hasDelete]=\"true\" editable [add]=\"adicionarIntegrante.bind(this)\" [load]=\"carregarIntegrante.bind(this)\" [remove]=\"removerIntegrante.bind(this)\" [save]=\"salvarIntegrante.bind(this)\">\r\n    <top-alert *ngIf=\"!isNoPersist\" type=\"alert\" [message]=\"'É impossível excluir ' + lex.translate('a lotação') + ' ' + lex.translate('do servidor') + '. Para alterá-la, lote-o em outra ' + lex.translate('unidade') + '!'\"></top-alert>\r\n    <columns>\r\n        <column [title]=\"lex.translate('Unidades')\" [template]=\"columnUnidade\" [editTemplate]=\"editUnidade\">\r\n            <ng-template let-row=\"row\" #columnUnidade>\r\n                <strong>{{ row.unidade_sigla || '' }}</strong><span> {{ row.informal ? '(Unidade Informal)' : '(Código: ' + (row.unidade_codigo || '') + ')' }}</span><br>\r\n                <span>{{ row.unidade_nome || '' }} </span>\r\n            </ng-template>\r\n            <ng-template let-row=\"row\" #editUnidade>\r\n                <input-search #unidade [disabled]=\"grid?.adding ? undefined : 'true'\" [size]=\"12\" label icon controlName=\"unidade_id\" [dao]=\"unidadeDao\"></input-search>\r\n            </ng-template>\r\n        </column>\r\n        <column [title]=\"lex.translate('Atribuições')\" [template]=\"columnAtribuicoes\" [editTemplate]=\"editAtribuicoes\">\r\n            <ng-template let-row=\"row\" #columnAtribuicoes>\r\n                <div *ngFor=\"let a of row.atribuicoes\">\r\n                    <badge [color]=\"lookup.getColor(lookup.UNIDADE_INTEGRANTE_TIPO, a || '')\" [icon]=\"lookup.getIcon(lookup.UNIDADE_INTEGRANTE_TIPO, a || '')\" [label]=\"lookup.getValue(lookup.UNIDADE_INTEGRANTE_TIPO, a || '')\"></badge><br>\r\n                </div>\r\n            </ng-template>\r\n            <ng-template let-row=\"row\" #editAtribuicoes>\r\n                <input-multiselect controlName=\"atribuicoes\" [size]=\"8\" [addItemHandle]=\"addItemHandle.bind(this)\" [deleteItemHandle]=\"deleteItemHandle.bind(this)\">\r\n                    <input-select [size]=\"12\" label=\"\" icon=\"fas fa-sign-out-alt\" controlName=\"atribuicao\" [items]=\"lookup.ordenarLookupItem(lookup.UNIDADE_INTEGRANTE_TIPO)\"></input-select>\r\n                </input-multiselect>\r\n            </ng-template>\r\n        </column>\r\n        <column type=\"options\"></column>\r\n    </columns>\r\n</grid>","import { Component, Injector, ViewChild } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { GridComponent } from 'src/app/components/grid/grid.component';\r\nimport { ToolbarButton } from 'src/app/components/toolbar/toolbar.component';\r\nimport { PerfilDaoService } from 'src/app/dao/perfil-dao.service';\r\nimport { UnidadeDaoService } from 'src/app/dao/unidade-dao.service';\r\nimport { UsuarioDaoService } from 'src/app/dao/usuario-dao.service';\r\nimport { Usuario } from 'src/app/models/usuario.model';\r\nimport { PageListBase } from 'src/app/modules/base/page-list-base';\r\n\r\n@Component({\r\n  selector: 'app-usuario-list',\r\n  templateUrl: './usuario-list.component.html',\r\n  styleUrls: ['./usuario-list.component.scss']\r\n})\r\nexport class UsuarioListComponent extends PageListBase<Usuario, UsuarioDaoService> {\r\n  @ViewChild(GridComponent, { static: false }) public grid?: GridComponent;\r\n\r\n  public unidadeDao: UnidadeDaoService;\r\n  public perfilDao: PerfilDaoService;\r\n\r\n  constructor(public injector: Injector) {\r\n    super(injector, Usuario, UsuarioDaoService);\r\n    this.unidadeDao = injector.get<UnidadeDaoService>(UnidadeDaoService);\r\n    this.perfilDao = injector.get<PerfilDaoService>(PerfilDaoService);\r\n    /* Inicializações */\r\n    this.title = this.lex.translate(\"Usuários\");\r\n    this.code = \"MOD_CFG_USER\";\r\n    this.join = [\"perfil:id,nome\"];\r\n    this.filter = this.fh.FormBuilder({\r\n      usuario: { default: \"\" },\r\n      unidade_id: { default: \"\" },\r\n      perfil_id: { default: null }\r\n    });\r\n    this.addOption(this.OPTION_INFORMACOES, \"MOD_USER\");\r\n    //this.addOption(this.OPTION_EXCLUIR, \"MOD_USER_EXCL\");       // Tratar de forma diferenciada a exclusão de usuário\r\n  }\r\n\r\n  public dynamicOptions(row: any): ToolbarButton[] {\r\n    let result: ToolbarButton[] = [];\r\n    // Testa se o usuário logado possui permissão para gerenciar as atribuições do usuário do grid\r\n    if (this.auth.hasPermissionTo(\"MOD_USER_ATRIB\")) result.push({ label: \"Atribuições\", icon: \"bi bi-list-task\",  onClick: (usuario: Usuario) => { this.go.navigate({ route: ['configuracoes', 'usuario', usuario.id, 'integrante'] }, { metadata: { entity: row } }); }});\r\n    return result;\r\n  }\r\n\r\n  public filterWhere = (filter: FormGroup) => {\r\n    let result: any[] = [];\r\n    if (filter?.controls.usuario?.value?.length) {\r\n      result.push([\"nome\", \"like\", \"%\" + filter?.controls.usuario?.value.trim().replace(\" \", \"%\") + \"%\"]);\r\n    }\r\n    if (filter?.controls.unidade_id?.value?.length) {\r\n      result.push([\"lotacao\", \"==\", filter?.controls.unidade_id.value]);\r\n    }\r\n    if (filter?.controls.perfil_id?.value?.length) {\r\n      result.push([\"perfil_id\", \"==\", filter?.controls.perfil_id?.value]);\r\n    }\r\n    return result;\r\n  }\r\n}\r\n","<h3 *ngIf=\"!isModal\" class=\"my-2\">{{title}}</h3>\r\n<grid [dao]=\"dao\" [add]=\"add\" [orderBy]=\"orderBy\" [groupBy]=\"groupBy\" [join]=\"join\"\r\n    [selectable]=\"selectable\" (select)=\"onSelect($event)\"\r\n    [hasAdd]=\"auth.hasPermissionTo('MOD_USER_INCL')\"\r\n    [hasEdit]=\"auth.hasPermissionTo('MOD_USER_EDT')\">\r\n    <toolbar *ngIf=\"!selectable\"></toolbar>\r\n    <filter [form]=\"filter\" [where]=\"filterWhere\" [submit]=\"filterSubmit.bind(this)\" [collapseChange]=\"filterCollapseChange.bind(this)\" [collapsed]=\"!selectable && filterCollapsed\">\r\n        <div class=\"row\">\r\n            <input-text [size]=\"4\" [label]=\"lex.translate('Usuário')\" controlName=\"usuario\" [control]=\"filter!.controls.usuario\" placeholder=\"Nome\" [attr.maxlength]=250></input-text>\r\n            <input-search [size]=\"4\" [label]=\"lex.translate('Lotação')\" [control]=\"filter!.controls.unidade_id\" controlName=\"unidade_id\" [dao]=\"unidadeDao\"></input-search>\r\n            <input-select [size]=\"4\" [label]=\"lex.translate('Perfil')\" controlName=\"perfil_id\" nullable [control]=\"filter!.controls.perfil_id\" [dao]=\"perfilDao\"></input-select>\r\n        </div>\r\n    </filter>\r\n    <columns>\r\n        <column icon=\"bi-person\" [align]=\"'center'\" [template]=\"columnFoto\">\r\n            <ng-template let-row=\"row\" #columnFoto>\r\n                <profile-picture [url]=\"row.url_foto\" [size]=\"40\" [hint]=\"row.nome\"></profile-picture>\r\n            </ng-template>\r\n        </column>\r\n        <column title=\"CPF\" field=\"cpf\"></column>\r\n        <column title=\"Matrícula\" field=\"matricula\"></column>\r\n        <column title=\"Nome\" field=\"nome\" orderBy=\"nome\"></column>\r\n        <column [title]=\"lex.translate('Perfil')\" [template]=\"columnPerfil\">\r\n            <ng-template let-row=\"row\" #columnPerfil>\r\n                <strong>{{row.perfil?.nome || \"\"}}</strong>\r\n            </ng-template>\r\n        </column>\r\n        <column type=\"options\" [onEdit]=\"edit\" [dynamicOptions]=\"dynamicOptions.bind(this)\" [options]=\"options\"></column>\r\n    </columns>\r\n    <pagination [rows]=\"rowsLimit\"></pagination>\r\n</grid>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { AuthGuard } from 'src/app/guards/auth.guard';\r\nimport { ConfigResolver } from 'src/app/resolvies/config.resolver';\r\nimport { UsuarioFormComponent } from './usuario-form/usuario-form.component';\r\nimport { UsuarioListComponent } from './usuario-list/usuario-list.component';\r\nimport { UsuarioIntegranteComponent } from './usuario-integrante/usuario-integrante.component';\r\n\r\nconst routes: Routes = [\r\n  { path: '', component: UsuarioListComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Usuários\" } },\r\n  { path: 'new', component: UsuarioFormComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Inclusão de Usuário\", modal: true } },\r\n  { path: ':id/edit', component: UsuarioFormComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Edição de Usuário\", modal: true } },\r\n  { path: ':id/consult', component: UsuarioFormComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Consulta a Usuário\", modal: true } },\r\n  { path: ':id/integrante', component: UsuarioIntegranteComponent, canActivate: [AuthGuard], resolve: { config: ConfigResolver }, runGuardsAndResolvers: 'always', data: { title: \"Atribuições do Usuário\", modal: true } },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class UsuarioRoutingModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { UsuarioRoutingModule } from './usuario-routing.module';\r\nimport { UsuarioListComponent } from './usuario-list/usuario-list.component';\r\nimport { ComponentsModule } from 'src/app/components/components.module';\r\nimport { UsuarioFormComponent } from './usuario-form/usuario-form.component';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { UsuarioIntegranteComponent } from './usuario-integrante/usuario-integrante.component';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    UsuarioListComponent,\r\n    UsuarioFormComponent,\r\n    UsuarioIntegranteComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ComponentsModule,\r\n    ReactiveFormsModule,\r\n    UsuarioRoutingModule\r\n  ]\r\n})\r\nexport class UsuarioModule { }\r\n"],"names":["EditableFormComponent","PlanoTrabalhoDaoService","UnidadeDaoService","UsuarioDaoService","Usuario","PageFormBase","UsuarioIntegranteComponent","UnidadeIntegranteDaoService","UsuarioFormComponent","constructor","injector","validate","control","controlName","result","util","validarCPF","value","indexOf","dao","validDateTime","formValidation","form","unidadesIntegrantes","grid","items","find","item","index","array","atribuicoes","includes","lex","translate","unidade_id","length","usuario_id","undefined","titleEdit","entity","nome","unidadeDao","get","integranteDao","planoTrabalhoDao","fh","FormBuilder","email","default","cpf","matricula","apelido","telefone","uf","sexo","url_foto","texto_complementar_plano","data_nascimento","cdRef","planoDataset","dataset","loadData","_this","_asyncToGenerator","formValue","Object","assign","patchValue","fillForm","initializeData","saveData","_this2","Promise","_ref","resolve","reject","confirm","usuario","fill","perfil_id","formPerfil","controls","integrantesConsolidados","indiceVinculoLotacao","findIndex","ic","forEach","_status","integrantes","_x","_x2","apply","arguments","i0","ɵɵdirectiveInject","Injector","selectors","viewQuery","UsuarioFormComponent_Query","rf","ctx","ɵɵelementStart","ɵɵlistener","UsuarioFormComponent_Template_editable_form_submit_0_listener","onSaveData","UsuarioFormComponent_Template_editable_form_cancel_0_listener","onCancel","ɵɵelement","ɵɵelementEnd","ɵɵproperty","formDisabled","isModal","title","ɵɵadvance","auth","hasPermissionTo","ɵɵattribute","lookup","SEXO","UF","GridComponent","PageFrameBase","IntegranteService","PerfilDaoService","ɵɵtext","ɵɵtextInterpolate","ctx_r0","ctx_r2","row_r11","unidade_sigla","ɵɵtextInterpolate1","informal","unidade_codigo","unidade_nome","_r1","adding","ctx_r6","ctx_r15","getColor","UNIDADE_INTEGRANTE_TIPO","a_r16","getIcon","getValue","ɵɵtemplate","UsuarioIntegranteComponent_ng_template_18_div_0_Template","row_r14","ctx_r10","addItemHandle","bind","deleteItemHandle","ordenarLookupItem","noPersist","perfilUsuario","map","i","id","array_diff","na","key","integranteService","usuarioDao","perfilDao","atribuicao","ngOnInit","metadata","ngAfterViewInit","carregarIntegrantes","then","resposta","filter","x","setValue","push","completarIntegrante","ordenarIntegrantes","detectChanges","loading","salvarPerfil","_this3","submitting","update","validateLookupItem","icon","color","row","carregarIntegrante","_this4","converterAtribuicoes","adicionarIntegrante","_this5","error","novo","generateUuid","removerIntegrante","_this6","dialog","alert","toUpperCase","msg","isNoPersist","salvarIntegrantes","v","_metadata","salvarIntegrante","_this7","novasAtribuicoes","uniqueLookupItem","itensGrid","alteracaoGestor","haAlteracaoGestor","unidade","selectedItem","sigla","indiceAntigaLotacao","inserirAtribuicao","alteracaoLotacao","haAlteracaoLotacao","selectedEntity","substituirItem","itens","apelidoOuSigla","codigo","isNoButtons","UsuarioIntegranteComponent_Query","UsuarioIntegranteComponent_span_0_Template","UsuarioIntegranteComponent_Template_editable_form_submit_3_listener","UsuarioIntegranteComponent_top_alert_10_Template","UsuarioIntegranteComponent_ng_template_13_Template","ɵɵtemplateRefExtractor","UsuarioIntegranteComponent_ng_template_15_Template","UsuarioIntegranteComponent_ng_template_18_Template","UsuarioIntegranteComponent_ng_template_20_Template","_r3","_r5","_r7","_r9","PageListBase","row_r6","row_r7","perfil","UsuarioListComponent","filterWhere","trim","replace","code","join","addOption","OPTION_INFORMACOES","dynamicOptions","label","onClick","go","navigate","route","UsuarioListComponent_Query","UsuarioListComponent_h3_0_Template","UsuarioListComponent_Template_grid_select_1_listener","$event","onSelect","UsuarioListComponent_toolbar_2_Template","UsuarioListComponent_ng_template_10_Template","UsuarioListComponent_ng_template_16_Template","add","orderBy","groupBy","selectable","filterSubmit","filterCollapseChange","filterCollapsed","_r2","_r4","edit","options","rowsLimit","RouterModule","AuthGuard","ConfigResolver","routes","path","component","canActivate","config","runGuardsAndResolvers","data","modal","UsuarioRoutingModule","forChild","imports","i1","exports","CommonModule","ComponentsModule","ReactiveFormsModule","UsuarioModule","declarations"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}