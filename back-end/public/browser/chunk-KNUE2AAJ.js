import{a as at}from"./chunk-3OQ5NXFP.js";import{b as nt}from"./chunk-GEQ4G77C.js";import{a as b,b as F}from"./chunk-72ETMCRT.js";import{Y as rt,f as B,fa as st,h as G,o as ot,s as U}from"./chunk-JEWU6XZO.js";import{b as Z,c as $,d as tt,e as et,h as it,s as j}from"./chunk-OWVQDN4P.js";import"./chunk-P4ZMML75.js";import{Aa as X,Bb as R,Da as J,Fa as m,Fb as K,Ga as l,Ha as p,La as N,Ma as D,Na as _,Nc as V,Od as C,P as M,U as T,Ua as h,V as S,Va as v,Wa as g,Xa as I,Ya as y,Yc as P,Z as u,_ as c,_a as A,ba as O,h as W,ic as Y,ma as r,na as z,nd as Q,oc as q,sb as E,va as L,xa as f,ya as x,za as s}from"./chunk-SDCVQHKS.js";var _t=["tipoMotivoAfastamento"],ht=["usuario"];function vt(o,i){if(o&1&&p(0,"top-alert",10),o&2){let d=_();s("message",d.warning)}}var k=(()=>{let i=class i extends at{constructor(n){super(n,C,P),this.injector=n,this.validate=(a,t)=>{let e=null;return["usuario_id","tipo_motivo_afastamento_id"].indexOf(t)>=0&&!a.value?.length?e="Obrigat\xF3rio":["data_inicio","data_fim"].indexOf(t)>=0&&!this.dao?.validDateTime(a.value)&&(e="Inv\xE1lido"),e},this.titleEdit=a=>"Editando "+this.lex.translate("afastamento")+": "+(a?.usuario?.nome||"")+" - "+(a?.tipo_motivo_afastamento?.nome||""),this.tipoMotivoAfastamentoDao=n.get(Q),this.usuarioDao=n.get(V),this.title=this.lex.translate("Afastamento"),this.form=this.fh.FormBuilder({observacoes:{default:""},data_inicio:{default:new Date},data_fim:{default:new Date},usuario_id:{default:""},tipo_motivo_afastamento_id:{default:""}},this.cdRef,this.validate),this.join=["usuario","tipo_motivo_afastamento"]}isHoras(){return!!(this.form.controls.tipo_motivo_afastamento_id.value?.length&&this.tipoMotivoAfastamento?.selectedEntity?.horas)}loadData(n,a){return W(this,null,function*(){let t=Object.assign({},a.value);this.metadata?.consolidacao&&(this.consolidacao=this.metadata?.consolidacao,n.usuario_id=this.consolidacao.plano_trabalho.usuario_id,n.usuario=this.consolidacao.plano_trabalho?.usuario),yield Promise.all([this.usuario.loadSearch(n.usuario||t.usuario_id),this.tipoMotivoAfastamento.loadSearch(n.tipo_motivo_afastamento||t.tipo_motivo_afastamento_id)]),a.patchValue(this.util.fillForm(t,n))})}initializeData(n){this.entity=new C,this.loadData(this.entity,n)}saveData(n){return new Promise((a,t)=>{let e=this.util.fill(new C,this.entity);e=this.util.fillForm(e,this.form.value),this.isHoras()||(e.data_inicio.setHours(0,0,0),e.data_fim.setHours(23,59,0),e.data_fim.setDate(e.data_fim.getDate())),a(e)})}get warning(){let n,a=this.util.asDate(this.form.controls.data_inicio.value),t=this.util.asDate(this.form.controls.data_fim.value);return this.consolidacao&&a&&t&&(this.util.daystamp(a)<this.util.daystamp(this.consolidacao.data_inicio)||this.util.daystamp(t)>this.util.daystamp(this.consolidacao.data_fim))&&(n="Aten\xE7\xE3o: Data da consolida\xE7\xE3o do plano \xE9 de "+this.util.getDateFormatted(this.consolidacao.data_inicio)+" a "+this.util.getDateFormatted(this.consolidacao.data_fim)),n}};i.\u0275fac=function(a){return new(a||i)(z(O))},i.\u0275cmp=T({type:i,selectors:[["app-afastamento-form"]],viewQuery:function(a,t){if(a&1&&(h(U,5),h(_t,5),h(ht,5)),a&2){let e;v(e=g())&&(t.editableForm=e.first),v(e=g())&&(t.tipoMotivoAfastamento=e.first),v(e=g())&&(t.usuario=e.first)}},features:[L],decls:12,vars:16,consts:[["usuario",""],["tipoMotivoAfastamento",""],["type","warning",3,"message",4,"ngIf"],["initialFocus","usuario_id",3,"submit","cancel","form","disabled","title"],[1,"row"],["controlName","usuario_id","required","",3,"size","disabled","dao"],["controlName","tipo_motivo_afastamento_id","required","",3,"size","dao"],["label","In\xEDcio","controlName","data_inicio",3,"date","size"],["label","Fim","controlName","data_fim",3,"date","size"],["label","Observa\xE7\xF5es","controlName","observacoes",3,"size","rows"],["type","warning",3,"message"]],template:function(a,t){if(a&1){let e=N();f(0,vt,1,1,"top-alert",2),m(1,"editable-form",3),D("submit",function(){return u(e),c(t.onSaveData())})("cancel",function(){return u(e),c(t.onCancel())}),m(2,"div",4),p(3,"input-search",5,0)(5,"input-search",6,1),l(),m(7,"div",4),p(8,"input-datetime",7)(9,"input-datetime",8),l(),m(10,"div",4),p(11,"input-textarea",9),l()()}a&2&&(s("ngIf",t.warning==null?null:t.warning.length),r(),s("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),r(2),s("size",6)("disabled",t.consolidacao?"true":void 0)("dao",t.usuarioDao),r(2),s("size",6)("dao",t.tipoMotivoAfastamentoDao),r(3),s("date",t.isHoras()?void 0:"")("size",6),r(),s("date",t.isHoras()?void 0:"")("size",6),r(2),s("size",12)("rows",3),x("maxlength",250))},dependencies:[R,U,G,ot,B,rt]});let o=i;return o})();function gt(o,i){o&1&&p(0,"toolbar")}function yt(o,i){if(o&1&&(m(0,"span"),y(1),l()),o&2){let d=i.row;r(),A(" ",d.usuario.nome,"")}}function At(o,i){if(o&1&&(m(0,"span"),y(1),l()),o&2){let d=_().row;r(),A(" ","(c\xF3d. "+d.tipo_motivo_afastamento.codigo+")","")}}function Ct(o,i){if(o&1&&(p(0,"i"),m(1,"span"),y(2),l(),f(3,At,2,1,"span",7)),o&2){let d=i.row;J(d.tipo_motivo_afastamento.icone),r(),X("color",d.tipo_motivo_afastamento.cor),r(),A(" ",d.tipo_motivo_afastamento.nome,""),r(),s("ngIf",d.tipo_motivo_afastamento.codigo)}}function wt(o,i){if(o&1&&(m(0,"span"),y(1),l()),o&2){let d=i.row,n=_();r(),A(" ",n.dao.getDateFormatted(d.data_inicio),"")}}function Dt(o,i){if(o&1&&(m(0,"span"),y(1),l()),o&2){let d=i.row,n=_();r(),A(" ",n.dao.getDateFormatted(d.data_fim),"")}}var mt=(()=>{let i=class i extends nt{constructor(n){super(n,C,P),this.injector=n,this.listagemInicial=!0,this.filterWhere=a=>{let t=[],e=a.value;return e.usuario_id?.length&&e.tipo_motivo_afastamento_id?.length?(t.push(["usuario_id","==",e.usuario_id]),t.push(["tipo_motivo_afastamento_id","==",e.tipo_motivo_afastamento_id])):e.usuario_id?.length?t.push(["usuario_id","==",e.usuario_id]):e.tipo_motivo_afastamento_id?.length?t.push(["tipo_motivo_afastamento_id","==",e.tipo_motivo_afastamento_id]):this.dao?.validDateTime(e.data_inicio)&&this.dao?.validDateTime(e.data_fim)&&!this.listagemInicial&&t.push(this.dao?.intersectionWhere("data_inicio","data_fim",this.util.startOfDay(e.data_inicio),this.util.startOfDay(e.data_fim))),t},this.join=["tipo_motivo_afastamento:id, nome","usuario: id, nome"],this.tipoMotivoAfastamentoDao=n.get(Q),this.usuarioDao=n.get(V),this.title=this.lex.translate("Afastamentos"),this.code="MOD_AFT",this.filter=this.fh.FormBuilder({observacoes:{default:""},data_inicio:{default:new Date},data_fim:{default:new Date},usuario_id:{default:""},tipo_motivo_afastamento_id:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_AFT_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}filtro(){this.listagemInicial=!1}};i.\u0275fac=function(a){return new(a||i)(z(O))},i.\u0275cmp=T({type:i,selectors:[["app-afastamento-list"]],viewQuery:function(a,t){if(a&1&&h(j,5),a&2){let e;v(e=g())&&(t.grid=e.first)}},features:[L],decls:26,vars:32,consts:[["usuario",""],["tipoMotivoAfastamento",""],["columnUsuario",""],["columnMotivoAfastamento",""],["columnInicioAfastamento",""],["columnFimAfastamento",""],[3,"dao","add","title","orderBy","groupBy","join","hasAdd","hasEdit"],[4,"ngIf"],[3,"form","where","submit","collapseChange","collapsed","deleted"],[1,"row"],["controlName","usuario_id",3,"size","control","dao"],["controlName","tipo_motivo_afastamento_id",3,"size","control","dao"],["date","","label","In\xEDcio","controlName","data_inicio",3,"click","size"],["date","","label","Fim","controlName","data_fim",3,"click","size"],[3,"title","template"],["title","In\xEDcio",3,"template"],["title","Fim",3,"template"],["title","Observa\xE7\xF5es","field","observacoes"],["type","options",3,"onEdit","options"],[3,"rows"]],template:function(a,t){if(a&1){let e=N();m(0,"grid",6),f(1,gt,1,0,"toolbar",7),m(2,"filter",8)(3,"div",9),p(4,"input-search",10,0)(6,"input-search",11,1),m(8,"input-datetime",12),D("click",function(){return u(e),c(t.filtro())}),l(),m(9,"input-datetime",13),D("click",function(){return u(e),c(t.filtro())}),l()()(),m(10,"columns")(11,"column",14),f(12,yt,2,1,"ng-template",null,2,E),l(),m(14,"column",14),f(15,Ct,4,6,"ng-template",null,3,E),l(),m(17,"column",15),f(18,wt,2,1,"ng-template",null,4,E),l(),m(20,"column",16),f(21,Dt,2,1,"ng-template",null,5,E),l(),p(23,"column",17)(24,"column",18),l(),p(25,"pagination",19),l()}if(a&2){let e=I(13),w=I(16),dt=I(19),pt=I(22);s("dao",t.dao)("add",t.add)("title",t.isModal?"":t.title)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("hasAdd",t.auth.hasPermissionTo("MOD_AFT_INCL"))("hasEdit",t.auth.hasPermissionTo("MOD_AFT_EDT")),r(),s("ngIf",!t.selectable),r(),s("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",t.filterCollapsed)("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL")),r(2),s("size",3)("control",t.filter.controls.usuario_id)("dao",t.usuarioDao),r(2),s("size",3)("control",t.filter.controls.tipo_motivo_afastamento_id)("dao",t.tipoMotivoAfastamentoDao),r(2),s("size",3),r(),s("size",3),r(2),s("title",t.lex.translate("Usu\xE1rio"))("template",e),r(3),s("title",t.lex.translate("Motivo"))("template",w),r(3),s("template",dt),r(3),s("template",pt),r(4),s("onEdit",t.edit)("options",t.options),r(),s("rows",t.rowsLimit)}},dependencies:[R,j,tt,$,et,Z,it,G,B]});let o=i;return o})();var It=[{path:"",component:mt,canActivate:[b],resolve:{config:F},runGuardsAndResolvers:"always",data:{title:"Afastamentos"}},{path:"new",component:k,canActivate:[b],resolve:{config:F},runGuardsAndResolvers:"always",data:{title:"Inclus\xE3o de Afastamento",modal:!0}},{path:":id/edit",component:k,canActivate:[b],resolve:{config:F},runGuardsAndResolvers:"always",data:{title:"Edi\xE7\xE3o de Afastamento",modal:!0}},{path:":id/consult",component:k,canActivate:[b],resolve:{config:F},runGuardsAndResolvers:"always",data:{title:"Consulta a Afastamento",modal:!0}}],lt=(()=>{let i=class i{};i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=S({type:i}),i.\u0275inj=M({imports:[q.forChild(It),q]});let o=i;return o})();var le=(()=>{let i=class i{};i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=S({type:i}),i.\u0275inj=M({imports:[K,st,Y,lt]});let o=i;return o})();export{le as AfastamentoModule};
