import{a as E}from"./chunk-IGLI572K.js";import"./chunk-4FFFIQPI.js";import{a as k,c as x}from"./chunk-AEY7EVJX.js";import"./chunk-RXAJF325.js";import{c as D}from"./chunk-3L5EFWZ5.js";import"./chunk-GEQ4G77C.js";import{p as h}from"./chunk-OWVQDN4P.js";import{Fa as m,Fb as C,Ga as u,P as v,Qc as A,U as s,V as y,Ya as p,ba as c,h as r,ld as T,na as d,oc as w,od as I,sd as S,td as b,va as l}from"./chunk-SDCVQHKS.js";var P=(()=>{let t=class t extends h{constructor(e){super(e,"editor-montar"),this.injector=e,this.documentoDao=e.get(b)}ngOnInit(){super.ngOnInit()}documentoPendenteSei(e){return r(this,null,function*(){let i=yield this.documentoDao.documentoPendenteSei(e);if(i){let o=yield this.execute("setConteudoDocumento",[0,i.conteudo]);o?.length&&(yield this.documentoDao.update(i.id,{status:D.STATUS_GERADO,numero_documento:o}))}})}loadToolbarButtons(e){return r(this,null,function*(){this.gb.toolbarButtons=[]})}};t.\u0275fac=function(i){return new(i||t)(d(c))},t.\u0275cmp=s({type:t,selectors:[["app-editor-montar"]],features:[l],decls:2,vars:0,template:function(i,o){i&1&&(m(0,"p"),p(1,"editor-montar works!"),u())}});let a=t;return a})();var z=(()=>{let t=class t extends h{constructor(e){super(e,"petrvs-listener"),this.injector=e}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)(d(c))},t.\u0275cmp=s({type:t,selectors:[["app-petrvs-listener"]],features:[l],decls:2,vars:0,template:function(i,o){i&1&&(m(0,"p"),p(1,"petrvs-listener works!"),u())}});let a=t;return a})();var O=(()=>{let t=class t extends h{constructor(e){super(e,"procedimento_escolher_tipo"),this.injector=e,this.tipoProcessoDao=e.get(I)}ngOnInit(){super.ngOnInit()}loadToolbarButtons(){return r(this,null,function*(){this.gb.toolbarButtons=[{icon:"bi bi-folder-check",color:"btn-outline-primary",hint:"Atualizar tipos de processos",onClick:this.atualizarTiposProcessos.bind(this)}]})}atualizarTiposProcessos(){return r(this,null,function*(){let e=yield this.execute("getTiposProcessos",[]);(yield this.tipoProcessoDao.atualizar(e))?this.dialog.alert("Atualiza\xE7\xE3o","Atualiza\xE7\xE3o realizada com sucesso!"):this.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xE7\xE3o!")})}};t.\u0275fac=function(i){return new(i||t)(d(c))},t.\u0275cmp=s({type:t,selectors:[["app-procedimento-escolher-tipo"]],features:[l],decls:2,vars:0,template:function(i,o){i&1&&(m(0,"p"),p(1,"procedimento-escolher-tipo works!"),u())}});let a=t;return a})();var _=(()=>{let t=class t extends h{constructor(e){super(e,"procedimento_trabalhar"),this.injector=e,this.dao=e.get(A),this.tipoDocumentoDao=e.get(T)}loadToolbarButtons(e){return r(this,null,function*(){let i=[];if(e.includes("plano")&&i.push({icon:"bi bi-list-check",color:"btn-outline-primary",hint:"Gerar termo de ades\xE3o",onClick:this.gerarTermoAdesao.bind(this)}),e.includes("entrega")){let o=[];e.includes("concluir_entrega")&&o.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+this.lex.translate("entrega"),onClick:this.concluirEntrega.bind(this)}),i.push({icon:"bi bi-boxes",color:"btn-outline-secondary",hint:"Incluir "+this.lex.translate("entrega"),onClick:this.incluirEntrega.bind(this),items:o.length?o:void 0})}if(e.includes("atualizar")&&i.push({icon:"bi bi-file-check",color:"btn-outline-warning",hint:"Atualizar tipos de documentos",onClick:this.atualizarTiposDocumentos.bind(this)}),e.find(o=>["incluir","concluir","atividades"].includes(o))){let o=[];e.includes("incluir")&&o.push({icon:"bi bi-plus-circle",color:"btn-outline-primary",label:"Incluir "+this.lex.translate("atividade"),onClick:this.incluirAtividade.bind(this)}),e.includes("concluir")&&o.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+this.lex.translate("atividade"),onClick:this.concluirAtividade.bind(this)}),i.push({icon:"bi bi-activity",color:"btn-outline-success",hint:this.lex.translate("atividade"),onClick:this.atividades.bind(this),items:o.length?o:void 0})}this.gb.toolbarButtons=i})}incluirAtividade(){return r(this,null,function*(){let e=yield this.execute("getSeiKeys",[]);e&&this.go.navigate({route:["gestao","atividade","new"]},{metadata:{sei:e},modal:!0})})}atividades(){return r(this,null,function*(){let e=yield this.execute("getProcessoKeys",[]);e&&this.go.navigate({route:["gestao","atividade"],params:{filter:{numero_processo:e.numero_processo}}},{modal:!0,modalWidth:1200})})}concluirAtividade(){return r(this,null,function*(){if(yield this.execute("getDocumentKeys",[])){let i=yield x.modalSelect({fixedFilter:[["status","==","INICIADO"]]});i&&(i.metadados?.pausado?(yield this.dialog.confirm("Atividade pausada","Para concluir \xE9 necess\xE1rio primeiro reiniciar a atividade. Deseja reiniciar?"))&&this.go.navigate({route:["gestao","atividade",i.id,"pausar"],params:{reiniciar:!0}},{modal:!0,modalClose:o=>{o?.length&&this.go.navigate({route:["gestao","atividade",i.id,"concluir"]},{modal:!0})}}):this.go.navigate({route:["gestao","atividade",i.id,"concluir"]},{modal:!0}))}})}concluirEntrega(){return r(this,null,function*(){let e=yield this.execute("getProcessoKeys",[]);e&&this.go.navigate({route:["gestao","atividade","entrega","concluir"],params:{id_processo:e.id_processo}},{modal:!0})})}incluirEntrega(){return r(this,null,function*(){let e=yield this.execute("getSeiKeys",[]);if(e){let i=yield x.modalSelect({fixedFilter:[["status","==","NAOCONCLUIDO"]]});if(i){let o=new k;o.id=this.dao.generateUuid(),o.usuario=this.auth.usuario,o.usuario_id=this.auth.usuario.id,o.atividade_id=i.id||"",o.comentarios=[],o._status="ADD",this.go.navigate({route:["gestao","atividade","tarefa"]},{metadata:{entrega:o,atividade:i,sei:e},modalClose:n=>{n&&r(this,null,function*(){try{let f=this.injector.get(S);this.dialog.showSppinerOverlay("Salvando dados do formul\xE1rio"),yield f.save(n)}catch(f){this.dialog.alert("Error",f.message?f.message:f)}finally{this.dialog.closeSppinerOverlay()}})}})}}})}gerarTermoAdesao(){return r(this,null,function*(){let e=yield E.modalSelect();if(e){let i=yield this.execute("getProcessoKeys",[]);this.go.navigate({route:["gestao","plano-trabalho","termo"]},{metadata:{plano:e,processo:i},modalClose:o=>{o?.termo?.length&&r(this,null,function*(){this.dialog.showSppinerOverlay("Gerando documento no sei...");try{let n=yield this.execute("incluirDocumento",[i.id_processo,o.codigo_tipo_documento]);if(n){let f=this.injector.get(b),j=Object.assign(new D,{especie:"TCR",conteudo:o?.termo,id_processo:i.id_processo,id_documento:n.id_documento,numero_processo:n.numero_processo,plano_trabalho_id:e.id,tipo_documento_id:o.tipo_documento_id,status:"AGUARDANDO_SEI"});yield f.save(j),yield this.execute("recarregarArvore",[n.urlReload]),yield this.execute("abrirEditor",[n.urlEditor,n.idUser])}}catch(n){this.dialog.alert("Error",n.message?n.message:n)}finally{this.dialog.closeSppinerOverlay()}})}})}})}atualizarTiposDocumentos(){return r(this,null,function*(){let e=yield this.execute("getTiposDocumentos",[]);(yield this.tipoDocumentoDao.atualizar(e))?this.dialog.alert("Atualiza\xE7\xE3o","Atualiza\xE7\xE3o realizada com sucesso!"):this.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xE7\xE3o!")})}};t.\u0275fac=function(i){return new(i||t)(d(c))},t.\u0275cmp=s({type:t,selectors:[["app-procedimento-trabalhar"]],features:[l],decls:2,vars:0,template:function(i,o){i&1&&(m(0,"p"),p(1,"procedimento-trabalhar works!"),u())}});let a=t;return a})();var F=[{path:"editor-montar",component:P},{path:"procedimento-trabalhar",component:_},{path:"procedimento-escolher-tipo",component:O},{path:"petrvs",component:z}],M=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=y({type:t}),t.\u0275inj=v({imports:[w.forChild(F),w]});let a=t;return a})();var we=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=y({type:t}),t.\u0275inj=v({imports:[C,M]});let a=t;return a})();export{we as ListenersModule};
