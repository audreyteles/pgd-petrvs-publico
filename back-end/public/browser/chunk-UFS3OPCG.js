import{O as h,R as r,Ub as d,Ud as u,X as l,ba as c,fc as f,h as n,wc as m}from"./chunk-6YMI2QVU.js";var v=(()=>{let s=class s extends u{constructor(t,e,i){super(t),this.injector=t,this.action="",this.join=[],this.mensagemSalvarSucesso="Registro salvo com sucesso!",this.mensagemCarregando="Carregando dados do formul\xE1rio...",this.mensagemSalvando="Salvando dados do formul\xE1rio...",this.error=o=>{this.editableForm&&(this.editableForm.error=o)},this.clearErros=()=>{this.editableForm&&(this.editableForm.error="")},this.dao=t.get(i)}ngOnInit(){super.ngOnInit();let t=(this.url?this.url[this.url.length-1]?.path:"")||"";this.action=["edit","consult"].includes(t)?t:"new",this.id=this.action!="new"?this.urlParams.get("id"):void 0}ngAfterViewInit(){super.ngAfterViewInit(),this.onInitializeData(),this.cdRef.detectChanges()}get isNew(){return this.action=="new"}get formDisabled(){return this.action=="consult"}checkFilled(t){return!t.find(e=>!this.form.controls[e].value?.length)}onInitializeData(){n(this,null,function*(){this.loading=!0;try{if(["edit","consult"].includes(this.action)){let t=yield this.dao.getById(this.id,this.join);this.entity=t,yield this.loadData(this.entity,this.form)}else yield this.initializeData(this.form)}catch(t){this.error("Erro ao carregar dados: "+t)}finally{this.loading=!1}this.action=="edit"&&this.titleEdit&&(this.title=this.titleEdit(this.entity))})}onSaveData(){return n(this,null,function*(){let t=this,e;if(this.formValidation)try{e=yield this.formValidation(this.form)}catch(i){e=i}if(this.form.valid&&!e){this.submitting=!0;try{let i=yield this.saveData(this.form.value);if(i){let o=typeof i=="boolean"?this.entity?.id:i instanceof m?i.modalResult:(yield this.dao.save(i,this.join)).id;t.modalRoute?.queryParams?.idroute?.length&&t.go.setModalResult(t.modalRoute?.queryParams?.idroute,o),t.close()}}catch(i){t.error(i.message?i.message:i)}finally{t.submitting=!1}}else this.form.markAllAsTouched(),e&&this.error(e),Object.entries(this.form.controls).forEach(([i,o])=>{o.invalid&&console.log("Validate => "+i,o.value,o.errors)})})}onCancel(){this.close()}getControlByName(t){return this.form.controls[t]}resetForm(t){t&&Object.keys(t.controls).forEach(e=>{let i=this.form?.get(e);if(console.log(typeof i),i instanceof d)this.resetForm(i);else if(i instanceof f)for(;i.length!==0;)i.removeAt(0);else i?.reset()})}};s.\u0275fac=function(e){return new(e||s)(r(c),r(l),r(l))},s.\u0275prov=h({token:s,factory:s.\u0275fac});let a=s;return a})();export{v as a};
