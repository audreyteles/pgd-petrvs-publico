import{a as de}from"./chunk-UFS3OPCG.js";import{b as me}from"./chunk-76VPKZU2.js";import{a as O,b as P}from"./chunk-RMYSPY7H.js";import{b as te,f as B,fa as ue,i as le,n as L,s as V,t as A}from"./chunk-XHTD5OAS.js";import{b as ie,c as ae,d as oe,e as re,h as ne,q as se,s as N}from"./chunk-KODYKPWY.js";import{Ab as W,Bb as T,Fa as l,Fb as H,Ga as r,Ha as _,La as $,Ma as R,Na as v,Nc as Z,P as z,Qc as ee,U as y,Ua as I,V as w,Va as C,Wa as S,Xa as g,Ya as d,Z as j,Za as f,_ as J,_a as k,ba as F,ic as K,ma as o,na as x,oc as G,pc as X,sb as h,va as D,vc as Y,wd as b,xa as c,ya as U,za as s}from"./chunk-6YMI2QVU.js";var E=class extends X{constructor(){super(),this.data_execucao="",this.atualizar_unidades=!1,this.atualizar_servidores=!1,this.atualizar_gestores=!0,this.usar_arquivos_locais=!1,this.gravar_arquivos_locais=!1,this.usuario_id="",this.entidade_id=""}};var xe=["entidade"],ze=["usuario"];function ye(t,i){if(t&1&&(l(0,"div",3),_(1,"input-text",15,0)(3,"input-text",16,1)(5,"input-datetime",17),r()),t&2){let n=v();o(),s("size",4)("control",n.form.controls.entidade_id),U("maxlength",250),o(2),s("size",5)("control",n.form.controls.usuario_id),U("maxlength",250),o(2),s("size",3)("control",n.form.controls.data_execucao)}}function we(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.$implicit,e=i.index;o(),f("["+(e+1)+"] "+n)}}function Fe(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.$implicit,e=i.index;o(),f("["+(e+1)+"] "+n)}}function De(t,i){if(t&1&&(l(0,"div",19)(1,"span")(2,"strong"),d(3,"Falhas"),r()(),c(4,Fe,2,1,"span",20),r()),t&2){let n=v(2);o(4),s("ngForOf",n.falhas_unidades)}}function Re(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.$implicit,e=i.index;o(),f("["+(e+1)+"] "+n)}}function Te(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.$implicit,e=i.index;o(),f("["+(e+1)+"] "+n)}}function Oe(t,i){if(t&1&&(l(0,"div",19)(1,"span")(2,"strong"),d(3,"Falhas"),r()(),c(4,Te,2,1,"span",20),r()),t&2){let n=v(2);o(4),s("ngForOf",n.falhas_servidores)}}function Ne(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.$implicit,e=i.index;o(),f("["+(e+1)+"] "+n)}}function Be(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.$implicit,e=i.index;o(),f("["+(e+1)+"] "+n)}}function Le(t,i){if(t&1&&(l(0,"div",19)(1,"span")(2,"strong"),d(3,"Falhas"),r()(),c(4,Be,2,1,"span",20),r()),t&2){let n=v(2);o(4),s("ngForOf",n.falhas_gestores)}}function Ve(t,i){if(t&1&&(l(0,"div",3)(1,"separator",18)(2,"div",3)(3,"span")(4,"strong"),d(5,"Resultado"),r()(),l(6,"span"),d(7),r()(),l(8,"div",19)(9,"span")(10,"strong"),d(11,"Observa\xE7\xF5es"),r()(),c(12,we,2,1,"span",20),r(),c(13,De,5,1,"div",21),r(),l(14,"separator",22)(15,"div",3)(16,"span")(17,"strong"),d(18,"Resultado"),r()(),l(19,"span"),d(20),r()(),l(21,"div",19)(22,"span")(23,"strong"),d(24,"Observa\xE7\xF5es"),r()(),c(25,Re,2,1,"span",20),r(),c(26,Oe,5,1,"div",21),r(),l(27,"separator",23)(28,"div",3)(29,"span")(30,"strong"),d(31,"Resultado"),r()(),l(32,"span"),d(33),r()(),l(34,"div",19)(35,"span")(36,"strong"),d(37,"Observa\xE7\xF5es"),r()(),c(38,Ne,2,1,"span",20),r(),c(39,Le,5,1,"div",21),r()()),t&2){let n=v();o(),s("collapse","collapse"),o(6),f(n.resultado_unidades),o(5),s("ngForOf",n.obs_unidades),o(),s("ngIf",n.falhas_unidades.length>0),o(),s("collapse","collapse"),o(6),f(n.resultado_servidores),o(5),s("ngForOf",n.obs_servidores),o(),s("ngIf",n.falhas_servidores.length>0),o(),s("collapse","collapse"),o(6),f(n.resultado_gestores),o(5),s("ngForOf",n.obs_gestores),o(),s("ngIf",n.falhas_gestores.length>0)}}var Q=(()=>{let i=class i extends de{constructor(e,m){super(e,E,b),this.injector=e,this.confirmLabel="Executar",this.production=!1,this.resultado_unidades="",this.obs_unidades=[],this.falhas_unidades=[],this.resultado_servidores="",this.obs_servidores=[],this.falhas_servidores=[],this.resultado_gestores="",this.obs_gestores=[],this.falhas_gestores=[],this.validate=(a,u)=>{let p=null;return["entidade_id","usuario_id"].indexOf(u)>=0&&!a.value?.length&&(p="Obrigat\xF3rio"),p},this.entidadeDao=e.get(ee),this.form=this.fh.FormBuilder({atualizar_unidades:{default:!1},atualizar_servidores:{default:!1},atualizar_gestores:{default:!0},usar_arquivos_locais:{default:!1},gravar_arquivos_locais:{default:!1},entidade_id:{default:""},usuario_id:{default:""},data_execucao:{default:""},resultado:{default:""}},this.cdRef,this.validate),this.join=["entidade","usuario"]}loadData(e,m){let a=Object.assign({},m.value);m.patchValue(this.util.fillForm(a,e)),this.preparaFormulario(e)}preparaFormulario(e){this.production=Y.production,this.form.controls.entidade_id.setValue(e.id?e.entidade.nome:this.auth.unidade?.entidade_id),this.form.controls.usuario_id.setValue(e.id?e.usuario_id?e.usuario.nome:"Usu\xE1rio n\xE3o logado":this.auth.usuario.id),this.resultado_unidades=e.id?JSON.parse(e.resultado).unidades.Resultado:"",this.obs_unidades=e.id?JSON.parse(e.resultado).unidades.Observa\u00E7\u00F5es:[],this.falhas_unidades=e.id?JSON.parse(e.resultado).unidades.Falhas:[],this.resultado_servidores=e.id?JSON.parse(e.resultado).servidores.Resultado:"",this.obs_servidores=e.id?JSON.parse(e.resultado).servidores.Observa\u00E7\u00F5es:[],this.falhas_servidores=e.id?JSON.parse(e.resultado).servidores.Falhas:[],this.resultado_gestores=e.id?JSON.parse(e.resultado).gestores.Resultado:"",this.obs_gestores=e.id?JSON.parse(e.resultado).gestores.Observa\u00E7\u00F5es:[],this.falhas_gestores=e.id?JSON.parse(e.resultado).gestores.Falhas:[]}initializeData(e){this.loadData(new E,e)}saveData(e){return new Promise((m,a)=>{let u=this.util.fill(new E,this.entity);m(this.util.fillForm(u,this.form.value))})}};i.\u0275fac=function(m){return new(m||i)(x(F),x(b))},i.\u0275cmp=y({type:i,selectors:[["app-integracao-form"]],viewQuery:function(m,a){if(m&1&&(I(V,5),I(xe,5),I(ze,5)),m&2){let u;C(u=S())&&(a.editableForm=u.first),C(u=S())&&(a.entidade=u.first),C(u=S())&&(a.usuario=u.first)}},features:[D],decls:16,vars:21,consts:[["entidade",""],["usuario",""],[3,"submit","cancel","form","disabled","title","confirmLabel"],[1,"row"],["class","row",4,"ngIf"],[1,"mt-2",3,"title","collapse"],["title","Deve ser atualizado pela Rotina de Integra\xE7\xE3o:"],["labelPosition","right","label","Unidades","controlName","atualizar_unidades",3,"size","control"],["labelPosition","right","label","Servidores","controlName","atualizar_servidores",3,"size","control"],["labelPosition","right","label","Gestores","controlName","atualizar_gestores",3,"disabled","size","control"],[1,"row","mt-4"],["title","Com rela\xE7\xE3o aos dados atualizados...(*)"],[1,"badge","rounded-pill","bg-info","text-dark"],["labelPosition","right","label","Usar arquivos locais","controlName","usar_arquivos_locais","labelInfo","Selecione se os dados para atualiza\xE7\xE3o devem ser lidos de um arquivo local",3,"disabled","size","control"],["labelPosition","right","label","Gravar em arquivos locais","controlName","gravar_arquivos_locais","labelInfo","Selecione se os dados atualizados devem ser salvos em um arquivo local",3,"disabled","size","control"],["label","Entidade","icon","bi bi-upc","controlName","entidade_id",3,"size","control"],["label","Usu\xE1rio","icon","bi bi-upc","controlName","usuario_id",3,"size","control"],["datetime","","label","Execu\xE7\xE3o","icon","bi bi-calendar-date","controlName","data_execucao",3,"size","control"],["title","UNIDADES",1,"mt-2",3,"collapse"],[1,"row","mt-2"],[4,"ngFor","ngForOf"],["class","row mt-2",4,"ngIf"],["title","SERVIDORES",3,"collapse"],["title","GESTORES",3,"collapse"]],template:function(m,a){m&1&&(l(0,"editable-form",2),R("submit",function(){return a.onSaveData()})("cancel",function(){return a.onCancel()}),l(1,"div",3),c(2,ye,6,8,"div",4)(3,Ve,40,12,"div",4),l(4,"separator",5)(5,"div",3)(6,"separator",6),_(7,"input-switch",7)(8,"input-switch",8)(9,"input-switch",9),r()(),l(10,"div",10)(11,"separator",11)(12,"span",12),d(13,"(*) N\xE3o funciona em ambientes de Produ\xE7\xE3o / Homologa\xE7\xE3o"),r(),_(14,"input-switch",13)(15,"input-switch",14),r()()()()()),m&2&&(s("form",a.form)("disabled",a.formDisabled)("title",a.isModal?"":a.title)("confirmLabel",a.confirmLabel),o(2),s("ngIf",a.formDisabled),o(),s("ngIf",a.formDisabled),o(),s("title",a.formDisabled?"Par\xE2metros utilizados":"")("collapse",a.formDisabled?"collapse":void 0),o(3),s("size",4)("control",a.form.controls.atualizar_unidades),o(),s("size",4)("control",a.form.controls.atualizar_servidores),o(),s("disabled",a.util.isDeveloper()?void 0:"disabled")("size",4)("control",a.form.controls.atualizar_gestores),o(5),s("disabled",a.production?"disabled":void 0)("size",4)("control",a.form.controls.usar_arquivos_locais),o(),s("disabled",a.production?"disabled":void 0)("size",4)("control",a.form.controls.gravar_arquivos_locais))},dependencies:[W,T,V,L,te,B,A]});let t=i;return t})();var Ae=["selectResponsaveis"];function Pe(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.row;o(),k(" ",n.usuario?n.usuario.nome:"Usu\xE1rio n\xE3o logado"," ")}}function qe(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.row,e=v();o(),f(e.util.getDateTimeFormatted(n.data_execucao))}}function Ue(t,i){t&1&&(d(0," Solic. altera\xE7\xE3o"),_(1,"br"),d(2,"de Unidades "))}function Ge(t,i){if(t&1&&(l(0,"span"),d(1),r(),_(2,"br")),t&2){let n=i.row,e=v();o(),f(e.util.getBooleanFormatted(n.atualizar_unidades))}}function Me(t,i){t&1&&(d(0," Solic. altera\xE7\xE3o"),_(1,"br"),d(2,"de Servidores "))}function Qe(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.row,e=v();o(),f(e.util.getBooleanFormatted(n.atualizar_servidores))}}function je(t,i){t&1&&(d(0," Solic. altera\xE7\xE3o"),_(1,"br"),d(2,"de Gestores "))}function Je(t,i){if(t&1&&(l(0,"span"),d(1),r()),t&2){let n=i.row,e=v();o(),f(e.util.getBooleanFormatted(n.atualizar_gestores))}}function $e(t,i){if(t&1&&_(0,"column",24),t&2){let n=v();s("dynamicButtons",n.dynamicButtons.bind(n))}}var pe=(()=>{let i=class i extends me{constructor(e,m){super(e,E,b),this.injector=e,this.toolbarButtons=[],this.responsaveis=[],this.labelAdd="Executar",this.filterWhere=a=>{let u=[],p=a.value;return p.usuario_id.length&&u.push(["usuario_id","==",p.usuario_id=="null"?null:p.usuario_id]),p.data_inicio&&u.push(["data_execucao",">=",p.data_inicio]),p.data_fim&&u.push(["data_execucao","<=",p.data_fim]),p.atualizar_unidades&&u.push(["atualizar_unidades","==",p.atualizar_unidades]),p.atualizar_servidores&&u.push(["atualizar_servidores","==",p.atualizar_servidores]),p.atualizar_gestores&&u.push(["atualizar_gestores","==",p.atualizar_gestores]),u},this.allPages=e.get(se),this.usuarioDao=e.get(Z),this.title=this.lex.translate("Rotinas de Integra\xE7\xE3o"),this.filter=this.fh.FormBuilder({usuario_id:{default:""},data_inicio:{default:""},data_fim:{default:""},atualizar_unidades:{default:""},atualizar_servidores:{default:""},atualizar_gestores:{default:""}}),this.orderBy=[["data_execucao","desc"]]}ngAfterViewInit(){super.ngAfterViewInit(),this.selectResponsaveis.loading=!0,this.dao?.showResponsaveis().then(e=>{this.responsaveis=e||[],this.cdRef.detectChanges()}).finally(()=>this.selectResponsaveis.loading=!1)}ngAfterViewChecked(){this.cdRef.detectChanges()}filterClear(e){e.controls.usuario_id.setValue(""),e.controls.data_inicio.setValue(""),e.controls.data_fim.setValue(""),e.controls.atualizar_unidades.setValue(""),e.controls.atualizar_servidores.setValue(""),e.controls.atualizar_gestores.setValue(""),super.filterClear(e)}dynamicButtons(e){let m=[];return this.auth.hasPermissionTo("MOD_DEV_TUDO")&&m.push({icon:"bi bi-info-circle",label:"Informa\xE7\xF5es",onClick:this.consult.bind(this)}),m}};i.\u0275fac=function(m){return new(m||i)(x(F),x(b))},i.\u0275cmp=y({type:i,selectors:[["app-integracao-list"]],viewQuery:function(m,a){if(m&1&&(I(N,5),I(Ae,5)),m&2){let u;C(u=S())&&(a.grid=u.first),C(u=S())&&(a.selectResponsaveis=u.first)}},features:[D],decls:37,vars:40,consts:[["selectResponsaveis",""],["columnResponsavel",""],["columnDataExecucao",""],["titleUnidades",""],["columnUnidades",""],["titleServidores",""],["columnServidores",""],["titleGestores",""],["columnGestores",""],[3,"select","dao","add","title","orderBy","groupBy","join","labelAdd","selectable","hasAdd","hasEdit"],[3,"deleted","form","where","submit","clear","collapseChange","collapsed"],[1,"row"],["label","Respons\xE1vel","controlName","usuario_id",3,"size","control","items"],["datetime","","label","In\xEDcio","controlName","data_inicio","labelInfo","In\xEDcio dos registros",3,"size","control"],["datetime","","label","Fim","controlName","data_fim","labelInfo","Fim dos registros",3,"size","control"],["title","Considerar integra\xE7\xF5es com a atualiza\xE7\xE3o solicitada: "],["scale","small","labelPosition","right","label","de Unidades","controlName","atualizar_unidades",3,"size","control"],["scale","small","labelPosition","right","label","de Servidores","controlName","atualizar_servidores",3,"size","control"],["scale","small","labelPosition","right","label","de Gestores","controlName","atualizar_gestores",3,"size","control"],["title","Respons\xE1vel",3,"template"],["title","Executada em","orderBy","data_execucao",3,"template"],[3,"titleTemplate","template"],["type","options",3,"dynamicButtons",4,"ngIf"],[3,"rows"],["type","options",3,"dynamicButtons"]],template:function(m,a){if(m&1){let u=$();l(0,"grid",9),R("select",function(q){return j(u),J(a.onSelect(q))}),_(1,"toolbar"),l(2,"filter",10)(3,"div",11),_(4,"input-select",12,0)(6,"input-datetime",13)(7,"input-datetime",14),r(),l(8,"div",11)(9,"separator",15),_(10,"input-switch",16)(11,"input-switch",17)(12,"input-switch",18),r()()(),l(13,"columns")(14,"column",19),c(15,Pe,2,1,"ng-template",null,1,h),r(),l(17,"column",20),c(18,qe,2,1,"ng-template",null,2,h),r(),l(20,"column",21),c(21,Ue,3,0,"ng-template",null,3,h)(23,Ge,3,1,"ng-template",null,4,h),r(),l(25,"column",21),c(26,Me,3,0,"ng-template",null,5,h)(28,Qe,2,1,"ng-template",null,6,h),r(),l(30,"column",21),c(31,je,3,0,"ng-template",null,7,h)(33,Je,2,1,"ng-template",null,8,h),r(),c(35,$e,1,1,"column",22),r(),_(36,"pagination",23),r()}if(m&2){let u=g(16),p=g(19),q=g(22),fe=g(24),_e=g(27),ve=g(29),ge=g(32),he=g(34);s("dao",a.dao)("add",a.add)("title",a.isModal?"":a.title)("orderBy",a.orderBy)("groupBy",a.groupBy)("join",a.join)("labelAdd",a.labelAdd)("selectable",a.selectable)("hasAdd",a.auth.hasPermissionTo("MOD_DEV_TUDO"))("hasEdit",!1),o(2),s("deleted",a.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",a.filter)("where",a.filterWhere)("submit",a.filterSubmit.bind(a))("clear",a.filterClear.bind(a))("collapseChange",a.filterCollapseChange.bind(a))("collapsed",!a.selectable&&a.filterCollapsed),o(2),s("size",4)("control",a.filter.controls.usuario_id)("items",a.responsaveis),o(2),s("size",3)("control",a.filter.controls.data_inicio),o(),s("size",3)("control",a.filter.controls.data_fim),o(3),s("size",4)("control",a.filter.controls.atualizar_unidades),o(),s("size",4)("control",a.filter.controls.atualizar_servidores),o(),s("size",4)("control",a.filter.controls.atualizar_gestores),o(2),s("template",u),o(3),s("template",p),o(3),s("titleTemplate",q)("template",fe),o(5),s("titleTemplate",_e)("template",ve),o(5),s("titleTemplate",ge)("template",he),o(5),s("ngIf",!a.selectable),o(),s("rows",a.rowsLimit)}},dependencies:[T,N,oe,ae,re,ie,ne,L,B,le,A]});let t=i;return t})();var ke=[{path:"integracao",component:pe,canActivate:[O],resolve:{config:P},runGuardsAndResolvers:"always",data:{title:"Rotinas de Integra\xE7\xE3o"}},{path:"integracao/new",component:Q,canActivate:[O],resolve:{config:P},runGuardsAndResolvers:"always",data:{title:"Execu\xE7\xE3o de Rotina de Integra\xE7\xE3o",modal:!0}},{path:"integracao/:id/consult",component:Q,canActivate:[O],resolve:{config:P},runGuardsAndResolvers:"always",data:{title:"Consulta a Rotina de Integra\xE7\xE3o",modal:!0}}],ce=(()=>{let i=class i{};i.\u0275fac=function(m){return new(m||i)},i.\u0275mod=w({type:i}),i.\u0275inj=z({imports:[G.forChild(ke),G]});let t=i;return t})();var Nt=(()=>{let i=class i{};i.\u0275fac=function(m){return new(m||i)},i.\u0275mod=w({type:i}),i.\u0275inj=z({imports:[H,ue,K,ce]});let t=i;return t})();export{Nt as a};
