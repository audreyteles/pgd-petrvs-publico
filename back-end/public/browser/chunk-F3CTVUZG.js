import{a as kt}from"./chunk-XNT3BZCX.js";import{a as qt}from"./chunk-DKLB64UK.js";import{a as zt}from"./chunk-DUCFJQUF.js";import"./chunk-BPXUIHBM.js";import{a as Ft,b as jt}from"./chunk-MNKRGGEJ.js";import{a as Bt}from"./chunk-BYGE43PY.js";import{c as St,i as $,j as Rt,k as Lt,l as Vt,n as Nt}from"./chunk-5IAOL3IR.js";import{d as wt}from"./chunk-IVBXO46K.js";import{a as _e}from"./chunk-UFS3OPCG.js";import{b as se}from"./chunk-76VPKZU2.js";import{a as U,b as M}from"./chunk-RMYSPY7H.js";import{U as Ae,X as de,b as te,ea as Ge,f as W,fa as xt,h as Z,i as re,j as qe,n as Be,o as At,r as he,s as q,t as le,v as B,w as Ue,x as Me}from"./chunk-XHTD5OAS.js";import{b as ie,c as j,d as k,e as ae,h as ne,m as oe,s as A}from"./chunk-KODYKPWY.js";import{i as Dt}from"./chunk-ORJB5SCJ.js";import{$a as Et,Aa as ht,Ab as ue,Bb as F,Ca as _t,Da as ft,Dd as je,Ed as ke,Fa as c,Fb as bt,Ga as d,Ha as m,Ia as at,Ja as nt,Jd as pe,La as N,Ma as D,Mc as yt,Na as p,Nd as Ot,O as ut,P as Re,R as gt,Rc as Y,Sc as J,U as x,Ua as C,V as Le,Va as y,Vc as It,Wa as I,Xa as _,Ya as g,Z as P,Za as T,_ as O,_a as z,a as Se,b as we,ba as S,bd as Ne,c as Pe,cd as H,dd as Tt,fd as Pt,h as v,kb as X,lb as Q,ma as l,mb as Oe,na as R,oc as ot,pc as Ve,qd as ge,sb as f,tb as vt,va as L,vd as ze,wc as Ct,xa as u,xd as me,ya as K,yd as Fe,za as r}from"./chunk-6YMI2QVU.js";var ee=class extends Ve{constructor(o){super(),this.entregas=[],this.status_historico=[],this.data_inicio=new Date,this.data_fim=null,this.nome="",this.metadados=void 0,this.arquivar=!1,this.status="INCLUIDO",this.avaliacoes=[],this.unidade_id="",this.avaliacao_id=null,this.plano_entrega_id=null,this.planejamento_id=null,this.cadeia_valor_id=null,this.programa_id=null,this.initialization(o)}};var ri=()=>["PORCENTAGEM"],li=()=>["QUANTIDADE","VALOR"],si=()=>["QUALITATIVO"],di=()=>[];function ci(a,o){if(a&1){let n=N();c(0,"input-number",3),D("change",function(i){P(n);let t=p();return O(t.onValueChange(i))}),d()}if(a&2){let n=p();r("disabled",n.disabled)("icon",n.icon)("label",n.label||"Porcentagem")("control",n.control)("labelInfo",n.labelInfo)}}function mi(a,o){if(a&1){let n=N();c(0,"input-number",4),D("change",function(i){P(n);let t=p();return O(t.onValueChange(i))}),d()}if(a&2){let n=p();r("disabled",n.disabled)("icon",n.icon)("label",n.label||"Num\xE9rico")("control",n.control)("labelInfo",n.labelInfo)}}function pi(a,o){if(a&1){let n=N();c(0,"input-select",5),D("change",function(i){P(n);let t=p();return O(t.onValueChange(i))}),d()}if(a&2){let n=p();r("disabled",n.disabled)("icon",n.icon)("label",n.label||"Qualitativo")("control",n.control)("items",(n.entrega==null?null:n.entrega.lista_qualitativos)||X(6,di))("labelInfo",n.labelInfo)}}var De=(()=>{let o=class o{constructor(){this.class="form-group",this.icon="",this.labelInfo="",this._size=0}set size(e){e!=this._size&&(this._size=e,this.class=this.class.replace(/\scol\-md\-[0-9]+/g,"")+" col-md-"+e)}get size(){return this._size||12}checkTipoIndicador(e){return e.includes(this.entrega?.tipo_indicador||"")}onValueChange(e){this.change&&this.change(this.control?.value,this.entrega)}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-valor-meta-input"]],hostVars:2,hostBindings:function(i,t){i&2&&ft(t.class)},inputs:{entrega:"entrega",icon:"icon",label:"label",labelInfo:"labelInfo",disabled:"disabled",control:"control",change:"change",size:"size"},decls:3,vars:6,consts:[["sufix","%","required","",3,"disabled","icon","label","control","labelInfo","change",4,"ngIf"],["required","",3,"disabled","icon","label","control","labelInfo","change",4,"ngIf"],["required","",3,"disabled","icon","label","control","items","labelInfo","change",4,"ngIf"],["sufix","%","required","",3,"change","disabled","icon","label","control","labelInfo"],["required","",3,"change","disabled","icon","label","control","labelInfo"],["required","",3,"change","disabled","icon","label","control","items","labelInfo"]],template:function(i,t){i&1&&u(0,ci,1,5,"input-number",0)(1,mi,1,5,"input-number",1)(2,pi,1,7,"input-select",2),i&2&&(r("ngIf",t.checkTipoIndicador(X(3,ri))),l(),r("ngIf",t.checkTipoIndicador(X(4,li))),l(),r("ngIf",t.checkTipoIndicador(X(5,si))))},dependencies:[F,re,he]});let a=o;return a})();var _i=["etiqueta"];function fi(a,o){if(a&1&&(c(0,"strong",17),g(1,"Entregas: "),d(),c(2,"span",18),m(3,"badge",19),d()),a&2){let n=o.separator;l(3),r("label",n==null?null:n.text)}}function Ei(a,o){if(a&1&&m(0,"badge",24),a&2){let n=p().row,e=p();r("icon",e.entityService.getIcon("Unidade"))("label",n.unidade.sigla)}}function vi(a,o){if(a&1&&m(0,"badge",25),a&2){let n=p().row;r("label",n.destinatario)}}function bi(a,o){if(a&1&&m(0,"reaction",26),a&2){let n=p().row;r("entity",n)}}function Ci(a,o){if(a&1&&(c(0,"h6"),g(1),d(),c(2,"span",20),u(3,Ei,1,2,"badge",21)(4,vi,1,1,"badge",22),d(),u(5,bi,1,1,"reaction",23)),a&2){let n=o.row,e=p();l(),T(n.descricao),l(2),r("ngIf",n.unidade),l(),r("ngIf",n.destinatario==null?null:n.destinatario.length),l(),r("ngIf",e.execucao)}}function yi(a,o){if(a&1&&m(0,"badge",28),a&2){let n=o.$implicit;r("lookup",n)}}function Ii(a,o){if(a&1&&u(0,yi,1,1,"badge",27),a&2){let n=o.row;r("ngForOf",n.etiquetas)}}function Ti(a,o){if(a&1){let n=N();c(0,"input-multiselect",29)(1,"input-select",30,8),D("details",function(){P(n);let i=p();return O(i.onEtiquetaConfigClick())}),d()()}if(a&2){let n=p();r("size",12)("control",n.formEdit.controls.etiquetas)("addItemHandle",n.addItemHandleEtiquetas.bind(n)),l(),r("size",12)("control",n.formEdit.controls.etiqueta)("items",n.etiquetas)}}function Pi(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_inicio),"")}}function Oi(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_fim),"")}}function Ai(a,o){if(a&1&&(u(0,Pi,2,1,"span",31),m(1,"br"),u(2,Oi,2,1,"span",31)),a&2){let n=o.row;r("ngIf",n.data_inicio),l(2),r("ngIf",n.data_fim)}}function Di(a,o){if(a&1&&m(0,"badge",32)(1,"br")(2,"badge",33),a&2){let n=o.row,e=p();r("textValue",e.planoEntregaService.getValorMeta(n)),l(2),r("textValue",e.planoEntregaService.getValorRealizado(n))}}function xi(a,o){if(a&1&&m(0,"plano-entrega-valor-meta-input",34)(1,"plano-entrega-valor-meta-input",35),a&2){let n=o.row,e=p();r("entrega",n.entrega)("size",6)("control",e.form.controls.meta),l(),r("entrega",n.entrega)("size",6)("control",e.form.controls.realizado)("change",e.onRealizadaChange.bind(e))}}function Si(a,o){a&1&&m(0,"i",42)}function wi(a,o){if(a&1&&(c(0,"tr")(1,"td"),u(2,Si,1,0,"i",40),d(),c(3,"td",41),g(4),d()()),a&2){let n=o.$implicit;l(2),r("ngIf",n.checked),l(2),T(n.texto)}}function Ri(a,o){if(a&1&&(c(0,"table"),u(1,wi,5,2,"tr",39),d()),a&2){let n=p(2).row;l(),r("ngForOf",n.checklist)}}function Li(a,o){if(a&1&&(c(0,"separator",38),u(1,Ri,2,1,"table",31),d()),a&2){let n=p().row;r("collapsed",!0),l(),r("ngIf",n.checklist==null?null:n.checklist.length)}}function Vi(a,o){if(a&1&&(m(0,"progress-bar",36),u(1,Li,2,2,"separator",37)),a&2){let n=o.row;r("value",n.progresso_realizado)("goal",n.progresso_esperado),l(),r("ngIf",n.checklist==null?null:n.checklist.length)}}function Ni(a,o){a&1&&m(0,"separator",45)}function zi(a,o){if(a&1&&(c(0,"tr")(1,"td"),m(2,"input-switch",46),d(),c(3,"td",41),g(4),d()()),a&2){let n=o.$implicit,e=o.index,i=p(4);l(2),r("size",12)("source",i.checklist)("path",e+".checked"),l(2),T(n.texto)}}function Fi(a,o){if(a&1&&(c(0,"table"),u(1,zi,5,4,"tr",39),d()),a&2){let n=p(3);l(),r("ngForOf",n.checklist)}}function ji(a,o){if(a&1&&(m(0,"input-number",43),u(1,Ni,1,0,"separator",44)(2,Fi,2,1,"table",31)),a&2){let n=o.row,e=p(2);r("size",12)("control",e.formEdit.controls.progresso_realizado),l(),r("ngIf",n.checklist==null?null:n.checklist.length),l(),r("ngIf",n.checklist==null?null:n.checklist.length)}}function ki(a,o){if(a&1&&(c(0,"column",13),u(1,Vi,2,3,"ng-template",null,9,f)(3,ji,3,4,"ng-template",null,10,f),d()),a&2){let n=_(2),e=_(4),i=p();r("title",`Progresso
Checklist`)("width",200)("template",n)("editTemplate",n)("columnEditTemplate",i.selectable?void 0:e)("edit",i.selectable?void 0:i.onColumnChecklistEdit.bind(i))("save",i.selectable?void 0:i.onColumnChecklistSave.bind(i))}}function qi(a,o){if(a&1&&m(0,"badge",49),a&2){let n=p().row;r("label",n.entrega==null?null:n.entrega.nome)}}function Bi(a,o){if(a&1&&(u(0,qi,1,1,"badge",47),m(1,"comentarios-widget",48)),a&2){let n=o.row,e=p();r("ngIf",n.entrega),l(),r("entity",n)("selectable",!e.execucao||!!(e.grid!=null&&e.grid.editing))("grid",e.grid)("save",e.refreshComentarios.bind(e))}}var $e=(()=>{let o=class o extends oe{set noPersist(e){super.noPersist=e}get noPersist(){return super.noPersist}set control(e){super.control=e}get control(){return super.control}set entity(e){super.entity=e}get entity(){return super.entity}set planejamentoId(e){this._planejamentoId!=e&&(this._planejamentoId=e)}get planejamentoId(){return this._planejamentoId}set cadeiaValorId(e){this._cadeiaValorId!=e&&(this._cadeiaValorId=e)}get cadeiaValorId(){return this._cadeiaValorId}set unidadeId(e){this._unidadeId!=e&&(this._unidadeId=e)}get unidadeId(){return this._unidadeId}set dataFim(e){this._dataFim!=e&&(this._dataFim=e)}get dataFim(){return this._dataFim}get items(){return this.gridControl.value||this.gridControl.setValue([]),this.gridControl.value}constructor(e){super(e),this.injector=e,this.disabled=!1,this.execucao=!1,this.entityToControl=i=>i.entregas||[],this.options=[],this.planoEntregaId="",this.etiquetas=[],this.etiquetasAscendentes=[],this.selectable=!1,this.validate=(i,t)=>{let s=null;return["nome"].indexOf(t)>=0&&!i.value?.length&&(s="Obrigat\xF3rio"),s},this.filterWhere=i=>{let t=[],s=i.value;return t.push(["plano_entrega_id","==",this.planoEntregaId]),t},this.title=this.lex.translate("Entregas"),this.join=["unidade","entrega","reacoes.usuario:id,nome,apelido"],this.code="MOD_PENT",this.cdRef=e.get(vt),this.dao=e.get(H),this.unidadeDao=e.get(J),this.planoEntregaService=e.get($),this.form=this.fh.FormBuilder({descricao:{default:""},data_inicio:{default:new Date},data_fim:{default:new Date},meta:{default:""},realizado:{default:null},entrega_id:{default:null},unidade_id:{default:null},progresso_esperado:{default:null},progresso_realizado:{default:null},destinatario:{default:null},etiquetas:{default:[]}},this.cdRef,this.validate),this.formEdit=this.fh.FormBuilder({progresso_realizado:{default:0},etiquetas:{default:[]},etiqueta:{default:null}}),this.addOption(Object.assign({onClick:this.consult.bind(this)},this.OPTION_INFORMACOES),"MOD_PENT"),this.addOption(Object.assign({onClick:this.delete.bind(this)},this.OPTION_EXCLUIR),"MOD_PENT_ENTR_EXCL"),this.addOption(Object.assign({onClick:this.showLogs.bind(this)},this.OPTION_LOGS),"MOD_AUDIT_LOG")}ngOnInit(){super.ngOnInit(),this.planoEntregaId=this.urlParams.get("id")||""}get isDisabled(){return this.formDisabled||this.disabled}add(){return v(this,null,function*(){let e=new pe({_status:"ADD",id:this.dao.generateUuid(),plano_entrega_id:this.entity?.id});this.go.navigate({route:["gestao","plano-entrega","entrega"]},{metadata:{plano_entrega:this.entity,planejamento_id:this.planejamentoId,cadeia_valor_id:this.cadeiaValorId,unidade_id:this.unidadeId,data_fim:this.dataFim,entrega:e},modalClose:i=>v(this,null,function*(){if(i)try{this.isNoPersist?this.items.push(i):this.items.push(yield this.dao.save(i,this.join)),this.cdRef.detectChanges()}catch(t){this.error(t?.error||t?.message||t)}})})})}dynamicOptions(e){return!this.execucao&&!this.isDisabled?this.options:[]}dynamicButtons(e){let i=[];return this.isDisabled&&i.push(Object.assign({onClick:this.consult.bind(this)},this.OPTION_INFORMACOES)),this.execucao&&i.push({label:"Hist\xF3rico de execu\xE7\xE3o",icon:"bi bi-activity",color:"btn-outline-info",onClick:this.showProgresso.bind(this)}),i.push({label:"Detalhes",icon:"bi bi-eye",color:"btn-outline-success",onClick:this.showDetalhes.bind(this)}),i}edit(e){return v(this,null,function*(){if(this.execucao)this.grid.edit(e);else{e._status=e._status=="ADD"?"ADD":"EDIT";let i=this.items.indexOf(e);this.go.navigate({route:["gestao","plano-entrega","entrega"]},{metadata:{plano_entrega:this.entity,planejamento_id:this.planejamentoId,cadeia_valor_id:this.cadeiaValorId,unidade_id:this.unidadeId,entrega:e},modalClose:t=>v(this,null,function*(){t&&(this.isNoPersist||(yield this.dao?.save(t)),this.items[i]=t)})})}})}load(e,i){return v(this,null,function*(){this.form.patchValue(i),this.form.controls.meta.setValue(this.planoEntregaService.getValor(i.meta)),this.form.controls.realizado.setValue(this.planoEntregaService.getValor(i.realizado)),this.cdRef.detectChanges()})}save(e,i){return v(this,null,function*(){let t;if(this.form.markAllAsTouched(),e.valid){this.submitting=!0;try{t=yield this.dao?.update(i.id,{realizado:this.planoEntregaService.getEntregaValor(i.entrega,e.controls.realizado.value),progresso_realizado:e.controls.progresso_realizado.value},this.join)}finally{this.submitting=!1}}return t})}delete(e){return v(this,null,function*(){if(yield this.dialog.confirm("Exclui ?","Deseja realmente excluir?")){let t=this.items.indexOf(e);this.isNoPersist?e._status="DELETE":this.dao.delete(e).then(()=>{this.items.splice(t,1),this.cdRef.detectChanges(),this.dialog.topAlert("Registro exclu\xEDdo com sucesso!",5e3)}).catch(s=>{this.dialog.alert("Erro","Erro ao excluir: "+(s?.message?s?.message:s))})}})}consult(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega",e.id,"consult"]},{metadata:{plano_entrega:this.entity,planejamento_id:this.planejamentoId,cadeia_valor_id:this.cadeiaValorId,unidade_id:this.unidadeId,entrega:e}})})}showLogs(e){return v(this,null,function*(){this.go.navigate({route:["logs","change",e.id,"consult"]})})}showPlanejamento(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega","objetivos",e]},{modal:!0})})}showCadeiaValor(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega","processos",e]},{modal:!0})})}showProgresso(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega","progresso",e.id]},{modal:!0,modalClose:i=>{this.parent?.refresh(this.entity?.id)}})})}showDetalhes(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega",e.id,"detalhes"]},{metadata:{plano_entrega:this.entity,planejamento_id:this.planejamentoId,cadeia_valor_id:this.cadeiaValorId,unidade_id:this.unidadeId,entrega:e}})})}refreshComentarios(e){let i=this.items.find(t=>t.id==e.id);i&&(i.comentarios=e.comentarios||[])}onRealizadaChange(){let e=this.form?.controls.meta.value,i=this.form?.controls.realizado.value;if(e&&i){let t=isNaN(i)?0:(i/e*100).toFixed(0)||0;this.form?.controls.progresso_realizado.setValue(t)}}addItemHandleEtiquetas(){let e;if(this.etiqueta&&this.etiqueta.selectedItem){let i=this.etiqueta.selectedItem,t=i.key?.length?i.key:this.util.textHash(i.value);this.util.validateLookupItem(this.formEdit.controls.etiqueta.value,t)&&(e={key:t,value:i.value,color:i.color,icon:i.icon},this.formEdit.controls.etiqueta.setValue(null))}return e}onColumnEtiquetasEdit(e){return v(this,null,function*(){if(!this.etiquetasAscendentes.filter(i=>i.data==e.unidade.id).length){let i=yield this.carregaEtiquetasUnidadesAscendentes(e.unidade);this.etiquetasAscendentes.push(...i)}this.formEdit.controls.etiquetas.setValue(e.etiquetas),this.formEdit.controls.etiqueta.setValue(null),this.etiquetas=this.util.merge(e.tipo_atividade?.etiquetas,e.unidade?.etiquetas,(i,t)=>i.key==t.key),this.etiquetas=this.util.merge(this.etiquetas,this.auth.usuario.config?.etiquetas,(i,t)=>i.key==t.key),this.etiquetas=this.util.merge(this.etiquetas,this.etiquetasAscendentes.filter(i=>i.data==e.unidade.id),(i,t)=>i.key==t.key)})}carregaEtiquetasUnidadesAscendentes(e){return v(this,null,function*(){let i=[],t=e.path.split("/");return(yield this.unidadeDao.query({where:[["id","in",t]]}).asPromise()).forEach(h=>{i=this.util.merge(i,h.etiquetas,(E,b)=>E.key==b.key)}),i.forEach(h=>h.data=e.id),i})}onColumnEtiquetasSave(e){return v(this,null,function*(){try{let i=yield this.dao.update(e.id,{etiquetas:this.formEdit.controls.etiquetas.value});return e.etiquetas=this.formEdit.controls.etiquetas.value,!!i}catch{return!1}})}onEtiquetaConfigClick(){this.go.navigate({route:["configuracoes","preferencia","usuario",this.auth.usuario.id],params:{etiquetas:!0}},{modal:!0,modalClose:e=>{this.etiquetas=this.util.merge(this.etiquetas,this.auth.usuario.config?.etiquetas,(i,t)=>i.key==t.key),this.cdRef.detectChanges()}})}onColumnChecklistEdit(e){return v(this,null,function*(){this.formEdit.controls.progresso_realizado.setValue(e.progresso_realizado),this.checklist=this.util.clone(e.checklist)})}onColumnChecklistSave(e){return v(this,null,function*(){let i=Math.round(parseInt(this.planoEntregaService.getValorMeta(e))*this.formEdit.controls.progresso_realizado.value/100);try{let t=yield this.dao.update(e.id,{progresso_realizado:this.formEdit.controls.progresso_realizado.value,realizado:this.planoEntregaService.getEntregaValor(e.entrega,i),checklist:this.checklist});return e.progresso_realizado=this.formEdit.controls.progresso_realizado.value,e.checklist=this.checklist,typeof e.realizado.porcentagem<"u"?e.realizado.porcentagem=i:typeof e.realizado.quantitativo<"u"?e.realizado.quantitativo=i:typeof e.realizado.valor<"u"&&(e.realizado.valor=i),!!t}catch{return!1}})}getObjetivos(e){return e.objetivos.filter(i=>i._status!="DELETE")}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-list-entrega"]],viewQuery:function(i,t){if(i&1&&(C(q,5),C(A,5),C(_i,5)),i&2){let s;y(s=I())&&(t.editableForm=s.first),y(s=I())&&(t.grid=s.first),y(s=I())&&(t.etiqueta=s.first)}},inputs:{cdRef:"cdRef",disabled:"disabled",parent:"parent",noPersist:"noPersist",control:"control",entity:"entity",planejamentoId:"planejamentoId",cadeiaValorId:"cadeiaValorId",unidadeId:"unidadeId",dataFim:"dataFim",execucao:"execucao"},features:[L],decls:25,vars:35,consts:[["groupEntregas",""],["columnEntregaCliente",""],["columnEtiquetas",""],["columnEtiquetasEdit",""],["columnDatas",""],["columnMetaRealizado",""],["editMetaRealizado",""],["columnEntregaCometario",""],["etiqueta",""],["columnProgChecklist",""],["columnChecklistEdit",""],[3,"items","form","groupTemplate","minHeight","editable","hasAdd","add","hasEdit","load","save","selectable"],[3,"title","template","editTemplate"],[3,"title","width","template","editTemplate","columnEditTemplate","edit","save"],[3,"title","width","template","editTemplate"],[3,"title","width","template","editTemplate","columnEditTemplate","edit","save",4,"ngIf"],["type","options",3,"onEdit","dynamicButtons","dynamicOptions"],[1,"grid-group-text"],[1,"text-wrap"],["color","primary",3,"label"],[1,"d-block"],["color","light",3,"icon","label",4,"ngIf"],["color","light","icon","bi bi-mailbox",3,"label",4,"ngIf"],["origem","PLANO_ENTREGA_ENTREGA",3,"entity",4,"ngIf"],["color","light",3,"icon","label"],["color","light","icon","bi bi-mailbox",3,"label"],["origem","PLANO_ENTREGA_ENTREGA",3,"entity"],[3,"lookup",4,"ngFor","ngForOf"],[3,"lookup"],["controlName","etiquetas",3,"size","control","addItemHandle"],["controlName","etiqueta","nullable","","itemNull","- Selecione -","detailsButton","","detailsButtonIcon","bi bi-tools",3,"details","size","control","items"],[4,"ngIf"],["icon","bi bi-graph-up-arrow","color","light","hint","Planejada",3,"textValue"],["icon","bi bi-check-lg","color","light","hint","Realizada",3,"textValue"],["icon","bi bi-graph-up-arrow","disabled","","label","Meta",3,"entrega","size","control"],["icon","bi bi-check-lg","label","Realizada",3,"entrega","size","control","change"],["color","success",3,"value","goal"],["small","","title","Checklist","collapse","",3,"collapsed",4,"ngIf"],["small","","title","Checklist","collapse","",3,"collapsed"],[4,"ngFor","ngForOf"],["class","bi bi-check-circle",4,"ngIf"],[1,"micro-text","fw-ligh"],[1,"bi","bi-check-circle"],["label","Realizado","sufix","%","icon","bi bi-clock","controlName","progresso_realizado","labelInfo","Progresso de execu\xE7\xE3o (% Conclu\xEDdo)",3,"size","control"],["small","","title","Checklist",4,"ngIf"],["small","","title","Checklist"],["scale","small",3,"size","source","path"],["color","light","icon","bi bi-list-check",3,"label",4,"ngIf"],["origem","PLANO_ENTREGA_ENTREGA",3,"entity","selectable","grid","save"],["color","light","icon","bi bi-list-check",3,"label"]],template:function(i,t){if(i&1&&(c(0,"grid",11),u(1,fi,4,1,"ng-template",null,0,f),c(3,"columns")(4,"column",12),u(5,Ci,6,4,"ng-template",null,1,f),d(),c(7,"column",13),u(8,Ii,1,1,"ng-template",null,2,f)(10,Ti,3,6,"ng-template",null,3,f),d(),c(12,"column",12),u(13,Ai,3,2,"ng-template",null,4,f),d(),c(15,"column",14),u(16,Di,3,2,"ng-template",null,5,f)(18,xi,2,7,"ng-template",null,6,f),d(),u(20,ki,5,7,"column",15),c(21,"column",12),u(22,Bi,2,5,"ng-template",null,7,f),d(),m(24,"column",16),d()()),i&2){let s=_(2),h=_(6),E=_(9),b=_(11),w=_(14),V=_(17),ye=_(19),Te=_(23);r("items",t.items)("form",t.form)("groupTemplate",s)("minHeight",300)("editable",t.isDisabled?void 0:"true")("hasAdd",!t.isDisabled&&t.auth.hasPermissionTo("MOD_PENT_ENTR_INCL")&&!t.execucao)("add",t.add.bind(t))("hasEdit",!t.isDisabled&&t.auth.hasPermissionTo("MOD_PENT_ENTR_EDT"))("load",t.load.bind(t))("save",t.save.bind(t))("selectable",t.selectable),l(4),r("title",`Entrega
Demandante/Destinat\xE1rio`)("template",h)("editTemplate",h),l(3),r("title","Etiquetas")("width",100)("template",E)("editTemplate",E)("columnEditTemplate",t.selectable?void 0:b)("edit",t.selectable?void 0:t.onColumnEtiquetasEdit.bind(t))("save",t.selectable?void 0:t.onColumnEtiquetasSave.bind(t)),l(5),r("title",`Data In\xEDcio
Data Fim`)("template",w)("editTemplate",w),l(3),r("title","Meta")("width",100)("template",V)("editTemplate",ye),l(5),r("ngIf",t.execucao),l(),r("title",t.lex.translate("Modelo de Entrega")+`
Coment\xE1rios`)("template",Te)("editTemplate",Te),l(3),r("onEdit",t.edit.bind(t))("dynamicButtons",t.dynamicButtons.bind(t))("dynamicOptions",t.dynamicOptions.bind(t))}},dependencies:[ue,F,A,k,j,Be,re,qe,le,B,de,he,Ge,St,De],styles:[".objetivo[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;padding:2px 0}"]});let a=o;return a})();var Ui=()=>["CONCLUIDO","AVALIADO"];function Mi(a,o){if(a&1){let n=N();c(0,"input-switch",29),D("change",function(i){P(n);let t=p(2);return O(t.onPrincipaisChange(i))}),d()}if(a&2){let n=p(2);r("size",2)("control",n.filter.controls.principais)("labelInfo",n.lex.translate("Unidades")+" onde o "+n.lex.translate("usuario")+" \xE9 integrante, incluindo unidades superiores sob sua ger\xEAncia.")}}function Gi(a,o){if(a&1){let n=N();c(0,"toolbar",26)(1,"input-switch",27),D("change",function(i){P(n);let t=p();return O(t.onAgruparChange(i))}),d(),u(2,Mi,1,3,"input-switch",28),d()}if(a&2){let n=p();r("buttons",n.toolbarButtons),l(),r("size",3)("control",n.filter.controls.agrupar),l(),r("ngIf",!n.avaliacao)}}function Qi(a,o){if(a&1&&(c(0,"div")(1,"div",30),m(2,"input-switch",31)(3,"input-search",32,10)(5,"input-select",33)(6,"input-datetime",34)(7,"input-datetime",35),d()()),a&2){let n=p();l(2),r("size",1)("control",n.filter.controls.meus_planos),l(),r("size",5)("control",n.filter.controls.unidade_id)("dao",n.unidadeDao),l(2),r("size",2)("valueTodos",null)("control",n.filter.controls.data_filtro)("items",n.DATAS_FILTRO),l(),r("size",2)("disabled",n.filter.controls.data_filtro.value==null?"true":void 0)("control",n.filter.controls.data_filtro_inicio),l(),r("size",2)("disabled",n.filter.controls.data_filtro.value==null?"true":void 0)("control",n.filter.controls.data_filtro_fim)}}function Hi(a,o){if(a&1&&(c(0,"div",30),m(1,"input-switch",31)(2,"input-text",36)(3,"input-search",32,10)(5,"input-select",37)(6,"input-switch",38),d(),c(7,"div",30),m(8,"input-search",39,11)(10,"input-search",40,12)(12,"input-select",33)(13,"input-datetime",34)(14,"input-datetime",35),d()),a&2){let n=p();l(),r("size",1)("control",n.filter.controls.meus_planos),l(),r("size",3)("control",n.filter.controls.nome)("placeholder","Nome do "+n.lex.translate("plano de entrega")),K("maxlength",250),l(),r("size",4)("control",n.filter.controls.unidade_id)("dao",n.unidadeDao),l(2),r("size",3)("control",n.filter.controls.status)("items",n.lookup.PLANO_ENTREGA_STATUS)("filter",n.avaliacao?X(32,Ui):void 0)("valueTodos",null),l(),r("size",1)("control",n.filter.controls.arquivadas),l(2),r("size",3)("control",n.filter.controls.planejamento_id)("dao",n.planejamentoDao),l(2),r("size",3)("control",n.filter.controls.cadeia_valor_id)("dao",n.cadeiaValorDao),l(2),r("size",2)("valueTodos",null)("control",n.filter.controls.data_filtro)("items",n.DATAS_FILTRO),l(),r("size",2)("disabled",n.filter.controls.data_filtro.value==null?"true":void 0)("control",n.filter.controls.data_filtro_inicio),l(),r("size",2)("disabled",n.filter.controls.data_filtro.value==null?"true":void 0)("control",n.filter.controls.data_filtro_fim)}}function Wi(a,o){if(a&1&&(c(0,"span",43),m(1,"i",44),g(2),d()),a&2){let n=p().row;l(2),z(" ",n.entregas==null?null:n.entregas.length,"")}}function $i(a,o){if(a&1&&u(0,Wi,3,1,"span",42),a&2){let n=o.row;r("ngIf",n.entregas==null?null:n.entregas.length)}}function Xi(a,o){if(a&1&&m(0,"plano-entrega-list-entrega",45),a&2){let n=o.row,e=p(2);r("parent",e)("disabled",e.avaliacao||!e.botaoAtendeCondicoes(e.BOTAO_ALTERAR,n))("entity",n)("execucao",e.execucao)("cdRef",e.cdRef)("planejamentoId",n.planejamento_id)("cadeiaValorId",n.cadeia_valor_id)("unidadeId",n.unidade_id)}}function Ji(a,o){if(a&1&&(c(0,"column",41),u(1,$i,1,1,"ng-template",null,13,f)(3,Xi,1,8,"ng-template",null,14,f),d()),a&2){let n=_(2),e=_(4),i=p();r("align","center")("hint",i.lex.translate("Entrega"))("template",n)("expandTemplate",e)}}function Zi(a,o){if(a&1&&(c(0,"order",46),g(1,"#ID"),d()),a&2){let n=o.header;r("header",n)}}function Ki(a,o){if(a&1&&(c(0,"small",47),g(1),d()),a&2){let n=o.row;l(),z("#",n.numero,"")}}function Yi(a,o){if(a&1&&(c(0,"order",48),g(1,"Nome"),d(),m(2,"br"),g(3)),a&2){let n=o.header,e=p();r("header",n),l(3),z(" Programa",e.filter.controls.agrupar.value?"":" - Unidade"," ")}}function ea(a,o){if(a&1&&m(0,"badge",52),a&2){let n=p().row,e=p();r("icon",e.entityService.getIcon("Programa"))("label",n.programa.nome)}}function ta(a,o){if(a&1&&m(0,"badge",53),a&2){let n=p().row,e=p();r("icon",e.entityService.getIcon(e.lex.translate("unidade")))("label",n.unidade.sigla)}}function ia(a,o){if(a&1&&(c(0,"span",49),g(1),d(),m(2,"br"),u(3,ea,1,2,"badge",50)(4,ta,1,2,"badge",51)),a&2){let n=o.row,e=p();ht("max-width",400,"px"),l(),T(n.nome||""),l(2),r("ngIf",n.programa),l(),r("ngIf",!e.filter.controls.agrupar.value&&n.unidade)}}function aa(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=o.row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_inicio),"")}}function na(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=o.row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_fim),"")}}function oa(a,o){a&1&&(g(0," Planejamento Institucional"),m(1,"br"),g(2," Cadeia de Valor "))}function ra(a,o){if(a&1&&m(0,"badge",55),a&2){let n=p().row,e=p();r("maxWidth",300)("icon",e.entityService.getIcon("Planejamento"))("label",n.planejamento==null?null:n.planejamento.nome)}}function la(a,o){if(a&1&&m(0,"badge",55),a&2){let n=p().row,e=p();r("maxWidth",300)("icon",e.entityService.getIcon("CadeiaValor"))("label",n.cadeia_valor==null?null:n.cadeia_valor.nome)}}function sa(a,o){if(a&1&&u(0,ra,1,3,"badge",54)(1,la,1,3,"badge",54),a&2){let n=o.row;r("ngIf",n.planejamento),l(),r("ngIf",n.cadeia_valor)}}function da(a,o){a&1&&m(0,"badge",60)}function ca(a,o){a&1&&m(0,"badge",61)}function ma(a,o){if(a&1&&m(0,"avaliar-nota-badge",62),a&2){let n=p().row;r("align","left")("tipoAvaliacao",n.avaliacao.tipo_avaliacao)("nota",n.avaliacao.nota)}}function pa(a,o){if(a&1&&(m(0,"badge",56)(1,"br"),u(2,da,1,0,"badge",57)(3,ca,1,0,"badge",58)(4,ma,1,3,"avaliar-nota-badge",59)),a&2){let n=o.row,e=p();r("color",e.lookup.getColor(e.lookup.PLANO_ENTREGA_STATUS,n.status))("icon",e.lookup.getIcon(e.lookup.PLANO_ENTREGA_STATUS,n.status))("label",e.lookup.getValue(e.lookup.PLANO_ENTREGA_STATUS,n.status)),l(2),r("ngIf",n.data_arquivamento),l(),r("ngIf",n.deleted_at),l(),r("ngIf",n.avaliacao)}}var Gt=(()=>{let o=class o extends se{constructor(e){super(e,ee,Y),this.injector=e,this.showFilter=!0,this.avaliacao=!1,this.execucao=!1,this.habilitarAdesaoToolbar=!1,this.toolbarButtons=[],this.botoes=[],this.routeStatus={route:["uteis","status"]},this.DATAS_FILTRO=[{key:"VIGENTE",value:"Vigente"},{key:"NAOVIGENTE",value:"N\xE3o vigente"},{key:"INICIAM",value:"Iniciam"},{key:"FINALIZAM",value:"Finalizam"}],this.storeFilter=i=>{let t=i?.value;return{meus_planos:t.meus_planos,arquivadas:t.arquivadas,unidade_id:t.unidade_id}},this.filterValidate=(i,t)=>{let s=null;return t=="data_filtro_inicio"&&i.value>this.filter?.controls.data_filtro_fim.value?s="Maior que fim":t=="data_filtro_fim"&&i.value<this.filter?.controls.data_filtro_inicio.value&&(s="Menor que in\xEDcio"),s},this.filterWhere=i=>{let t=[],s=i.value;if(this.filter?.controls.principais.value){console.log("princi");let h=["unidade_id","in",(this.auth.unidades||[]).map(E=>E.id)];if(this.auth.isGestorAlgumaAreaTrabalho()){let E=this.auth.unidades?.filter(V=>this.unidadeService.isGestorUnidade(V)),b=E?.map(V=>V.unidade_pai?.id||"").filter(V=>V.length);b?.length&&h[2].push(...b);let w=["unidade.unidade_pai_id","in",E?.map(V=>V.id)];t.push(["or",h,w])}else t.push(h)}if(this.filter?.controls.meus_planos.value){let h=["unidade_id","in",(this.auth.unidades||[]).map(E=>E.id)];t.push(h)}return s.nome?.length&&t.push(["nome","like","%"+s.nome.trim().replace(" ","%")+"%"]),s.data_filtro&&(t.push(["data_filtro","==",s.data_filtro]),t.push(["data_filtro_inicio","==",s.data_filtro_inicio]),t.push(["data_filtro_fim","==",s.data_filtro_fim])),s.unidade_id&&t.push(["unidade_id","==",s.unidade_id]),s.unidade_id||t.push(["unidades_vinculadas","==",this.auth.unidade?.id]),s.planejamento_id&&t.push(["planejamento_id","==",s.planejamento_id]),s.cadeia_valor_id&&t.push(["cadeia_valor_id","==",s.cadeia_valor_id]),this.isModal?t.push(["status","==","ATIVO"]):(s.status||this.avaliacao)&&t.push(["status","in",s.status?[s.status]:["CONCLUIDO","AVALIADO"]]),t.push(["incluir_arquivados","==",this.filter.controls.arquivadas.value]),t},this.avaliacaoDao=e.get(wt),this.unidadeDao=e.get(J),this.planejamentoDao=e.get(me),this.cadeiaValorDao=e.get(ge),this.planoEntregaService=e.get($),this.unidadeService=e.get(It),this.unidadeSelecionada=this.auth.unidade,this.code="MOD_PLANE",this.title=this.lex.translate("Planos de Entregas"),this.filter=this.fh.FormBuilder({agrupar:{default:!0},principais:{default:!1},arquivadas:{default:!1},nome:{default:""},data_filtro:{default:null},data_filtro_inicio:{default:new Date},data_filtro_fim:{default:new Date},status:{default:""},unidade_id:{default:null},unidades_filhas:{default:!1},planejamento_id:{default:null},cadeia_valor_id:{default:null},meus_planos:{default:!0}},this.cdRef,this.filterValidate),this.join=["planejamento:id,nome","programa:id,nome","cadeia_valor:id,nome","unidade:id,sigla,path","entregas.entrega","entregas.objetivos.objetivo","entregas.processos.processo","entregas.unidade","entregas.comentarios.usuario:id,nome,apelido","entregas.reacoes.usuario:id,nome,apelido","unidade.gestor:id","unidade.gestores_substitutos:id","unidade.unidade_pai","avaliacao"],this.groupBy=[{field:"unidade.sigla",label:"Unidade"}],this.BOTAO_ADERIR_OPTION={label:"Aderir",icon:this.entityService.getIcon("Adesao"),onClick:(()=>{this.go.navigate({route:["gestao","plano-entrega","adesao"]},{metadata:{planoEntrega:this.linha},modalClose:i=>{this.refresh()}})}).bind(this)},this.BOTAO_ADERIR_TOOLBAR={label:"Aderir",disabled:!this.habilitarAdesaoToolbar,icon:this.entityService.getIcon("Adesao"),onClick:(()=>{this.go.navigate({route:["gestao","plano-entrega","adesao"]},{modalClose:i=>{this.refresh()}})}).bind(this)},this.BOTAO_ALTERAR={label:"Alterar",icon:"bi bi-pencil-square",color:"btn-outline-info",onClick:i=>this.go.navigate({route:["gestao","plano-entrega",i.id,"edit"]},this.modalRefreshId(i))},this.BOTAO_ARQUIVAR={label:"Arquivar",icon:"bi bi-inboxes",onClick:this.arquivar.bind(this)},this.BOTAO_AVALIAR={label:"Avaliar",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"AVALIADO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"AVALIADO"),onClick:this.avaliar.bind(this)},this.BOTAO_CANCELAR_PLANO={label:"Cancelar plano",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"CANCELADO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"CANCELADO"),onClick:this.cancelarPlano.bind(this)},this.BOTAO_CANCELAR_AVALIACAO={label:"Cancelar avalia\xE7\xE3o",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"CONCLUIDO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"CANCELADO"),onClick:this.cancelarAvaliacao.bind(this)},this.BOTAO_CANCELAR_CONCLUSAO={label:"Cancelar conclus\xE3o",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"ATIVO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"ATIVO"),onClick:this.cancelarConclusao.bind(this)},this.BOTAO_CANCELAR_HOMOLOGACAO={label:"Cancelar homologa\xE7\xE3o",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"HOMOLOGANDO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"HOMOLOGANDO"),onClick:this.cancelarHomologacao.bind(this)},this.BOTAO_CONCLUIR={label:"Concluir",id:"CONCLUIDO",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"CONCLUIDO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"CONCLUIDO"),onClick:this.concluir.bind(this)},this.BOTAO_CONSULTAR={label:"Informa\xE7\xF5es",icon:"bi bi-info-circle",onClick:i=>this.go.navigate({route:["gestao","plano-entrega",i.id,"consult"]},{modal:!0})},this.BOTAO_DESARQUIVAR={label:"Desarquivar",icon:"bi bi-reply",onClick:this.desarquivar.bind(this)},this.BOTAO_EXCLUIR={label:"Excluir",icon:"bi bi-trash",onClick:this.delete.bind(this)},this.BOTAO_HOMOLOGAR={label:"Homologar",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"ATIVO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"ATIVO"),onClick:this.homologar.bind(this)},this.BOTAO_LIBERAR_HOMOLOGACAO={label:"Liberar para homologa\xE7\xE3o",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"HOMOLOGANDO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"HOMOLOGANDO"),onClick:this.liberarHomologacao.bind(this)},this.BOTAO_LOGS={label:"Logs",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"INCLUIDO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"INCLUIDO"),onClick:i=>this.go.navigate({route:["logs","change",i.id,"consult"]})},this.BOTAO_REATIVAR={label:"Reativar",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"ATIVO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"ATIVO"),onClick:this.reativar.bind(this)},this.BOTAO_RETIRAR_HOMOLOGACAO={label:"Retirar de homologa\xE7\xE3o",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"INCLUIDO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"INCLUIDO"),onClick:this.retirarHomologacao.bind(this)},this.BOTAO_SUSPENDER={label:"Suspender",id:"PAUSADO",icon:this.lookup.getIcon(this.lookup.PLANO_ENTREGA_STATUS,"SUSPENSO"),color:this.lookup.getColor(this.lookup.PLANO_ENTREGA_STATUS,"SUSPENSO"),onClick:this.suspender.bind(this)},this.botoes=[this.BOTAO_ALTERAR,this.BOTAO_ARQUIVAR,this.BOTAO_AVALIAR,this.BOTAO_CANCELAR_PLANO,this.BOTAO_CANCELAR_AVALIACAO,this.BOTAO_CANCELAR_CONCLUSAO,this.BOTAO_CANCELAR_HOMOLOGACAO,this.BOTAO_CONCLUIR,this.BOTAO_CONSULTAR,this.BOTAO_DESARQUIVAR,this.BOTAO_EXCLUIR,this.BOTAO_HOMOLOGAR,this.BOTAO_LIBERAR_HOMOLOGACAO,this.BOTAO_LOGS,this.BOTAO_REATIVAR,this.BOTAO_RETIRAR_HOMOLOGACAO,this.BOTAO_SUSPENDER]}ngOnInit(){super.ngOnInit(),this.execucao=!!this.queryParams?.execucao,this.avaliacao=!!this.queryParams?.avaliacao,this.showFilter=typeof this.queryParams?.showFilter<"u"?this.queryParams.showFilter=="true":!0,this.selectable=this.metadata?.selectable||this.selectable,this.execucao&&(this.title=this.title+" (Execu\xE7\xE3o)",this.filter.controls.unidade_id.setValue(this.auth.unidadeGestor()?.id||null),this.filter.controls.principais.setValue(!1)),this.avaliacao&&(this.title=this.title+" (Avalia\xE7\xE3o)",this.filter.controls.unidade_id.setValue(this.auth.unidadeGestor()?.id||null),this.filter.controls.unidades_filhas.setValue(!0),this.filter.controls.principais.setValue(!1)),this.checaBotaoAderirToolbar()}ngAfterContentChecked(){this.auth.unidade!=this.unidadeSelecionada&&(this.unidadeSelecionada=this.auth.unidade,this.checaBotaoAderirToolbar(),this.cdRef.detectChanges())}onGridLoad(e){let i=(this.grid?.query||this.query).extra;e&&this.execucao&&e.forEach(t=>{["ATIVO","SUSPENSO"].includes(t.status)&&this.grid.expand(t.id)}),e?.forEach(t=>{let s=t;s.avaliacao&&(s.avaliacao.tipo_avaliacao=i?.tipos_avaliacoes?.find(h=>h.id==s.avaliacao.tipo_avaliacao_id))})}checaBotaoAderirToolbar(){}planosEntregasAtivosUnidadePai(){return this.auth.unidade?.unidade_pai?.planos_entrega?.filter(e=>this.planoEntregaService.isAtivo(e))||[]}planosEntregasAtivosUnidadeSelecionada(){return this.auth?.unidade?.planos_entrega?.filter(e=>this.planoEntregaService.isAtivo(e))||[]}filterClear(e){e.controls.nome.setValue(""),e.controls.data_filtro.setValue(null),e.controls.data_filtro_inicio.setValue(new Date),e.controls.data_filtro_fim.setValue(new Date),e.controls.unidade_id.setValue(null),e.controls.planejamento_id.setValue(null),e.controls.cadeia_valor_id.setValue(null),e.controls.status.setValue(null),e.controls.meus_planos.setValue(!1),super.filterClear(e)}onAgruparChange(e){let i=this.filter.controls.agrupar.value;(i&&!this.groupBy?.length||!i&&this.groupBy?.length)&&(this.groupBy=i?[{field:"unidade.sigla",label:"Unidade"}]:[],this.cdRef.detectChanges(),this.grid.reloadFilter())}onPrincipaisChange(e){this.filter.controls.principais.value?(this.filter.controls.unidade_id.setValue(null),this.filter.controls.meus_planos.setValue(!1)):this.filter.controls.meus_planos.setValue(!0),this.grid.reloadFilter()}dynamicButtons(e){let i=[],t=e;switch(this.planoEntregaService.situacaoPlano(t)){case"INCLUIDO":this.botaoAtendeCondicoes(this.BOTAO_LIBERAR_HOMOLOGACAO,e)?i.push(this.BOTAO_LIBERAR_HOMOLOGACAO):i.push(this.BOTAO_CONSULTAR);break;case"HOMOLOGANDO":this.botaoAtendeCondicoes(this.BOTAO_HOMOLOGAR,e)&&i.push(this.BOTAO_HOMOLOGAR);break;case"ATIVO":this.botaoAtendeCondicoes(this.BOTAO_CONCLUIR,e)&&i.push(this.BOTAO_CONCLUIR);break;case"CONCLUIDO":this.botaoAtendeCondicoes(this.BOTAO_AVALIAR,e)&&i.push(this.BOTAO_AVALIAR);break;case"SUSPENSO":this.botaoAtendeCondicoes(this.BOTAO_REATIVAR,e)&&i.push(this.BOTAO_REATIVAR);break;case"AVALIADO":this.botaoAtendeCondicoes(this.BOTAO_ARQUIVAR,e)&&i.push(this.BOTAO_ARQUIVAR);break;case"ARQUIVADO":this.botaoAtendeCondicoes(this.BOTAO_DESARQUIVAR,e)&&i.push(this.BOTAO_DESARQUIVAR);break;case"CANCELADO":break}return i.length||i.push(this.BOTAO_CONSULTAR),i}dynamicOptions(e){let i=[];return this.linha=e,this.botoes.forEach(t=>{this.botaoAtendeCondicoes(t,e)&&i.push(t)}),i}botaoAtendeCondicoes(e,i){switch(e){case this.BOTAO_ADERIR_OPTION:return!this.execucao&&this.planoEntregaService.situacaoPlano(i)=="ATIVO"&&i.unidade_id==this.auth.unidade?.unidade_pai_id&&(this.unidadeService.isGestorUnidade()||this.auth.isLotacaoUsuario(this.auth.unidade)&&this.auth.hasPermissionTo("MOD_PENT_ADR"))&&this.planosEntregasAtivosUnidadeSelecionada().filter(pt=>this.util.intersection([{start:pt.data_inicio,end:pt.data_fim},{start:i.data_inicio,end:i.data_fim}])).length==0;case this.BOTAO_ALTERAR:let t=["INCLUIDO","HOMOLOGANDO","ATIVO"].includes(this.planoEntregaService.situacaoPlano(i)),s=["INCLUIDO","HOMOLOGANDO"].includes(this.planoEntregaService.situacaoPlano(i))&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)),h=this.unidadeService.isGestorUnidade(i.unidade?.unidade_pai_id)&&this.auth.hasPermissionTo("MOD_PENT_EDT_FLH"),E=this.auth.isIntegrante("HOMOLOGADOR_PLANO_ENTREGA",i.unidade.unidade_pai_id),b=this.planoEntregaService.situacaoPlano(i)=="ATIVO"&&this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo(["MOD_PENT_EDT_ATV_HOMOL","MOD_PENT_EDT_ATV_ATV"]),w=this.auth.hasPermissionTo("MOD_PENT_QQR_UND");return!this.execucao&&this.auth.hasPermissionTo("MOD_PENT_EDT")&&t&&this.planoEntregaService.isValido(i)&&(s||h||E||b||w);case this.BOTAO_ARQUIVAR:return["CONCLUIDO","AVALIADO"].includes(this.planoEntregaService.situacaoPlano(i))&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_ARQ"));case this.BOTAO_AVALIAR:let V=this.unidadeService.isGestorUnidade(i.unidade?.unidade_pai_id),ye=this.auth.isIntegrante("AVALIADOR_PLANO_ENTREGA",i.unidade.id),Te=this.auth.isLotacaoUsuario(i.unidade?.unidade_pai)&&this.auth.hasPermissionTo("MOD_PENT_AVAL"),tt=this.auth.isGestorLinhaAscendente(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_AVAL_SUBORD");return this.planoEntregaService.situacaoPlano(i)=="CONCLUIDO"&&(V||ye||Te||tt);case this.BOTAO_CANCELAR_AVALIACAO:return this.planoEntregaService.situacaoPlano(i)=="AVALIADO"&&(this.unidadeService.isGestorUnidade(i.unidade?.unidade_pai_id)||this.auth.isIntegrante("AVALIADOR_PLANO_ENTREGA",i.unidade.id));case this.BOTAO_CANCELAR_CONCLUSAO:return this.planoEntregaService.situacaoPlano(i)=="CONCLUIDO"&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_CANC_CONCL"));case this.BOTAO_CANCELAR_HOMOLOGACAO:return!this.execucao&&this.planoEntregaService.situacaoPlano(i)=="ATIVO"&&(this.unidadeService.isGestorUnidade(i.unidade?.unidade_pai_id)||this.auth.isLotacaoUsuario(i.unidade?.unidade_pai)&&this.auth.hasPermissionTo("MOD_PENT_CANC_HOMOL")||this.auth.isIntegrante("HOMOLOGADOR_PLANO_ENTREGA",i.unidade.unidade_pai_id));case this.BOTAO_CANCELAR_PLANO:return this.auth.hasPermissionTo("MOD_PENT_CNC")&&["INCLUIDO","HOMOLOGANDO","ATIVO"].includes(this.planoEntregaService.situacaoPlano(i))&&(this.unidadeService.isGestorUnidade(i.unidade?.id)||this.unidadeService.isGestorUnidade(i.unidade?.unidade_pai_id));case this.BOTAO_CONCLUIR:return this.planoEntregaService.situacaoPlano(i)=="ATIVO"&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_CONC"));case this.BOTAO_CONSULTAR:return this.auth.hasPermissionTo("MOD_PENT");case this.BOTAO_DESARQUIVAR:return this.planoEntregaService.situacaoPlano(i)=="ARQUIVADO"&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_ARQ"));case this.BOTAO_EXCLUIR:return!this.execucao&&this.auth.hasPermissionTo("MOD_PENT_EXCL")&&["INCLUIDO","HOMOLOGANDO"].includes(this.planoEntregaService.situacaoPlano(i))&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade));case this.BOTAO_HOMOLOGAR:let it=this.planoEntregaService.situacaoPlano(i)=="HOMOLOGANDO",ai=this.unidadeService.isGestorUnidade(i.unidade?.unidade_pai_id),ni=this.auth.isLotacaoUsuario(i.unidade.unidade_pai)&&this.auth.hasPermissionTo("MOD_PENT_HOMOL"),oi=this.auth.isIntegrante("HOMOLOGADOR_PLANO_ENTREGA",i.unidade.unidade_pai_id);return!this.execucao&&it&&(ai||ni||oi);case this.BOTAO_LIBERAR_HOMOLOGACAO:return!this.execucao&&this.planoEntregaService.situacaoPlano(i)=="INCLUIDO"&&i.entregas.length>0&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_LIB_HOMOL"));case this.BOTAO_LOGS:return this.unidadeService.isGestorUnidade(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_AVAL_SUBORD");case this.BOTAO_REATIVAR:return this.planoEntregaService.situacaoPlano(i)=="SUSPENSO"&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_RTV")||this.auth.isGestorLinhaAscendente(i.unidade));case this.BOTAO_RETIRAR_HOMOLOGACAO:return!this.execucao&&this.planoEntregaService.situacaoPlano(i)=="HOMOLOGANDO"&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_RET_HOMOL"));case this.BOTAO_SUSPENDER:return this.planoEntregaService.situacaoPlano(i)=="ATIVO"&&(this.unidadeService.isGestorUnidade(i.unidade)||this.auth.isLotacaoUsuario(i.unidade)&&this.auth.hasPermissionTo("MOD_PENT_SUSP")||this.auth.isGestorLinhaAscendente(i.unidade))}return!1}arquivar(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:Object.assign({},e,{arquivar:!0}),novoStatus:e.status,onClick:this.dao.arquivar.bind(this.dao)},title:"Arquivar Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}avaliar(e){this.go.navigate({route:["gestao","plano-entrega",e.id,"avaliar"]},{modal:!0,metadata:{planoEntrega:e},modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id,["avaliacao.tipo_avaliacao.notas"]).then(()=>{this.checaBotaoAderirToolbar()})}})}cancelarAvaliacao(e){return v(this,null,function*(){this.submitting=!0;try{(yield this.avaliacaoDao.cancelarAvaliacao(e.avaliacao.id))&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}catch(i){this.error(i.message||i)}finally{this.submitting=!1}})}cancelarConclusao(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"ATIVO",onClick:this.dao.cancelarConclusao.bind(this.dao)},title:"Cancelar Conclus\xE3o",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}cancelarHomologacao(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"HOMOLOGANDO",onClick:this.dao.cancelarHomologacao.bind(this.dao)},title:"Cancelar Homologa\xE7\xE3o",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}cancelarPlano(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:Object.assign({},e,{arquivar:!0}),novoStatus:"CANCELADO",onClick:this.dao.cancelarPlano.bind(this.dao)},title:"Cancelar Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}concluir(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"CONCLUIDO",onClick:this.dao.concluir.bind(this.dao)},title:"Concluir Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}desarquivar(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:Object.assign({},e,{arquivar:!1}),novoStatus:e.status,onClick:this.dao.arquivar.bind(this.dao)},title:"Desarquivar Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}homologar(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"ATIVO",onClick:this.dao.homologar.bind(this.dao)},title:"Homologar Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}liberarHomologacao(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"HOMOLOGANDO",onClick:this.dao.liberarHomologacao.bind(this.dao)},title:"Liberar para Homologa\xE7\xE3o",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}reativar(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"ATIVO",onClick:this.dao.reativar.bind(this.dao)},title:"Reativar Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}retirarHomologacao(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"INCLUIDO",onClick:this.dao.retirarHomologacao.bind(this.dao)},title:"Retirar de Homologa\xE7\xE3o",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}suspender(e){this.go.navigate(this.routeStatus,{metadata:{tipo:"PlanoEntrega",entity:e,novoStatus:"SUSPENSO",onClick:this.dao.suspender.bind(this.dao)},title:"Suspender Plano de Entregas",modalClose:i=>{i&&(this.grid?.query||this.query).refreshId(e.id).then(()=>{this.checaBotaoAderirToolbar()})}})}canAdd(){return this.auth.hasPermissionTo("MOD_PENT_INCL")}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-list"]],viewQuery:function(i,t){if(i&1&&C(A,5),i&2){let s;y(s=I())&&(t.grid=s.first)}},features:[L],decls:34,vars:35,consts:[["naoEModal",""],["titleIdNumeroStatus",""],["columnNumero",""],["titleNomeProgramaUnidade",""],["columnNome",""],["columnInicio",""],["columnFim",""],["titlePlanoCadeia",""],["columnPlanoCadeia",""],["columnStatus",""],["unidade",""],["planejamento",""],["cadeiaValor",""],["columnEntregas",""],["columnExpandedEntregas",""],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","loadList"],[3,"buttons",4,"ngIf"],[3,"deleted","form","where","submit","clear","collapseChange","collapsed","visible"],[4,"ngIf","ngIfElse"],["type","expand","icon","bi bi-list-check",3,"align","hint","template","expandTemplate",4,"ngIf"],[3,"titleTemplate","template"],["title","In\xEDcio","orderBy","data_inicio",3,"template"],["title","Fim","orderBy","data_fim",3,"template"],[3,"title","template"],["type","options",3,"dynamicOptions","dynamicButtons"],[3,"rows"],[3,"buttons"],["labelPosition","left","label","Agrupar por unidade","controlName","agrupar",3,"change","size","control"],["labelPosition","left","label","Vinculados","controlName","principais",3,"size","control","labelInfo","change",4,"ngIf"],["labelPosition","left","label","Vinculados","controlName","principais",3,"change","size","control","labelInfo"],[1,"row"],["label","Meus","controlName","meus_planos","labelInfo","Planos de entrega das unidade da qual sou integrante (\xC1reas de trabalho)",3,"size","control"],["controlName","unidade_id",3,"size","control","dao"],["label","Data","itemTodos","- Nenhum -","controlName","data_filtro",3,"size","valueTodos","control","items"],["date","","label","In\xEDcio","controlName","data_filtro_inicio","labelInfo","Data in\xEDcio do per\xEDodo",3,"size","disabled","control"],["date","","label","Fim","controlName","data_filtro_fim","labelInfo","Data fim do per\xEDodo",3,"size","disabled","control"],["label","Nome","controlName","nome",3,"size","control","placeholder"],["label","Status","controlName","status","itemTodos","- Todos -",3,"size","control","items","filter","valueTodos"],["label","Arquivados","controlName","arquivadas","labelInfo","Listar tamb\xE9m os planos de entregas arquivados",3,"size","control"],["controlName","planejamento_id",3,"size","control","dao"],["controlName","cadeia_valor_id",3,"size","control","dao"],["type","expand","icon","bi bi-list-check",3,"align","hint","template","expandTemplate"],["class","badge rounded-pill bg-light text-dark",4,"ngIf"],[1,"badge","rounded-pill","bg-light","text-dark"],[1,"bi","bi-list-check"],[3,"parent","disabled","entity","execucao","cdRef","planejamentoId","cadeiaValorId","unidadeId"],["by","numero",3,"header"],[1,"micro-text","fw-ligh"],["by","nome",3,"header"],[1,"text-break","text-wrap"],["color","light",3,"icon","label",4,"ngIf"],["color","secondary",3,"icon","label",4,"ngIf"],["color","light",3,"icon","label"],["color","secondary",3,"icon","label"],["color","light",3,"maxWidth","icon","label",4,"ngIf"],["color","light",3,"maxWidth","icon","label"],[3,"color","icon","label"],["color","warning","icon","bi bi-inboxes","label","Arquivado",4,"ngIf"],["color","danger","icon","bi bi-trash3","label","Exclu\xEDdo",4,"ngIf"],[3,"align","tipoAvaliacao","nota",4,"ngIf"],["color","warning","icon","bi bi-inboxes","label","Arquivado"],["color","danger","icon","bi bi-trash3","label","Exclu\xEDdo"],[3,"align","tipoAvaliacao","nota"]],template:function(i,t){if(i&1){let s=N();c(0,"grid",15),D("select",function(E){return P(s),O(t.onSelect(E))}),u(1,Gi,3,4,"toolbar",16),c(2,"filter",17),u(3,Qi,8,15,"div",18)(4,Hi,15,33,"ng-template",null,0,f),d(),c(6,"columns"),u(7,Ji,5,4,"column",19),c(8,"column",20),u(9,Zi,2,1,"ng-template",null,1,f)(11,Ki,2,1,"ng-template",null,2,f),d(),c(13,"column",20),u(14,Yi,4,2,"ng-template",null,3,f)(16,ia,5,5,"ng-template",null,4,f),d(),c(18,"column",21),u(19,aa,2,1,"ng-template",null,5,f),d(),c(21,"column",22),u(22,na,2,1,"ng-template",null,6,f),d(),c(24,"column",20),u(25,oa,3,0,"ng-template",null,7,f)(27,sa,2,2,"ng-template",null,8,f),d(),c(29,"column",23),u(30,pa,5,6,"ng-template",null,9,f),d(),m(32,"column",24),d(),m(33,"pagination",25),d()}if(i&2){let s=_(5),h=_(10),E=_(12),b=_(15),w=_(17),V=_(20),ye=_(23),Te=_(26),tt=_(28),it=_(31);r("dao",t.dao)("add",t.add)("title",t.isModal?"":t.title)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("selectable",t.selectable)("hasAdd",t.canAdd())("hasEdit",!1)("loadList",t.onGridLoad.bind(t)),l(),r("ngIf",!t.selectable),l(),r("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("clear",t.filterClear.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed)("visible",t.showFilter),l(),r("ngIf",t.isModal)("ngIfElse",s),l(4),r("ngIf",!t.selectable),l(),r("titleTemplate",h)("template",E),l(5),r("titleTemplate",b)("template",w),l(5),r("template",V),l(3),r("template",ye),l(3),r("titleTemplate",Te)("template",tt),l(5),r("title",`Status
Avalia\xE7\xE3o`)("template",it),l(3),r("dynamicOptions",t.dynamicOptions.bind(t))("dynamicButtons",t.dynamicButtons.bind(t)),l(),r("rows",t.rowsLimit)}},dependencies:[F,A,k,j,ae,ie,ne,Be,Z,te,W,re,Ae,B,Rt,$e]});let a=o;return a})();var ua=["programa"],ga=["unidade"],ha=["nome"],_a=["data_fim"],Ye=(()=>{let o=class o extends _e{constructor(e){super(e,ee,Y),this.injector=e,this.validate=(i,t)=>{let s=null;return["nome","unidade_id","programa_id"].indexOf(t)>=0&&!i.value?.length&&(s="Obrigat\xF3rio"),["data_inicio"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value)&&(s="Inv\xE1lido"),["data_fim"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value)&&(s="Inv\xE1lido"),s},this.formValidation=i=>{let t=this.form?.controls.data_inicio.value,s=this.form?.controls.data_fim.value;if(this.programa?.selectedEntity)if(this.dao?.validDateTime(t))if(this.dao?.validDateTime(s)){if(t>s)return"A data do fim n\xE3o pode ser menor que a data do in\xEDcio!";{let E=this.form.controls.entregas.value||[];for(let b of E){if(!this.auth.hasPermissionTo("MOD_PENT_ENTR_EXTRPL")&&b.data_inicio<t)return"A "+this.lex.translate("entrega")+" '"+b.descricao+"' possui data inicial anterior \xE0 "+this.lex.translate("do Plano de Entrega")+": "+this.util.getDateFormatted(t);if(!this.auth.hasPermissionTo("MOD_PENT_ENTR_EXTRPL")&&b.data_fim>s)return"A "+this.lex.translate("entrega")+" '"+b.descricao+"' possui data fim posterior \xE0 "+this.lex.translate("do Plano de Entrega")+": "+this.util.getDateFormatted(s)}}}else return"Data de fim inv\xE1lida";else return"Data de in\xEDcio inv\xE1lida";else return"Obrigat\xF3rio selecionar o programa"},this.titleEdit=i=>"Editando "+this.lex.translate("Plano de Entregas")+": "+(i?.nome||""),this.unidadeDao=e.get(J),this.programaDao=e.get(Ne),this.cadeiaValorDao=e.get(ge),this.planoEntregaDao=e.get(Y),this.planejamentoInstitucionalDao=e.get(me),this.join=["entregas.entrega","entregas.objetivos.objetivo","entregas.processos.processo","entregas.unidade","unidade","entregas.reacoes.usuario:id,nome,apelido"],this.modalWidth=1200,this.form=this.fh.FormBuilder({nome:{default:""},data_inicio:{default:new Date},data_fim:{default:new Date},unidade_id:{default:""},plano_entrega_id:{default:null},planejamento_id:{default:null},cadeia_valor_id:{default:null},programa_id:{default:null},entregas:{default:[]}},this.cdRef,this.validate),this.programaMetadata={todosUnidadeExecutora:!0,vigentesUnidadeExecutora:!1}}loadData(e,i){return v(this,null,function*(){let t=Object.assign({},i.value);i.patchValue(this.util.fillForm(t,e)),this.cdRef.detectChanges()})}initializeData(e){return v(this,null,function*(){this.entity=new ee,this.entity.unidade_id=this.auth.unidade?.id||"",this.entity.unidade=this.auth.unidade;let i=yield this.programaDao.query({where:[["vigentesUnidadeExecutora","==",this.auth.unidade.id]]}).asPromise(),t=i[i.length-1];t&&(this.entity.programa=t,this.entity.programa_id=t.id);let s=new Date(this.entity.data_inicio).toLocaleDateString(),h=this.entity.data_fim?new Date(this.entity.data_fim).toLocaleDateString():new Date().toLocaleDateString();this.entity.nome=this.auth.unidade.sigla+" - "+s+" - "+h,this.loadData(this.entity,this.form)})}saveData(e){return v(this,null,function*(){return new Promise((i,t)=>{let s=this.util.fill(new ee,this.entity);s=this.util.fillForm(s,this.form.value),s.entregas=s.entregas?.filter(h=>h._status)||[],i(s)})})}dynamicButtons(e){return[]}onDataChange(){this.sugereNome()}onUnidadeChange(){return v(this,null,function*(){let e=this.form.controls.unidade_id.value,i=e||this.auth.unidade?.id;if(i)try{let t=yield this.planoEntregaDao.permissaoIncluir(i)}catch(t){this.error(t)}this.sugereNome()})}sugereNome(){let e=this.unidade?.selectedItem?this.unidade?.selectedItem?.entity.sigla:this.auth.unidade?.sigla,i=new Date(this.form.controls.data_inicio.value).toLocaleDateString(),t=this.form.controls.data_fim.value?" - "+new Date(this.form.controls.data_fim.value).toLocaleDateString():"";this.form.controls.nome.setValue(e+" - "+i+t)}somaDia(e,i){let t=new Date(e);return t.setDate(t.getDate()+i),t}onProgramaChange(){let e=this.programa?.selectedEntity?.prazo_max_plano_entrega,i=this.somaDia(this.entity.data_inicio,e);this.entity?.data_fim||(this.form.controls.data_fim.setValue(new Date(i)),this.dataFim?.change.emit())}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["app-plano-entrega-form"]],viewQuery:function(i,t){if(i&1&&(C(q,5),C(A,7),C(ua,7),C(ga,7),C(ha,7),C(_a,7)),i&2){let s;y(s=I())&&(t.editableForm=s.first),y(s=I())&&(t.grid=s.first),y(s=I())&&(t.programa=s.first),y(s=I())&&(t.unidade=s.first),y(s=I())&&(t.nomePE=s.first),y(s=I())&&(t.dataFim=s.first)}},features:[L],decls:20,vars:28,consts:[["unidade",""],["programa",""],["data_fim",""],["nome",""],["planejamento",""],["cadeiaValor",""],["entregas",""],["initialFocus","entregas",3,"submit","cancel","form","disabled","title"],[1,"row"],["controlName","unidade_id","required","",3,"change","size","disabled","dao"],["controlName","programa_id","required","",3,"change","size","disabled","dao","metadata"],["date","","label","In\xEDcio","controlName","data_inicio","required","",3,"change","size","labelInfo"],["date","","label","Fim","controlName","data_fim","required","",3,"change","size","labelInfo"],["label","Nome","controlName","nome","required","",3,"size"],["controlName","planejamento_id","label","Planejamento Institucional",3,"size","emptyValue","dao"],["controlName","cadeia_valor_id","label","Cadeia de Valor",3,"size","emptyValue","dao"],["title","Entregas"],["noPersist","",3,"disabled","control","planejamentoId","cadeiaValorId","unidadeId","dataFim"]],template:function(i,t){if(i&1){let s=N();c(0,"editable-form",7),D("submit",function(){return P(s),O(t.onSaveData())})("cancel",function(){return P(s),O(t.onCancel())}),c(1,"div")(2,"div",8)(3,"input-search",9,0),D("change",function(){return P(s),O(t.onUnidadeChange())}),d(),c(5,"input-search",10,1),D("change",function(){return P(s),O(t.onProgramaChange())}),d(),c(7,"input-datetime",11),D("change",function(){return P(s),O(t.onDataChange())}),d(),c(8,"input-datetime",12,2),D("change",function(){return P(s),O(t.onDataChange())}),d()(),c(10,"div",8),m(11,"input-text",13,3)(13,"input-search",14,4)(15,"input-search",15,5),d(),m(17,"separator",16)(18,"plano-entrega-list-entrega",17,6),d()()}i&2&&(r("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),l(3),r("size",4)("disabled",t.entity!=null&&t.entity.id?"disabled":void 0)("dao",t.unidadeDao),l(2),r("size",4)("disabled",t.entity!=null&&t.entity.id?"disabled":void 0)("dao",t.programaDao)("metadata",t.programaMetadata),l(2),r("size",2)("labelInfo","In\xEDcio "+t.lex.translate("Plano de Entrega")),l(),r("size",2)("labelInfo","Fim "+t.lex.translate("Plano de Entrega")),l(3),r("size",4),K("maxlength",250),l(2),r("size",4)("emptyValue",null)("dao",t.planejamentoInstitucionalDao),l(2),r("size",4)("emptyValue",null)("dao",t.cadeiaValorDao),l(3),r("disabled",t.formDisabled)("control",t.form.controls.entregas)("planejamentoId",t.form.controls.planejamento_id.value)("cadeiaValorId",t.form.controls.cadeia_valor_id.value)("unidadeId",t.form.controls.unidade_id.value)("dataFim",t.form.controls.data_fim.value))},dependencies:[q,Z,te,W,le,$e]});let a=o;return a})();var fa=["unidade"];function Ea(a,o){if(a&1&&m(0,"planejamento-show",18),a&2){let n=p(2);r("planejamento",n.objetivo.planejamento)}}function va(a,o){if(a&1&&(at(0),u(1,Ea,1,1,"planejamento-show",16),c(2,"div",17)(3,"h5"),g(4,"Objetivo:"),d(),c(5,"h6"),g(6),d()(),nt()),a&2){let n=p();l(),r("ngIf",n.objetivo.planejamento),l(5),T(n.objetivo.nome)}}function ba(a,o){if(a&1&&(c(0,"div",21)(1,"h6"),g(2,"Cadeia de valor:"),d(),c(3,"h4"),g(4),d()()),a&2){let n=p(2);l(4),T(n.processo.cadeia_valor.nome)}}function Ca(a,o){if(a&1&&(at(0),u(1,ba,5,1,"div",19),c(2,"div",20)(3,"h5"),g(4,"Processo:"),d(),c(5,"h6"),g(6),d()(),nt()),a&2){let n=p();l(),r("ngIf",n.processo.cadeia_valor),l(5),T(n.processo.nome)}}function ya(a,o){if(a&1&&m(0,"badge",25),a&2){let n=p().row,e=p();r("icon",e.entityService.getIcon("Unidade"))("label",n.plano_entrega.unidade.sigla)}}function Ia(a,o){if(a&1&&m(0,"badge",26),a&2){let n=p().row;r("label",n.destinatario)}}function Ta(a,o){if(a&1&&(g(0),m(1,"br"),c(2,"span",22),u(3,ya,1,2,"badge",23)(4,Ia,1,1,"badge",24),d()),a&2){let n=o.row;z(" ",n.descricao,""),l(3),r("ngIf",n.plano_entrega.unidade),l(),r("ngIf",n.destinatario==null?null:n.destinatario.length)}}function Pa(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_inicio),"")}}function Oa(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_fim),"")}}function Aa(a,o){if(a&1&&(u(0,Pa,2,1,"span",5),m(1,"br"),u(2,Oa,2,1,"span",5)),a&2){let n=o.row;r("ngIf",n.data_inicio),l(2),r("ngIf",n.data_fim)}}function Da(a,o){if(a&1&&m(0,"progress-bar",27),a&2){let n=o.row;r("value",n.progresso_realizado)("goal",n.progresso_esperado)}}var dt=(()=>{let o=class o extends se{constructor(e){super(e,pe,H),this.injector=e,this.filterWhere=i=>{let t=[],s=i.value;return this.objetivoId&&t.push(["objetivos.objetivo_id","==",this.objetivoId]),this.processoId&&t.push(["processos.processo_id","==",this.processoId]),s.unidade_id&&t.push(["plano_entrega.unidade_id","==",s.unidade_id]),s.entrega_id&&t.push(["entrega_id","==",s.entrega_id]),s.data_inicio&&t.push(["data_inicio",">=",s.data_inicio]),s.data_fim&&t.push(["data_fim","<=",s.data_fim]),t},this.unidadeDao=e.get(J),this.entregaDao=e.get(ze),this.entregaService=e.get($),this.objetivoDao=e.get(Fe),this.processoDao=e.get(je),this.join=["plano_entrega.unidade"],this.title=this.lex.translate("Entregas"),this.filter=this.fh.FormBuilder({unidade_id:{default:null},entrega_id:{default:null},data_inicio:{default:null},data_fim:{default:null}})}ngOnInit(){super.ngOnInit(),this.objetivoId=this.urlParams.get("objetivo_id")||void 0,this.processoId=this.urlParams.get("processo_id")||void 0,this.objetivoId&&this.objetivoDao?.getById(this.objetivoId,["planejamento"]).then(e=>{this.objetivo=e}),this.processoId&&this.processoDao?.getById(this.processoId,["cadeia_valor"]).then(e=>{this.processo=e})}filterClear(e){e.controls.unidade_id.setValue(null),e.controls.entrega_id.setValue(null),e.controls.data_inicio.setValue(null),e.controls.data_fim.setValue(null),super.filterClear(e)}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-mapa-entregas"]],viewQuery:function(i,t){if(i&1&&(C(A,5),C(fa,5)),i&2){let s;y(s=I())&&(t.grid=s.first),y(s=I())&&(t.unidade=s.first)}},features:[L],decls:23,vars:31,consts:[["unidade",""],["entrega",""],["columnEntregaCliente",""],["columnDatas",""],["columnProgresso",""],[4,"ngIf"],[3,"dao","title","orderBy","join"],[3,"deleted","form","where","submit","clear","collapseChange","collapsed"],[1,"row"],["controlName","unidade_id",3,"size","control","dao"],["controlName","entrega_id",3,"size","control","dao"],["date","","noIcon","","label","In\xEDcio","controlName","data_inicio","labelInfo","Data de in\xEDcio do planejamento institucional",3,"size","control"],["date","","noIcon","","label","Fim","controlName","data_fim","labelInfo","Data do fim do planejamento institucional",3,"size","control"],[3,"title","template"],[3,"title","width","template"],[3,"rows"],[3,"planejamento",4,"ngIf"],[1,"objetivos","arrow_box","w-100"],[3,"planejamento"],["class","planejamento arrow_box first-box w-100",4,"ngIf"],[1,"procesos","arrow_box","w-100"],[1,"planejamento","arrow_box","first-box","w-100"],[1,"d-block"],["color","light",3,"icon","label",4,"ngIf"],["color","light","icon","bi bi-mailbox",3,"label",4,"ngIf"],["color","light",3,"icon","label"],["color","light","icon","bi bi-mailbox",3,"label"],["color","success",3,"value","goal"]],template:function(i,t){if(i&1&&(u(0,va,7,2,"ng-container",5)(1,Ca,7,2,"ng-container",5),c(2,"grid",6),m(3,"toolbar"),c(4,"filter",7)(5,"div",8),m(6,"input-search",9,0)(8,"input-search",10,1)(10,"input-datetime",11)(11,"input-datetime",12),d()(),c(12,"columns")(13,"column",13),u(14,Ta,5,3,"ng-template",null,2,f),d(),c(16,"column",13),u(17,Aa,3,2,"ng-template",null,3,f),d(),c(19,"column",14),u(20,Da,1,2,"ng-template",null,4,f),d()(),m(22,"pagination",15),d()),i&2){let s=_(15),h=_(18),E=_(21);r("ngIf",t.objetivo),l(),r("ngIf",t.processo),l(),r("dao",t.dao)("title",t.isModal?"":t.title)("orderBy",t.orderBy)("join",t.join),l(2),r("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("clear",t.filterClear.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),l(2),r("size",4)("control",t.filter.controls.unidade_id)("dao",t.unidadeDao),l(2),r("size",4)("control",t.filter.controls.entrega_id)("dao",t.entregaDao),l(2),r("size",2)("control",t.filter.controls.data_inicio),l(),r("size",2)("control",t.filter.controls.data_fim),l(2),r("title",`Entrega
Demandante/Destinat\xE1rio`)("template",s),l(3),r("title",`Data In\xEDcio
Data Fim`)("template",h),l(3),r("title","Progresso")("width",200)("template",E),l(3),r("rows",t.rowsLimit)}},dependencies:[F,A,k,j,ae,ie,ne,Z,W,B,de,Vt]});let a=o;return a})();var xa=()=>["gestao","plano-entrega"],Sa=a=>({unidade_id:a,status:"ATIVO"}),wa=a=>({showFilter:!1,filter:a}),Ra=(a,o)=>({route:a,params:o}),La=a=>["unidade_id","=",a],Va=()=>["status","=","ATIVO"],Na=(a,o)=>[a,o],Qt=(()=>{let o=class o extends _e{constructor(e){super(e,ee,Y),this.injector=e,this.validate=(i,t)=>{let s=null;return["nome","plano_entrega_id"].indexOf(t)>=0&&!i.value?.length&&(s="Obrigat\xF3rio"),s},this.titleEdit=i=>"Editando "+this.lex.translate("Plano de Entregas")+": "+(i?.nome||""),this.unidadeDao=e.get(J),this.programaDao=e.get(Ne),this.planoEntregaDao=e.get(Y),this.cadeiaValorDao=e.get(ge),this.planejamentoInstitucionalDao=e.get(me),this.join=[],this.modalWidth=1e3,this.form=this.fh.FormBuilder({nome:{default:""},data_inicio:{default:""},data_fim:{default:""},planejamento_id:{default:null},cadeia_valor_id:{default:null},unidade_id:{default:this.auth.unidade?.id},plano_entrega_id:{default:null},programa_id:{default:null},status:{default:"HOMOLOGANDO"}},this.cdRef,this.validate)}ngOnInit(){super.ngOnInit();let e=this.metadata?.planoEntrega?this.metadata?.planoEntrega:null;e&&(this.form.controls.plano_entrega_id.setValue(e.id),this.form.controls.nome.setValue(e.nome),this.form.controls.data_inicio.setValue(e.data_inicio),this.form.controls.data_fim.setValue(e.data_fim),this.form.controls.planejamento_id.setValue(e.planejamento_id),this.form.controls.cadeia_valor_id.setValue(e.cadeia_valor_id))}loadData(e,i){return v(this,null,function*(){let t=Object.assign({},i.value);i.patchValue(this.util.fillForm(t,e)),this.cdRef.detectChanges()})}initializeData(e){return v(this,null,function*(){this.loadData(this.entity,this.form)})}saveData(e){return v(this,null,function*(){return new Promise((i,t)=>{let s=this.util.fill(new ee,this.entity);s=this.util.fillForm(s,this.form.value),i(s)})})}onPlanoEntregaChange(e){this.form.controls.plano_entrega_id.value&&(this.form.controls.nome.setValue(this.planoEntrega?.selectedEntity.nome),this.form.controls.data_inicio.setValue(this.planoEntrega?.selectedEntity.data_inicio),this.form.controls.data_fim.setValue(this.planoEntrega?.selectedEntity.data_fim),this.form.controls.planejamento_id.setValue(this.planoEntrega?.selectedEntity.planejamento_id),this.form.controls.cadeia_valor_id.setValue(this.planoEntrega?.selectedEntity.cadeia_valor_id),this.form.controls.programa_id.setValue(this.planoEntrega?.selectedEntity.programa_id))}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-adesao"]],viewQuery:function(i,t){if(i&1&&(C(q,5),C(A,7),C(Z,7)),i&2){let s;y(s=I())&&(t.editableForm=s.first),y(s=I())&&(t.grid=s.first),y(s=I())&&(t.planoEntrega=s.first)}},features:[L],decls:21,vars:39,consts:[["planoEntrega",""],["initialFocus","plano_entrega_id",3,"submit","cancel","form","disabled","title"],[1,"row","mb-4"],["controlName","plano_entrega_id","label","Plano de Entregas da Unidade-pai","required","",3,"change","size","dao","selectRoute","where"],[1,"row"],["label","Nome deste Plano de Entregas","controlName","nome","required","",3,"size"],["disabled","","controlName","unidade_id",3,"size","label","dao"],["disabled","","label","Status","controlName","status",3,"size"],[1,"row","mt-4"],["title","Dados herdados do Plano de Entregas da Unidade-pai",3,"collapse"],["disabled","","label","Programa de Gest\xE3o","controlName","programa_id",3,"size","dao"],["disabled","","label","Planejamento Institucional","controlName","planejamento_id",3,"size","dao"],["disabled","","controlName","data_inicio","label","In\xEDcio",3,"size","labelInfo"],["disabled","","label","Cadeia de Valor","controlName","cadeia_valor_id",3,"size","dao"],["disabled","","controlName","data_fim","label","Fim",3,"size","labelInfo"]],template:function(i,t){if(i&1){let s=N();c(0,"editable-form",1),D("submit",function(){return P(s),O(t.onSaveData())})("cancel",function(){return P(s),O(t.onCancel())}),c(1,"div")(2,"div",2)(3,"input-search",3,0),D("change",function(E){return P(s),O(t.onPlanoEntregaChange(E))}),d(),m(5,"separator"),d(),c(6,"div",4),m(7,"input-text",5),d(),c(8,"div",4),m(9,"input-search",6)(10,"input-text",7),d(),c(11,"div",8)(12,"separator",9)(13,"div",4),m(14,"input-search",10),d(),c(15,"div",4),m(16,"input-search",11)(17,"input-datetime",12),d(),c(18,"div",4),m(19,"input-search",13)(20,"input-datetime",14),d()()()()()}i&2&&(r("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),l(3),r("size",12)("dao",t.planoEntregaDao)("selectRoute",Oe(30,Ra,X(25,xa),Q(28,wa,Q(26,Sa,t.auth.unidade.unidade_pai_id))))("where",Oe(36,Na,Q(33,La,t.auth.unidade.unidade_pai_id),X(35,Va))),l(4),r("size",12),K("maxlength",250),l(2),r("size",9)("label",t.lex.translate("Unidade"))("dao",t.unidadeDao),l(),r("size",3),K("maxlength",250),l(2),r("collapse","collapse"),l(2),r("size",12)("dao",t.programaDao),l(2),r("size",9)("dao",t.planejamentoInstitucionalDao),l(),r("size",3)("labelInfo","In\xEDcio "+t.lex.translate("Plano de Entrega")),l(2),r("size",9)("dao",t.cadeiaValorDao),l(),r("size",3)("labelInfo","Fim "+t.lex.translate("Plano de Entrega")))},dependencies:[q,Z,te,W,le]});let a=o;return a})();var ja=["gridProcessos"],ka=["gridObjetivos"],qa=["entregas"],Ba=["planejamento"],Ua=["cadeiaValor"],Ma=["inputObjetivo"],Ga=["inputProcesso"],Qa=["entrega"],Ha=["unidade"],Wa=["tabs"],$a=["etiqueta"],Xa=a=>["plano_entrega.unidade_id","in",a],Ja=()=>["gestao","plano-entrega","entrega-list"],Za=a=>({route:a}),Ka=a=>({idsUnidadesAscendentes:a}),Ya=a=>["planejamento_id","==",a],Ht=a=>[a],en=()=>["gestao","planejamento","objetivoList"],tn=a=>({planejamento_id:a}),Wt=a=>({filter:a}),$t=(a,o)=>({route:a,params:o}),an=a=>["cadeia_valor_id","==",a],nn=()=>["gestao","cadeia-valor","processoList"],on=a=>({cadeia_valor_id:a});function rn(a,o){if(a&1&&(c(0,"div",20),m(1,"plano-entrega-valor-meta-input",41)(2,"input-number",42),c(3,"div",20),m(4,"plano-entrega-valor-meta-input",43)(5,"input-number",44),d()()),a&2){let n=p(),e=_(31);l(),r("entrega",e==null?null:e.selectedEntity)("size",6)("control",n.form.controls.meta),l(),r("size",6),l(2),r("entrega",e==null?null:e.selectedEntity)("size",6)("control",n.form.controls.realizado)("change",n.onRealizadoChange.bind(n)),l(),r("size",6)("stepValue",.01)}}function ln(a,o){a&1&&(c(0,"div",20),m(1,"input-number",42)(2,"input-number",44),d()),a&2&&(l(),r("size",6),l(),r("size",6)("stepValue",.01))}function sn(a,o){if(a&1&&(c(0,"order",49),g(1,"Objetivos"),d()),a&2){let n=o.header;r("header",n)}}function dn(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=o.row;l(),T(n.objetivo==null?null:n.objetivo.nome)}}function cn(a,o){if(a&1&&m(0,"input-search",50,10),a&2){let n=p(2);r("size",12)("where",Q(6,Ht,Q(4,Ya,n.planejamentoId)))("dao",n.planejamentoObjetivoDao)("selectRoute",Oe(13,$t,X(8,en),Q(11,Wt,Q(9,tn,n.planejamentoId))))}}function mn(a,o){if(a&1&&(c(0,"tab",45),m(1,"input-search",46,5),c(3,"grid",47,6)(5,"columns")(6,"column",48),u(7,sn,2,1,"ng-template",null,7,f)(9,dn,2,1,"ng-template",null,8,f)(11,cn,2,16,"ng-template",null,9,f),d(),m(13,"column",28),d()()()),a&2){let n=_(8),e=_(10),i=_(12),t=p();l(),r("size",12)("dao",t.planejamentoDao),l(2),r("control",t.form.controls.objetivos)("form",t.formObjetivos)("orderBy",t.orderBy)("hasDelete",!0)("hasEdit",!0)("add",t.addObjetivo.bind(t))("remove",t.removeObjetivo.bind(t))("save",t.saveObjetivo.bind(t)),l(3),r("titleTemplate",n)("template",e)("editTemplate",i)}}function pn(a,o){if(a&1&&(c(0,"order",54),g(1,"Processos"),d()),a&2){let n=o.header;r("header",n)}}function un(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=o.row;l(),T(n.processo==null?null:n.processo.nome)}}function gn(a,o){if(a&1&&m(0,"input-search",55,16),a&2){let n=p(2);r("size",12)("where",Q(6,Ht,Q(4,an,n.cadeiaValorId)))("dao",n.cadeiaValorProcessoDao)("selectRoute",Oe(13,$t,X(8,nn),Q(11,Wt,Q(9,on,n.cadeiaValorId))))}}function hn(a,o){if(a&1&&(c(0,"tab",51),m(1,"input-search",52,11),c(3,"grid",47,12)(5,"columns")(6,"column",48),u(7,pn,2,1,"ng-template",null,13,f)(9,un,2,1,"ng-template",null,14,f)(11,gn,2,16,"ng-template",null,15,f),d(),m(13,"column",53),d()()()),a&2){let n=_(8),e=_(10),i=_(12),t=p();l(),r("size",12)("dao",t.cadeiaValorDao),l(2),r("control",t.form.controls.processos)("form",t.formProcessos)("orderBy",t.orderBy)("hasDelete",!0)("hasEdit",!0)("add",t.addProcesso.bind(t))("remove",t.removeProcesso.bind(t))("save",t.saveProcesso.bind(t)),l(3),r("titleTemplate",n)("template",e)("editTemplate",i),l(7),r("dynamicButtons",t.dynamicButtonsProcessos.bind(t))}}var ct=(()=>{let o=class o extends _e{constructor(e){super(e,pe,H),this.injector=e,this.itensQualitativo=[],this.idsUnidadesAscendentes=[],this.checklist=[],this.etiquetas=[],this.etiquetasAscendentes=[],this.validate=(i,t)=>{let s=null;return["descricao","destinatario"].indexOf(t)>=0?i.value?.length?this.entrega.selectedEntity&&this.entrega.selectedEntity.descricao==i.value&&(s="\xC9 necess\xE1rio incrementar ou modificar a descri\xE7\xE3o da entrega"):s="Obrigat\xF3rio":["progresso_realizado","realizado"].indexOf(t)>=0&&!(i.value>=0||i.value?.length>0)||["progresso_esperado","meta"].indexOf(t)>=0&&!(i.value>0||i.value?.length>0)?s="Obrigat\xF3rio":["unidade_id"].indexOf(t)>=0&&!i.value?.length?s="A unidade demandante \xE9 obrigat\xF3ria":["entrega_id"].indexOf(t)>=0&&!i.value?.length?s="A entrega \xE9 obrigat\xF3ria":["data_inicio"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value)||["data_fim"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value)?s="Inv\xE1lido":["planejamento_objetivo_id"].indexOf(t)>=0?(i.value?.length||(s="O objetivo do planejamento \xE9 obrigat\xF3rio"),i.value?.length&&this.gridObjetivos?.items.filter(h=>h._status=="ADD").map(h=>h.planejamento_objetivo_id).includes(this.formObjetivos.controls.planejamento_objetivo_id.value)&&(s="Este objetivo est\xE1 em duplicidade!")):["cadeia_processo_id"].indexOf(t)>=0&&(i.value?.length||(s="O processo da cadeia de valor \xE9 obrigat\xF3rio"),i.value?.length&&this.gridProcessos?.items.map(h=>h.cadeia_processo_id).includes(this.formProcessos.controls.cadeia_processo_id.value)&&(s="Este processo est\xE1 em duplicidade!")),s},this.formValidation=i=>{let t=this.form?.controls.data_inicio.value,s=this.form?.controls.data_fim.value;if(this.gridObjetivos?.editing)return this.tabs.active="OBJETIVOS","Salve ou cancele o registro atual em edi\xE7\xE3o";if(this.gridProcessos?.editing)return this.tabs.active="PROCESSOS","Salve ou cancele o registro atual em edi\xE7\xE3o";if(this.dao?.validDateTime(t))if(this.dao?.validDateTime(s)){if(t>s)return"A data do fim n\xE3o pode ser anterior \xE0 data do in\xEDcio!";if(!this.auth.hasPermissionTo("MOD_PENT_ENTR_EXTRPL")&&this.planoEntrega&&t<this.planoEntrega.data_inicio)return"Data de inicio menor que a data de inicio "+this.lex.translate("do Plano de Entrega")+": "+this.util.getDateFormatted(this.planoEntrega.data_inicio);if(!this.auth.hasPermissionTo("MOD_PENT_ENTR_EXTRPL")&&this.planoEntrega&&this.planoEntrega.data_fim&&s>this.planoEntrega.data_fim)return"Data de fim maior que a data de fim "+this.lex.translate("do Plano de Entrega")+": "+this.util.getDateFormatted(this.planoEntrega.data_fim)}else return"Data de fim inv\xE1lida";else return"Data de in\xEDcio inv\xE1lida"},this.planejamentoDao=e.get(me),this.unidadeDao=e.get(J),this.entregaDao=e.get(ze),this.planoEntregaDao=e.get(Y),this.planejamentoInstitucionalDao=e.get(me),this.planoEntregaEntregaDao=e.get(H),this.cadeiaValorDao=e.get(ge),this.cadeiaValorProcessoDao=e.get(je),this.planejamentoObjetivoDao=e.get(Fe),this.planoEntregaService=e.get($),this.modalWidth=700,this.join=["entrega","objetivos.objetivo","processos.processo"],this.form=this.fh.FormBuilder({descricao:{default:""},descricao_entrega:{default:""},data_inicio:{default:new Date},data_fim:{default:new Date},meta:{default:100},descricao_meta:{default:""},realizado:{default:null},plano_entrega_id:{default:""},entrega_pai_id:{default:null},entrega_id:{default:null},progresso_esperado:{default:100},progresso_realizado:{default:null},unidade_id:{default:null},destinatario:{default:null},objetivos:{default:[]},processos:{default:[]},listaQualitativo:{default:[]},planejamento_id:{default:null},cadeia_valor_id:{default:null},objetivo_id:{default:null},objetivo:{default:null},checklist:{default:[]},etiquetas:{default:[]},etiqueta:{default:""}},this.cdRef,this.validate),this.formObjetivos=this.fh.FormBuilder({planejamento_objetivo_id:{default:null}},this.cdRef,this.validate),this.formProcessos=this.fh.FormBuilder({cadeia_processo_id:{default:null}},this.cdRef,this.validate),this.formChecklist=this.fh.FormBuilder({id:{default:""},texto:{default:""},checked:{default:!1}},this.cdRef)}ngOnInit(){super.ngOnInit();let e=null;this.planoEntrega=this.metadata?.plano_entrega,this.planejamentoId=this.metadata?.planejamento_id,this.cadeiaValorId=this.metadata?.cadeia_valor_id,this.unidadeId=this.metadata?.unidade_id,this.metadata?.data_fim&&(this.dataFim=this.metadata?.data_fim),this.entity=this.metadata?.entrega}loadData(e,i){return v(this,null,function*(){let t=Object.assign({},i.value);this.onEntregaChange(i.value);let w=e,{meta:s,realizado:h}=w,E=Pe(w,["meta","realizado"]);yield this.entrega?.loadSearch(e.entrega||t.entrega_id,!1),yield this.unidade?.loadSearch(this.unidadeId),yield this.planejamento?.loadSearch(this.planejamentoId),yield this.cadeiaValor?.loadSearch(this.cadeiaValorId);let b=this.unidadeId?.length?yield this.unidadeDao.getById(this.unidadeId):null;this.idsUnidadesAscendentes=b?.path?.split("/").slice(1)||[],b&&this.idsUnidadesAscendentes.push(b.id),i.patchValue(this.util.fillForm(t,E)),i.controls.meta.setValue(this.planoEntregaService.getValor(e.meta)),i.controls.realizado.setValue(this.planoEntregaService.getValor(e.realizado)),i.controls.objetivos.setValue(e.objetivos),i.controls.processos.setValue(e.processos),this.dataFim&&i.controls.data_fim.setValue(this.dataFim),yield this.loadEtiquetas()})}initializeData(e){return v(this,null,function*(){this.entity.unidade_id=this.auth.unidade.id,this.entity.unidade=this.auth.unidade,yield this.loadData(this.entity,e)})}onSaveEntrega(){return v(this,null,function*(){let e,i=!0;if(this.formValidation)try{e=yield this.formValidation(this.form)}catch(t){e=t}if(this.form.valid&&!e){if(this.action=="edit"){let t=(yield this.saveData(this.form.value)).modalResult,s=[];t._status="EDIT",this.loading=!0;try{s=yield this.planoEntregaDao.planosImpactadosPorAlteracaoEntrega(t)}finally{this.loading=!1}if(s.length){let h=s.map(E=>this.util.getDateFormatted(E.data_inicio)+" - "+this.util.getDateFormatted(E.data_fim)+" - "+E.unidade?.sigla+": "+E.usuario?.nome+`
`);i=yield this.dialog.confirm("Altera assim mesmo?",`Caso prossiga com essa modifica\xE7\xE3o os seguintes planos de trabalho ser\xE3o repactuados automaticamente:

`+h+`
Deseja prosseguir?`)}}i&&(yield this.onSaveData())}else this.form.markAllAsTouched(),e&&this.error(e)})}saveData(e){return new Promise((i,t)=>{let s=this.util.fill(new pe,this.entity);this.gridObjetivos?.confirm(),this.gridProcessos?.confirm();let w=this.form.value,{meta:h,realizado:E}=w,b=Pe(w,["meta","realizado"]);s=this.util.fillForm(s,b),s.unidade=this.unidade?.selectedEntity,s.entrega=this.entrega?.selectedEntity,s.meta=this.planoEntregaService.getEntregaValor(s.entrega,h),s.realizado=this.planoEntregaService.getEntregaValor(s.entrega,E),i(new Ct(s))})}onRealizadoChange(e,i){this.calculaRealizado()}calculaRealizado(){let e=this.form?.controls.meta.value,i=this.form?.controls.realizado.value;if(e&&i){let t=isNaN(i)?0:(i/e*100).toFixed(0)||0;this.form?.controls.progresso_realizado.setValue(t)}}dynamicOptionsObjetivos(e){let i=[],t=e;return i.push({label:"Excluir",icon:"bi bi-trash",color:"btn-outline-danger",onClick:s=>{this.removeObjetivo(s)}}),i}dynamicButtonsObjetivos(e){let i=[],t=e;return i}dynamicButtonsProcessos(e){let i=[],t=e;return i}addObjetivo(){return v(this,null,function*(){return{id:this.dao.generateUuid(),_status:"ADD"}})}removeObjetivo(e){return v(this,null,function*(){return(yield this.dialog.confirm("Exclui ?","Deseja realmente excluir?"))&&(e._status="DELETE"),!1})}saveObjetivo(e,i){return v(this,null,function*(){let t=i;if(e.controls.planejamento_objetivo_id.value.length&&this.inputObjetivo.selectedItem)return t.planejamento_objetivo_id=e.controls.planejamento_objetivo_id.value,t.objetivo=this.inputObjetivo.selectedItem.entity,t})}addProcesso(){return v(this,null,function*(){return{id:this.dao.generateUuid(),_status:"ADD"}})}removeProcesso(e){return v(this,null,function*(){return(yield this.dialog.confirm("Exclui ?","Deseja realmente excluir?"))&&(e._status="DELETE"),!1})}saveProcesso(e,i){return v(this,null,function*(){let t=i;if(e.controls.cadeia_processo_id.value.length&&this.inputProcesso.selectedItem)return t.cadeia_processo_id=e.controls.cadeia_processo_id.value,t.processo=this.inputProcesso.selectedItem.entity,t})}onEntregaChange(e){return v(this,null,function*(){if(this.entrega&&this.entrega.selectedItem){let i=this.entrega?.selectedEntity;switch(i.tipo_indicador){case"QUALITATIVO":this.itensQualitativo=i.lista_qualitativos||[],this.form?.controls.meta.setValue(this.itensQualitativo.length?this.itensQualitativo[0].key:null),this.form?.controls.realizado.setValue(this.itensQualitativo.length?this.itensQualitativo[0].key:null);break;case"VALOR":this.form?.controls.meta.setValue(""),this.form?.controls.realizado.setValue(0);break;case"QUANTIDADE":this.form?.controls.meta.setValue(""),this.form?.controls.realizado.setValue(0);break;case"PORCENTAGEM":this.form?.controls.meta.setValue(100),this.form?.controls.realizado.setValue(0);break;default:break}yield this.loadEtiquetas(),i.checklist&&this.loadChecklist(),this.calculaRealizado()}})}loadEtiquetas(){return v(this,null,function*(){if(!this.etiquetasAscendentes.filter(e=>e.data==this.unidade?.selectedEntity?.id).length){let e=yield this.carregaEtiquetasUnidadesAscendentes(this.unidade?.selectedEntity);this.etiquetasAscendentes.push(...e)}this.etiquetas=this.util.merge(this.entrega?.selectedEntity?.etiquetas,this.unidade?.selectedEntity?.etiquetas,(e,i)=>e.key==i.key),this.etiquetas=this.util.merge(this.etiquetas,this.auth.usuario.config?.etiquetas,(e,i)=>e.key==i.key),this.etiquetas=this.util.merge(this.etiquetas,this.etiquetasAscendentes.filter(e=>e.data==this.unidade?.selectedEntity?.id),(e,i)=>e.key==i.key)})}carregaEtiquetasUnidadesAscendentes(e){return v(this,null,function*(){let i=[];e=e||this.auth.unidade;let t=e.path.split("/");return(yield this.unidadeDao.query({where:[["id","in",t]]}).asPromise()).forEach(h=>{i=this.util.merge(i,h.etiquetas,(E,b)=>E.key==b.key)}),i.forEach(h=>h.data=e.id),i})}loadChecklist(){let i=(this.entrega?.selectedEntity).checklist.map(t=>({id:t.id,texto:t.texto,checked:!1}));this.checklist=i||[],this.form.controls.checklist.setValue(i)}addItemHandleEtiquetas(){let e;if(this.etiqueta&&this.etiqueta.selectedItem){let i=this.etiqueta.selectedItem,t=i.key?.length?i.key:this.util.textHash(i.value);this.util.validateLookupItem(this.form.controls.etiquetas.value,t)&&(e={key:t,value:i.value,color:i.color,icon:i.icon},this.form.controls.etiqueta.setValue(""))}return e}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-form-entrega"]],viewQuery:function(i,t){if(i&1&&(C(q,5),C(ja,5),C(ka,5),C(qa,5),C(Ba,5),C(Ua,5),C(Ma,5),C(Ga,5),C(Qa,5),C(Ha,5),C(Wa,5),C($a,5)),i&2){let s;y(s=I())&&(t.editableForm=s.first),y(s=I())&&(t.gridProcessos=s.first),y(s=I())&&(t.gridObjetivos=s.first),y(s=I())&&(t.entregas=s.first),y(s=I())&&(t.planejamento=s.first),y(s=I())&&(t.cadeiaValor=s.first),y(s=I())&&(t.inputObjetivo=s.first),y(s=I())&&(t.inputProcesso=s.first),y(s=I())&&(t.entrega=s.first),y(s=I())&&(t.unidade=s.first),y(s=I())&&(t.tabs=s.first),y(s=I())&&(t.etiqueta=s.first)}},features:[L],decls:44,vars:57,consts:[["tabs",""],["unidade",""],["entrega",""],["naoSelecionou",""],["etiqueta",""],["planejamento",""],["gridObjetivos",""],["titleObjetivo",""],["columnObjetivo",""],["editObjetivo",""],["inputObjetivo",""],["cadeiaValor",""],["gridProcessos",""],["titleProcessos",""],["processo",""],["editProcesso",""],["inputProcesso",""],["initialFocus","descricao",3,"submit","cancel","form","disabled","title"],["display","","right","",3,"title"],["key","ENTREGAS","label","Entregas"],[1,"row"],["collapse","",3,"title","collapsed"],["label","T\xEDtulo","controlName","descricao","required","",3,"size","placeholder"],["controlName","descricao_entrega",3,"size","label","placeholder"],["controlName","entrega_pai_id",3,"size","label","dao","where","selectRoute","metadata"],[1,"row","mt-4"],["editable","",3,"control","form","hasAdd","hasDelete"],["type","text","title","Texto","field","texto"],["type","options"],["date","","label","In\xEDcio","controlName","data_inicio","required","",3,"size","labelInfo"],["date","","label","Fim","controlName","data_fim","required","",3,"size","labelInfo"],["label","Demandante","controlName","unidade_id","required","",3,"size","dao"],["label","Destinat\xE1rio","controlName","destinatario","required","",3,"size"],["title","Planejamento"],["controlName","entrega_id","placeholder","Selecione ou cadastre uma meta do cat\xE1logo usando a lupa","required","",3,"change","size","label","dao"],["label","Descri\xE7\xE3o da meta","controlName","descricao_meta","placeholder","Descreva a meta",3,"size"],["class","row",4,"ngIf","ngIfElse"],["label","Etiquetas","controlName","etiquetas",3,"size","control","addItemHandle"],["controlName","etiqueta",3,"size","control","items"],["key","OBJETIVOS","label","Objetivos",4,"ngIf"],["key","PROCESSOS","label","Processos",4,"ngIf"],["icon","bi bi-graph-up-arrow","label","Meta","labelInfo","Onde quero chegar ao final da entrega. Evolu\xE7\xE3o total da entrega, podendo ultrapassar o per\xEDodo do plano de entregas",3,"entrega","size","control"],["label","Parcela da entrega no plano","controlName","progresso_esperado","sufix","%","labelInfo","Quanto vou caminhar nesse plano de entregas. Percentual do total da entrega que ser\xE1 realizado durante a vig\xEAncia desse plano",3,"size"],["icon","bi bi-check-lg","label","Progresso ao in\xEDcio do plano","labelInfo","De onde estou saindo nesse plano. Valor correspondente ao progresso verificado no planejamento do plano de entregas",3,"entrega","size","control","change"],["label","Progresso j\xE1 realizado","controlName","progresso_realizado","sufix","%","disabled","","labelInfo","Quanto caminhei no plano atual Evolu\xE7\xE3o j\xE1 realizada para a meta. No ato da cria\xE7\xE3o do plano, \xE9 o percentual de progresso ao in\xEDcio do plano em rela\xE7\xE3o \xE0 meta",3,"size","stepValue"],["key","OBJETIVOS","label","Objetivos"],["controlName","planejamento_id","disabled","",3,"size","dao"],["editable","",3,"control","form","orderBy","hasDelete","hasEdit","add","remove","save"],[3,"titleTemplate","template","editTemplate"],["by","objetivo.nome",3,"header"],["controlName","planejamento_objetivo_id",3,"size","where","dao","selectRoute"],["key","PROCESSOS","label","Processos"],["controlName","cadeia_valor_id","disabled","",3,"size","dao"],["type","options",3,"dynamicButtons"],["by","processo.nome",3,"header"],["label","","icon","","controlName","cadeia_processo_id","label","",3,"size","where","dao","selectRoute"]],template:function(i,t){if(i&1){let s=N();c(0,"editable-form",17),D("submit",function(){return P(s),O(t.onSaveEntrega())})("cancel",function(){return P(s),O(t.onCancel())}),c(1,"tabs",18,0)(3,"tab",19)(4,"div",20)(5,"separator",21)(6,"div",20),m(7,"input-text",22),d(),c(8,"div",20),m(9,"input-textarea",23),d(),c(10,"div",20),m(11,"input-search",24),d(),c(12,"separator",21)(13,"div",25)(14,"h5"),g(15,"Etapas"),d(),c(16,"grid",26)(17,"columns"),m(18,"column",27)(19,"column",28),d()()()()(),c(20,"separator",21)(21,"div",20),m(22,"input-datetime",29)(23,"input-datetime",30),d(),c(24,"div",20),m(25,"input-search",31,1)(27,"input-text",32),d()(),m(28,"separator",33),c(29,"div",20)(30,"input-search",34,2),D("change",function(E){return P(s),O(t.onEntregaChange(E))}),d()(),c(32,"div",20),m(33,"input-textarea",35),d(),u(34,rn,6,10,"div",36)(35,ln,3,3,"ng-template",null,3,f),c(37,"separator",21)(38,"div",20)(39,"input-multiselect",37),m(40,"input-select",38,4),d()()()()(),u(42,mn,14,13,"tab",39)(43,hn,14,14,"tab",40),d()()}if(i&2){let s=_(31),h=_(36);r("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),l(),r("title",t.isModal?"":t.title),l(4),r("title","Informa\xE7\xF5es gerais da "+t.lex.translate("entrega"))("collapsed",!1),l(2),r("size",12)("placeholder","T\xEDtulo da "+t.lex.translate("entrega")),K("maxlength",250),l(2),r("size",12)("label","Descri\xE7\xE3o da "+t.lex.translate("entrega"))("placeholder","Descreva a "+t.lex.translate("entrega")),l(2),r("size",12)("label","V\xEDnculo com "+t.lex.translate("entrega")+" de "+t.lex.translate("plano de entrega")+" superior")("dao",t.planoEntregaEntregaDao)("where",Q(50,Xa,t.idsUnidadesAscendentes))("selectRoute",Q(53,Za,X(52,Ja)))("metadata",Q(55,Ka,t.idsUnidadesAscendentes)),l(),r("title","Etapas da "+t.lex.translate("entrega"))("collapsed",!0),l(4),r("control",t.form.controls.checklist)("form",t.formChecklist)("hasAdd",!0)("hasDelete",!0),l(4),r("title","Especifica\xE7\xF5es da "+t.lex.translate("entrega"))("collapsed",!1),l(2),r("size",6)("labelInfo","In\xEDcio "+t.lex.translate("Plano de Entregas")),l(),r("size",6)("labelInfo","Fim "+t.lex.translate("Plano de Entregas")+"(Estimativa Inicial)"),l(2),r("size",6)("dao",t.unidadeDao),l(2),r("size",6),K("maxlength",250),l(3),r("size",12)("label",t.lex.translate("Tipo de Meta"))("dao",t.entregaDao),l(3),r("size",12),l(),r("ngIf",s==null?null:s.selectedEntity)("ngIfElse",h),l(3),r("title","Caracteriza\xE7\xE3o da "+t.lex.translate("entrega"))("collapsed",!1),l(2),r("size",12)("control",t.form.controls.etiquetas)("addItemHandle",t.addItemHandleEtiquetas.bind(t)),l(),r("size",12)("control",t.form.controls.etiqueta)("items",t.etiquetas),l(2),r("ngIf",t.planejamentoId==null?null:t.planejamentoId.length),l(),r("ngIf",t.cadeiaValorId==null?null:t.cadeiaValorId.length)}},dependencies:[F,A,k,j,q,Z,te,At,W,re,qe,Me,Ue,le,Ae,he,De]});let a=o;return a})();var _n=["selectResponsaveis"];function fn(a,o){a&1&&(c(0,"strong"),g(1,"Respons\xE1vel"),d())}function En(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=o.row;l(),z(" ",n.responsavel," ")}}function vn(a,o){a&1&&(c(0,"strong"),g(1,"Criado em"),d())}function bn(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=o.row,e=p();l(),T(e.util.getDateTimeFormatted(n.date_time))}}function Cn(a,o){a&1&&(c(0,"div",9)(1,"div",17)(2,"strong"),g(3,"Atributos"),d()(),c(4,"div",18)(5,"strong"),g(6,"Valores"),m(7,"br"),g(8,"Atuais"),d()(),c(9,"div",18)(10,"strong"),g(11,"Valores"),m(12,"br"),g(13,"Anteriores"),d()()())}function yn(a,o){if(a&1&&(c(0,"tr")(1,"td",21),g(2),d(),c(3,"td",22),g(4),d(),c(5,"td",22),g(6),d()()),a&2){let n=o.$implicit,e=p(2);l(2),T(n[0]),l(2),T(e.action=="EDIT"||e.action=="ADD"?n[1]:""),l(2),T(e.action=="EDIT"?n[2]:e.action=="ADD"?"":n[1])}}function In(a,o){if(a&1&&(c(0,"separator",19)(1,"table")(2,"tbody"),u(3,yn,7,3,"tr",20),d()()()),a&2){let n=o.row,e=p();r("collapse","collapse")("collapsed",!0),l(3),r("ngForOf",e.preparaDelta(n))}}var Xt=(()=>{let o=class o extends se{constructor(e,i){super(e,Bt,ke),this.injector=e,this.responsaveis=[],this.planoId="",this.action="",this.filterWhere=t=>{let s=[],h=t.value;return s.push(["table_name","==","planos_entregas"]),s.push(["row_id","==",this.planoId]),h.responsavel_id?.length&&s.push(["user_id","==",h.responsavel_id=="null"?null:h.responsavel_id]),h.data_inicio&&s.push(["date_time",">=",h.data_inicio]),h.data_fim&&s.push(["date_time","<=",h.data_fim]),h.tipo?.length&&s.push(["type","==",h.tipo]),s},this.planoEntregaDao=e.get(Y),this.title="Logs de Planos de Entregas",this.filter=this.fh.FormBuilder({responsavel_id:{default:""},data_inicio:{default:""},data_fim:{default:""},tipo:{default:""}}),this.orderBy=[["id","desc"]]}ngOnInit(){super.ngOnInit(),this.planoId=this.urlParams?.get("id")||"",this.planoEntregaDao.getById(this.planoId).then(e=>this.planoEntrega=e)}ngAfterViewInit(){super.ngAfterViewInit()}filterClear(e){e.controls.responsavel_id.setValue(""),e.controls.data_inicio.setValue(""),e.controls.data_fim.setValue(""),e.controls.tipo.setValue(""),super.filterClear(e)}preparaDelta(e){this.action=e.type;let i=e.delta instanceof Array?e.delta:Object.entries(e.delta);return i.forEach(t=>{t[1]instanceof Date&&(t[1]=new Date(t[1]).toUTCString()),t.length>2&&t[2]instanceof Date&&(t[2]=new Date(t[2]).toUTCString())}),i}};o.\u0275fac=function(i){return new(i||o)(R(S),R(ke))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-list-logs"]],viewQuery:function(i,t){if(i&1&&(C(A,5),C(_n,5)),i&2){let s;y(s=I())&&(t.grid=s.first),y(s=I())&&(t.selectResponsaveis=s.first)}},features:[L],decls:31,vars:30,consts:[["selectResponsaveis",""],["titleResponsavel",""],["columnResponsavel",""],["titleDataCriacao",""],["columnDataCriacao",""],["titleDiferenca",""],["columnDiferenca",""],[3,"dao","hasEdit","title","orderBy","groupBy","join"],[3,"deleted","form","where","submit","clear","collapseChange","collapsed"],[1,"row"],["label","Respons\xE1vel pelo registro","controlName","responsavel_id",3,"control","items"],["datetime","","label","In\xEDcio","controlName","data_inicio","labelInfo","In\xEDcio dos registros",3,"size","control"],["datetime","","label","Fim","controlName","data_fim","labelInfo","Fim dos registros",3,"size","control"],["label","Tipo","icon","bi bi-arrow-up-right-circle","controlName","tipo","itemTodos","Todos","valueTodos","",3,"size","control","items"],[3,"titleTemplate","template"],["title","Tipo de Opera\xE7\xE3o","field","type"],[3,"rows"],["width","150",1,"col","align-bottom"],["width","250",1,"col"],["title","(ver detalhes)",3,"collapse","collapsed"],[4,"ngFor","ngForOf"],["width","150"],["width","250"]],template:function(i,t){if(i&1&&(c(0,"grid",7)(1,"span")(2,"strong"),g(3),d()(),m(4,"toolbar"),c(5,"filter",8)(6,"div",9),m(7,"input-select",10,0),d(),c(9,"div",9),m(10,"input-datetime",11)(11,"input-datetime",12)(12,"input-select",13),d()(),c(13,"columns")(14,"column",14),u(15,fn,2,0,"ng-template",null,1,f)(17,En,2,1,"ng-template",null,2,f),d(),c(19,"column",14),u(20,vn,2,0,"ng-template",null,3,f)(22,bn,2,1,"ng-template",null,4,f),d(),c(24,"column",14),u(25,Cn,14,0,"ng-template",null,5,f)(27,In,4,3,"ng-template",null,6,f),d(),m(29,"column",15),d(),m(30,"pagination",16),d()),i&2){let s=_(16),h=_(18),E=_(21),b=_(23),w=_(26),V=_(28);r("dao",t.dao)("hasEdit",!1)("title",t.isModal?"":t.title)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join),l(3),T((t.planoEntrega==null?null:t.planoEntrega.numero)+" - "+(t.planoEntrega==null?null:t.planoEntrega.nome)),l(2),r("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("clear",t.filterClear.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),l(2),r("control",t.filter.controls.responsavel_id)("items",t.responsaveis),l(3),r("size",4)("control",t.filter.controls.data_inicio),l(),r("size",4)("control",t.filter.controls.data_fim),l(),r("size",4)("control",t.filter.controls.tipo)("items",t.lookup.TIPO_LOG_CHANGE),l(2),r("titleTemplate",s)("template",h),l(5),r("titleTemplate",E)("template",b),l(5),r("titleTemplate",w)("template",V),l(6),r("rows",t.rowsLimit)}},dependencies:[ue,A,k,j,ae,ie,ne,W,re,le]});let a=o;return a})();function Tn(a,o){if(a&1&&(c(0,"h3",18),g(1),d()),a&2){let n=p();l(),T(n.title)}}function Pn(a,o){if(a&1&&m(0,"toolbar",19),a&2){let n=p();r("buttons",n.buttons)}}function On(a,o){if(a&1&&m(0,"badge",20)(1,"br")(2,"badge",21)(3,"br")(4,"badge",22),a&2){let n=o.row,e=p();r("label",n.descricao||"(n\xE3o informado)"),l(2),r("icon",e.entityService.getIcon("Unidade"))("label",n.unidade.sigla||"(n\xE3o informado)"),l(2),r("label",n.destinatario||"(n\xE3o informado)")}}function An(a,o){if(a&1&&(c(0,"span"),g(1),m(2,"br"),g(3),d()),a&2){let n=o.row,e=p();l(),T(e.dao.getDateFormatted(n.data_inicio)),l(2),T(e.dao.getDateFormatted(n.data_fim))}}function Dn(a,o){if(a&1&&(c(0,"span",24),m(1,"i",25),g(2),d()),a&2){let n=p().row;l(2),z(" ",n.entrega.nome||n.entrega_pai.descricao," ")}}function xn(a,o){if(a&1&&u(0,Dn,3,1,"span",23),a&2){let n=o.row;r("ngIf",n.entrega)}}function Sn(a,o){if(a&1&&m(0,"badge",26)(1,"br")(2,"badge",26),a&2){let n=o.row,e=p();r("label",e.planoEntregaService.getValorMeta(n)),l(2),r("label",e.planoEntregaService.getValorRealizado(n))}}function wn(a,o){if(a&1&&m(0,"progress-bar",27),a&2){let n=o.row;r("value",n.progresso_realizado)}}var Jt=(()=>{let o=class o extends se{constructor(e){super(e,pe,H),this.injector=e,this.buttons=[],this.idsUnidadesAscendentes=[],this.filterWhere=i=>{let t=i.value,s=[];return this.idsUnidadesAscendentes.length&&s.push(["plano_entrega.unidade_id","in",this.idsUnidadesAscendentes]),t.unidade_id?.length&&s.push(["unidade_id","==",t.unidade_id]),t.descricao?.length&&s.push(["descricao","like","%"+t.descricao.trim().replace(" ","%")+"%"]),t.descricao?.length&&s.push(["descricao_entrega","like","%"+t.descricao_entrega.trim().replace(" ","%")+"%"]),t.destinatario?.length&&s.push(["destinatario","like","%"+t.destinatario.trim().replace(" ","%")+"%"]),s},this.planoEntregaDao=e.get(H),this.unidadeDao=e.get(J),this.planoEntregaService=e.get($),this.title=this.lex.translate("Entregas"),this.filter=this.fh.FormBuilder({descricao:{default:""},descricao_entrega:{default:""},unidade_id:{default:""},destinatario:{default:""}}),this.join=["entrega:id,nome","entrega_pai:id,descricao","unidade:id,sigla"]}ngOnInit(){super.ngOnInit(),this.idsUnidadesAscendentes=this.metadata?.idsUnidadesAscendentes||this.idsUnidadesAscendentes,this.filter?.controls.unidade_id.setValue(this.idsUnidadesAscendentes[0])}dynamicOptions(e){let i=[];return i.push({label:"Informa\xE7\xF5es",icon:"bi bi-info-circle",onClick:t=>this.go.navigate({route:["gestao","planejamento","objetivo",t.id,"consult"]},{modal:!0})}),i}filterClear(e){super.filterClear(e)}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["app-plano-entrega-list-entrega-list"]],viewQuery:function(i,t){if(i&1&&C(A,5),i&2){let s;y(s=I())&&(t.grid=s.first)}},features:[L],decls:26,vars:32,consts:[["columnEntregaCliente",""],["columnDatas",""],["columnIndicador",""],["columnMetaRealizado",""],["columnProgresso",""],["class","my-2",4,"ngIf"],[3,"select","dao","orderBy","groupBy","join","selectable"],[3,"buttons",4,"ngIf"],[3,"deleted","form","where","submit","clear","collapseChange","collapsed"],[1,"row"],["label","Unidade","controlName","unidade_id",3,"size","control","dao"],["label","T\xEDtulo da entrega","controlName","descricao","placeholder","T\xEDtulo",3,"size","control"],["label","Descri\xE7\xE3o da entrega","controlName","descricao_entrega","placeholder","Descri\xE7\xE3o",3,"size","control"],[3,"title","template"],["title","Entrega",3,"template"],["title","Progresso",3,"template"],["type","options"],[3,"rows"],[1,"my-2"],[3,"buttons"],["icon","bi bi-textarea-t","color","light",3,"label"],["color","success",3,"icon","label"],["icon","bi bi-mailbox","color","light",3,"label"],["class","badge bg-light text-dark",4,"ngIf"],[1,"badge","bg-light","text-dark"],[1,"bi","bi-list-check"],["color","light",3,"label"],["color","success",3,"value"]],template:function(i,t){if(i&1){let s=N();u(0,Tn,2,1,"h3",5),c(1,"grid",6),D("select",function(E){return P(s),O(t.onSelect(E))}),u(2,Pn,1,1,"toolbar",7),c(3,"filter",8)(4,"div",9),m(5,"input-search",10)(6,"input-text",11)(7,"input-text",12),d()(),c(8,"columns")(9,"column",13),u(10,On,5,4,"ng-template",null,0,f),d(),c(12,"column",13),u(13,An,4,2,"ng-template",null,1,f),d(),c(15,"column",14),u(16,xn,1,1,"ng-template",null,2,f),d(),c(18,"column",13),u(19,Sn,3,2,"ng-template",null,3,f),d(),c(21,"column",15),u(22,wn,1,1,"ng-template",null,4,f),d(),m(24,"column",16),d(),m(25,"pagination",17),d()}if(i&2){let s=_(11),h=_(14),E=_(17),b=_(20),w=_(23);r("ngIf",!t.isModal),l(),r("dao",t.dao)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("selectable",t.selectable),l(),r("ngIf",!t.selectable),l(),r("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("clear",t.filterClear.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),l(2),r("size",4)("control",t.filter.controls.unidade_id)("dao",t.unidadeDao),l(),r("size",4)("control",t.filter.controls.descricao),K("maxlength",250),l(),r("size",4)("control",t.filter.controls.descricao_entrega),K("maxlength",250),l(2),r("title",`Entrega
Demandante
Destinat\xE1rio`)("template",s),l(3),r("title",`Data In\xEDcio
Data Fim`)("template",h),l(3),r("template",E),l(3),r("title",`Meta
Realizado`)("template",b),l(3),r("template",w),l(4),r("rows",t.rowsLimit)}},dependencies:[F,A,k,j,ae,ie,ne,Z,te,B,de]});let a=o;return a})();var et=(()=>{let o=class o extends yt{constructor(e){super("PlanoEntregaEntregaProgresso",e),this.injector=e,this.inputSearchConfig.searchFields=["data_progresso"]}};o.\u0275fac=function(i){return new(i||o)(gt(S))},o.\u0275prov=ut({token:o,factory:o.\u0275fac,providedIn:"root"});let a=o;return a})();var Ce=class extends Ve{constructor(o){super(),this.data_inicio=new Date,this.data_fim=null,this.data_progresso=null,this.homologado=!1,this.meta={},this.realizado={},this.progresso_esperado=100,this.progresso_realizado=0,this.plano_entrega_entrega_id="",this.usuario_id="",this.initialization(o)}};function Rn(a,o){a&1&&m(0,"toolbar")}function Ln(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_progresso),"")}}function Vn(a,o){if(a&1&&u(0,Ln,2,1,"span",5),a&2){let n=o.row;r("ngIf",n.data_progresso)}}function Nn(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_inicio),"")}}function zn(a,o){if(a&1&&(c(0,"span"),g(1),d()),a&2){let n=p().row,e=p();l(),z(" ",e.dao.getDateFormatted(n.data_fim),"")}}function Fn(a,o){if(a&1&&(u(0,Nn,2,1,"span",5),m(1,"br"),u(2,zn,2,1,"span",5)),a&2){let n=o.row;r("ngIf",n.data_inicio),l(2),r("ngIf",n.data_fim)}}function jn(a,o){if(a&1&&m(0,"badge",15)(1,"br")(2,"badge",16),a&2){let n=o.row,e=p();r("textValue",e.planoEntregaService.getValorMeta(n.plano_entrega_entrega)),l(2),r("textValue",e.planoEntregaService.getValorRealizado(n.plano_entrega_entrega))}}function kn(a,o){if(a&1&&m(0,"progress-bar",17),a&2){let n=o.row;r("value",n.progresso_realizado)("goal",n.progresso_esperado)}}var Zt=(()=>{let o=class o extends se{constructor(e){super(e,Ce,et),this.injector=e,this.planoEntregaEntregaId="",this.filterWhere=i=>{let t=[],s=i.value;return s.data_inicial_progresso&&t.push(["data_progresso",">=",s.data_inicial_progresso]),s.data_final_progresso&&t.push(["data_progresso","<=",s.data_final_progresso]),t.push(["plano_entrega_entrega_id","==",this.planoEntregaEntregaId]),t},this.planoEntregaService=e.get($),this.title=this.lex.translate("Hist\xF3rico de execu\xE7\xE3o"),this.orderBy=[["data_progresso","desc"]],this.join=["plano_entrega_entrega.entrega"],this.filter=this.fh.FormBuilder({data_inicial_progresso:{default:null},data_final_progresso:{default:null}}),this.addOption(Object.assign({onClick:this.delete.bind(this)},this.OPTION_EXCLUIR),"MOD_PENT_ENTR_PRO_EXCL")}onGridLoad(e){e?.forEach(i=>i.entrega=i.plano_entrega_entrega?.entrega)}ngOnInit(){super.ngOnInit(),this.planoEntregaEntregaId=this.urlParams.get("entrega_id")||""}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["app-plano-entrega-list-progresso"]],viewQuery:function(i,t){if(i&1&&C(A,5),i&2){let s;y(s=I())&&(t.grid=s.first)}},features:[L],decls:21,vars:38,consts:[["columnProgressoData",""],["columnDatas",""],["columnMetaRealizado",""],["columnProgresso",""],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","loadList"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],[1,"row"],["noIcon","","label","Data inical do progresso","controlName","data_inicial_progresso","labelInfo","Data que foi registrado o progresso",3,"size","control"],["noIcon","","label","Data final do progresso","controlName","data_final_progresso","labelInfo","Data que foi registrado o progresso",3,"size","control"],[3,"title","template","editTemplate"],[3,"title","width","template"],[3,"title","width","template","editTemplate","columnEditTemplate"],["type","options",3,"onEdit","options"],[3,"rows"],["icon","bi bi-graph-up-arrow","color","light","hint","Planejada",3,"textValue"],["icon","bi bi-check-lg","color","light","hint","Realizada",3,"textValue"],["color","success",3,"value","goal"]],template:function(i,t){if(i&1){let s=N();c(0,"grid",4),D("select",function(E){return P(s),O(t.onSelect(E))}),u(1,Rn,1,0,"toolbar",5),c(2,"filter",6)(3,"div",7),m(4,"input-datetime",8)(5,"input-datetime",9),d()(),c(6,"columns")(7,"column",10),u(8,Vn,1,1,"ng-template",null,0,f),d(),c(10,"column",10),u(11,Fn,3,2,"ng-template",null,1,f),d(),c(13,"column",11),u(14,jn,3,2,"ng-template",null,2,f),d(),c(16,"column",12),u(17,kn,1,2,"ng-template",null,3,f),d(),m(19,"column",13),d(),m(20,"pagination",14),d()}if(i&2){let s=_(9),h=_(12),E=_(15),b=_(18);r("dao",t.dao)("add",t.add)("title",t.isModal?"":t.title)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("selectable",t.selectable)("hasAdd",t.auth.hasPermissionTo("MOD_PENT_ENTR_PRO_INCL"))("hasEdit",t.auth.hasPermissionTo("MOD_PENT_ENTR_PRO_EDT"))("loadList",t.onGridLoad.bind(t)),l(),r("ngIf",!t.selectable),l(),r("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),l(2),r("size",3)("control",t.filter.controls.data_inicial_progresso),l(),r("size",3)("control",t.filter.controls.data_final_progresso),l(2),r("title","Data progresso")("template",s)("editTemplate",s),l(3),r("title",`Data In\xEDcio
Data Fim`)("template",h)("editTemplate",h),l(3),r("title","Meta")("width",100)("template",E),l(3),r("title","Progresso")("width",200)("template",b)("editTemplate",b)("columnEditTemplate",t.selectable?void 0:b),l(3),r("onEdit",t.edit)("options",t.options),l(),r("rows",t.rowsLimit)}},dependencies:[F,A,k,j,ae,ie,ne,W,B,de]});let a=o;return a})();var mt=(()=>{let o=class o extends _e{constructor(e){super(e,Ce,et),this.injector=e,this.validate=(i,t)=>{let s=null;return["progresso_realizado","realizado"].indexOf(t)>=0&&!(i.value>=0||i.value?.length>0)||["progresso_esperado","meta"].indexOf(t)>=0&&!(i.value>0||i.value?.length>0)?s="Obrigat\xF3rio":(["data_inicio"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value)||["data_fim"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value))&&(s="Inv\xE1lido"),s},this.titleEdit=i=>"Editando "+this.lex.translate("Progresso da entrega")+": "+(i?.entrega?.descricao||""),this.planoEntregaService=e.get($),this.planoEntregaEntregaDao=e.get(H),this.join=["plano_entrega_entrega.entrega"],this.form=this.fh.FormBuilder({data_progresso:{default:new Date},data_inicio:{default:new Date},data_fim:{default:new Date},meta:{default:100},realizado:{default:null},progresso_esperado:{default:100},progresso_realizado:{default:null},usuario_id:{default:null},plano_entrega_entrega_id:{default:null}},this.cdRef,this.validate)}ngOnInit(){super.ngOnInit(),this.planoEntregaEntregaId=this.urlParams.get("entrega_id")}loadData(e,i){return v(this,null,function*(){let t=Object.assign({},i.value),b=e,{meta:s,realizado:h}=b,E=Pe(b,["meta","realizado"]);i.patchValue(this.util.fillForm(t,E)),i.controls.meta.setValue(this.planoEntregaService.getValor(e.meta)),i.controls.realizado.setValue(this.planoEntregaService.getValor(e.realizado))})}initializeData(e){return v(this,null,function*(){this.entity=new Ce,this.planoEntregaEntrega=this.planoEntregaEntregaId?yield this.planoEntregaEntregaDao.getById(this.planoEntregaEntregaId,["entrega"]):void 0,this.entity.usuario_id=this.auth.usuario.id,this.entity.plano_entrega_entrega_id=this.planoEntregaEntrega?.id,this.entity.plano_entrega_entrega=this.planoEntregaEntrega,this.entity.meta=this.planoEntregaEntrega?.meta,this.entity.realizado=this.planoEntregaEntrega?.realizado,this.entity.progresso_esperado=this.planoEntregaEntrega?.progresso_esperado,this.entity.progresso_realizado=this.planoEntregaEntrega?.progresso_realizado,this.entity.data_inicio=this.planoEntregaEntrega?.data_inicio,this.entity.data_fim=this.planoEntregaEntrega?.data_fim,yield this.loadData(this.entity,e)})}saveData(e){return new Promise((i,t)=>{let s=this.util.fill(new Ce,this.entity),w=this.form.value,{meta:h,realizado:E}=w,b=Pe(w,["meta","realizado"]);s=this.util.fillForm(s,b),s.meta=this.planoEntregaService.getEntregaValor(this.entity.plano_entrega_entrega?.entrega,h),s.realizado=this.planoEntregaService.getEntregaValor(this.entity.plano_entrega_entrega?.entrega,E),i(s)})}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-form-progresso"]],viewQuery:function(i,t){if(i&1&&C(q,5),i&2){let s;y(s=I())&&(t.editableForm=s.first)}},features:[L],decls:11,vars:16,consts:[["initialFocus","data_progresso",3,"submit","cancel","form","disabled","title"],[1,"row"],["date","","label","Data do progresso","controlName","data_progresso","required","",3,"size"],["date","","label","In\xEDcio","controlName","data_inicio","required","",3,"size","labelInfo"],["date","","label","Fim","controlName","data_fim","required","",3,"size","labelInfo"],["icon","bi bi-graph-up-arrow","label","Meta",3,"entrega","size","control"],["icon","bi bi-check-lg","label","Valor Inicial","labelInfo","Valor da meta verificado no in\xEDcio do plano de entrega",3,"entrega","size","control"],["label","Progresso Esperado","controlName","progresso_esperado","sufix","%",3,"size"],["label","Progresso Realizado","controlName","progresso_realizado","sufix","%",3,"size"]],template:function(i,t){i&1&&(c(0,"editable-form",0),D("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),c(1,"div",1),m(2,"input-datetime",2)(3,"input-datetime",3)(4,"input-datetime",4),d(),c(5,"div",1),m(6,"plano-entrega-valor-meta-input",5)(7,"plano-entrega-valor-meta-input",6),d(),c(8,"div",1),m(9,"input-number",7)(10,"input-number",8),d()()),i&2&&(r("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),l(2),r("size",4),l(),r("size",4)("labelInfo","In\xEDcio "+t.lex.translate("Plano de Entregas")),l(),r("size",4)("labelInfo","Fim "+t.lex.translate("Plano de Entregas")+"(Estimativa Inicial)"),l(2),r("entrega",t.entity==null||t.entity.plano_entrega_entrega==null?null:t.entity.plano_entrega_entrega.entrega)("size",6)("control",t.form.controls.meta),l(),r("entrega",t.entity==null||t.entity.plano_entrega_entrega==null?null:t.entity.plano_entrega_entrega.entrega)("size",6)("control",t.form.controls.realizado),l(2),r("size",6),l(),r("size",6))},dependencies:[q,W,he,De]});let a=o;return a})();var qn=["listaAtividades"];function Bn(a,o){a&1&&(c(0,"b"),g(1,"Descri\xE7\xE3o"),d())}function Un(a,o){if(a&1&&(c(0,"span",8),g(1),d(),m(2,"reaction",9)),a&2){let n=o.row;l(),T(n.descricao),l(),r("entity",n)}}function Mn(a,o){if(a&1&&(g(0," Un./"),c(1,"order",10),g(2,"Respons\xE1vel"),d(),m(3,"br"),c(4,"order",11),g(5,"Demandante"),d()),a&2){let n=o.header;l(),r("header",n),l(3),r("header",n)}}function Gn(a,o){if(a&1&&(c(0,"div",12),m(1,"badge",13)(2,"badge",14),d(),m(3,"badge",15)),a&2){let n=o.row,e=p();l(),r("label",n.unidade.sigla),l(),r("icon","bi "+(!(n.usuario==null||n.usuario.nome==null)&&n.usuario.nome.length?"bi-person-check":"bi-person-x"))("label",e.util.apelidoOuNome(n.usuario,!0)||"(N\xE3o atribu\xEDdo)")("hint","Respons\xE1vel: "+((n.usuario==null?null:n.usuario.nome)||"N\xE3o atribuido a nenhum usu\xE1rio")),l(),r("label",e.util.apelidoOuNome(n.demandante,!0)||"Desconhecido")("hint","Demandante: "+((n.demandante==null?null:n.demandante.nome)||"Desconhecido"))}}function Qn(a,o){if(a&1&&m(0,"progress-bar",16),a&2){let n=o.row;r("value",n.progresso)}}var Kt=(()=>{let o=class o extends oe{set entregaId(e){this._entregaId!=e&&(this._entregaId=e)}get entregaId(){return this._entregaId}constructor(e){super(e),this.injector=e,this.items=[],this.loader=!1,this.AtividadeDao=e.get(Ot),this.join=["unidade","usuario","demandante","reacoes.usuario:id,nome,apelido"]}ngOnInit(){super.ngOnInit(),this.loadData()}loadData(){this.loader=!0,this.AtividadeDao.query({where:[["plano_trabalho_entrega_id","==",this._entregaId],["unidades_subordinadas","==",!0]],join:this.join}).asPromise().then(e=>{this.items=e}).finally(()=>{this.loader=!1})}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-trabalho-entrega-atividades"]],viewQuery:function(i,t){if(i&1&&C(qn,5),i&2){let s;y(s=I())&&(t.listaAtividades=s.first)}},inputs:{entregaId:"entregaId"},features:[L],decls:17,vars:10,consts:[["titleIdAtividadeDescricao",""],["columnAtividadeDescricao",""],["titleUnResponsavelDemandante",""],["columnPessoas",""],["columnProgressoEtiquetasChecklist",""],[3,"items","loading"],[3,"titleTemplate","template"],[3,"title","width","template"],[1,"micro-text","fw-ligh","atividade-descricao"],["origem","ATIVIDADE",3,"entity"],["by","usuario.nome",3,"header"],["by","demandante.nome",3,"header"],[1,"text-nowrap"],["icon","bi bi-briefcase","color","light",3,"label"],["color","light",3,"icon","label","hint"],["icon","bi bi-cursor","color","light",3,"label","hint"],["color","success",3,"value"]],template:function(i,t){if(i&1&&(c(0,"h5"),g(1),d(),c(2,"grid",5)(3,"columns")(4,"column",6),u(5,Bn,2,0,"ng-template",null,0,f)(7,Un,3,2,"ng-template",null,1,f),d(),c(9,"column",6),u(10,Mn,6,2,"ng-template",null,2,f)(12,Gn,4,6,"ng-template",null,3,f),d(),c(14,"column",7),u(15,Qn,1,1,"ng-template",null,4,f),d()()()),i&2){let s=_(6),h=_(8),E=_(11),b=_(13),w=_(16);l(),z("",t.lex.translate("Atividades"),":"),l(),r("items",t.items)("loading",t.loader),l(2),r("titleTemplate",s)("template",h),l(5),r("titleTemplate",E)("template",b),l(5),r("title","Progresso")("width",200)("template",w)}},dependencies:[A,k,j,Ae,B,de,Ge]});let a=o;return a})();var Wn=["accordionUser"];function $n(a,o){}function Xn(a,o){if(a&1&&m(0,"plano-trabalho-entrega-atividades",29),a&2){let n=o.row;r("entregaId",n.id)}}function Jn(a,o){a&1&&(c(0,"div",30)(1,"span")(2,"strong"),g(3,"Plano de trabalho"),d()()())}function Zn(a,o){if(a&1&&(c(0,"span",31),g(1),m(2,"br"),g(3),d()),a&2){let n=p().$implicit,e=p(2);l(),z("",e.PlanoTrabalhoDao.getDateFormatted(n.data_inicio)," "),l(2),T(" at\xE9 "+e.PlanoTrabalhoDao.getDateFormatted(n.data_fim))}}function Kn(a,o){a&1&&(c(0,"div",30)(1,"span")(2,"strong"),g(3,"Origem"),d()()())}function Yn(a,o){if(a&1&&m(0,"badge",37),a&2){let n=p().row,e=p(3);r("label",(n.plano_entrega_entrega==null||n.plano_entrega_entrega.plano_entrega==null||n.plano_entrega_entrega.plano_entrega.unidade==null?null:n.plano_entrega_entrega.plano_entrega.unidade.sigla)||"Desconhecido")("icon",e.entityService.getIcon("Unidade"))}}function eo(a,o){if(a&1&&m(0,"badge",38),a&2){let n=p().row;r("label",n.orgao)}}function to(a,o){if(a&1&&(c(0,"div",32)(1,"div",33),m(2,"badge",34),u(3,Yn,1,2,"badge",35)(4,eo,1,1,"badge",36),d()()),a&2){let n=o.row,e=p(3);l(2),r("label",e.planoTrabalhoService.tipoEntrega(n,e.entity).titulo)("color",e.planoTrabalhoService.tipoEntrega(n,e.entity).cor),l(),r("ngIf",n.plano_entrega_entrega_id==null?null:n.plano_entrega_entrega_id.length),l(),r("ngIf",n.orgao==null?null:n.orgao.length)}}function io(a,o){if(a&1&&(c(0,"div",30)(1,"small"),m(2,"badge",39),d()()),a&2){let n=p().$implicit,e=p(2);l(2),r("color",e.totalForcaTrabalho(n.entregas)==100?"success":"warning")("label",e.totalForcaTrabalho(n.entregas)+"%")}}function ao(a,o){if(a&1&&(c(0,"small"),g(1),d()),a&2){let n=o.row;l(),T(n.forca_trabalho+"%")}}function no(a,o){a&1&&(c(0,"div",30)(1,"span")(2,"strong"),g(3,"Detalhamento/Descri\xE7\xE3o dos Trabalhos"),d()()())}function oo(a,o){if(a&1&&(c(0,"small",30),g(1),d()),a&2){let n=o.row;l(),T(n.descricao)}}function ro(a,o){if(a&1&&m(0,"badge",40),a&2){let n=p().$implicit,e=p(2);r("color",e.lookup.getColor(e.lookup.PLANO_TRABALHO_STATUS,n.status))("icon",e.lookup.getIcon(e.lookup.PLANO_TRABALHO_STATUS,n.status))("label",e.lookup.getValue(e.lookup.PLANO_TRABALHO_STATUS,n.status))}}function lo(a,o){if(a&1&&(c(0,"div",20)(1,"div",21)(2,"grid",22)(3,"columns")(4,"column",23),u(5,Xn,1,1,"ng-template",null,7,f),d(),c(7,"column",24),u(8,Jn,4,0,"ng-template",null,8,f)(10,Zn,4,2,"ng-template",null,9,f),d(),c(12,"column",25),u(13,Kn,4,0,"ng-template",null,10,f)(15,to,5,4,"ng-template",null,11,f),d(),c(17,"column",26),u(18,io,3,2,"ng-template",null,5,f)(20,ao,2,1,"ng-template",null,6,f),d(),c(22,"column",27),u(23,no,4,0,"ng-template",null,12,f)(25,oo,2,1,"ng-template",null,13,f),d(),c(27,"column",28),u(28,ro,1,3,"ng-template",null,14,f),d()()()()()),a&2){let n=o.$implicit,e=_(6),i=_(9),t=_(11),s=_(14),h=_(16),E=_(19),b=_(21),w=_(24),V=_(26),ye=_(29);l(2),r("items",n.entregas),l(2),_t("vertical-align:middle"),r("expandTemplate",e),l(3),r("template",t)("titleTemplate",i),l(5),r("titleTemplate",s)("template",h)("verticalAlign","middle")("width",300)("align","center"),l(5),r("titleTemplate",E)("title","% CHD")("template",b)("width",125)("align","center")("titleHint","% Carga Hor\xE1ria Dispon\xEDvel"),l(5),r("maxWidth",250)("titleTemplate",w)("template",V)("verticalAlign","middle")("align","center"),l(5),r("template",ye)}}function so(a,o){if(a&1&&(c(0,"h5"),g(1,"Entregas do plano:"),d(),m(2,"hr"),u(3,lo,30,23,"div",19)),a&2){let n=o.row;l(3),r("ngForOf",n.planos_trabalho)}}function co(a,o){a&1&&(c(0,"b"),g(1,"Participante"),d())}function mo(a,o){if(a&1&&(c(0,"b"),g(1),d(),m(2,"br"),c(3,"small"),g(4),d()),a&2){let n=o.row;l(),T(n.nome),l(3),T(n.apelido||"")}}function po(a,o){}function uo(a,o){if(a&1&&(c(0,"small"),m(1,"badge",39),d()),a&2){let n=o.row,e=p();l(),r("color",e.totalForcaTrabalho(e.planoAtivo(n.planos_trabalho).entregas)==100?"success":"warning")("label",e.totalForcaTrabalho(e.planoAtivo(n.planos_trabalho).entregas)+"%")}}var Yt=(()=>{let o=class o extends oe{set entregaId(e){this._entregaId!=e&&(this._entregaId=e)}get entregaId(){return this._entregaId}constructor(e){super(e),this.injector=e,this.items=[],this.loader=!1,this.PlanoTrabalhoDao=e.get(Pt),this.PlanoTrabalhoEntregaDao=e.get(Tt),this.planoTrabalhoService=e.get(qt),this.join=["plano_trabalho.usuario","plano_entrega_entrega.plano_entrega.unidade"],this.groupBy=[{field:"plano_trabalho.usuario",label:"Usu\xE1rio"}]}ngOnInit(){super.ngOnInit(),this.loadData()}loadData(){this.loader=!0,this.cdRef.detectChanges();try{this.PlanoTrabalhoEntregaDao.query({where:[["plano_entrega_entrega_id","==",this._entregaId],["planoTrabalho.status","in",["ATIVO","CONCLUIDO","AVALIADO"]]],join:this.join}).asPromise().then(e=>{e.forEach(i=>{let t=i.plano_trabalho.usuario;if(t){let s=t.id,h=this.items.find(V=>V.id===s);h||(h=we(Se({},t),{planos_trabalho:[],initialization(V){}}),this.items.push(h));let E=i.plano_trabalho.id,b=h.planos_trabalho.find(V=>V.id===E);b||(b=we(Se({},i.plano_trabalho),{entregas:[],initialization(V){}}),h.planos_trabalho.push(b));let w=we(Se({},i),{initialization(V){}});b.entregas.push(w)}})}).finally(()=>{this.loader=!1,this.cdRef.detectChanges()})}catch{console.log("Erro")}}totalForcaTrabalho(e=[]){let i=e.map(t=>t.forca_trabalho*1).reduce((t,s)=>t+s,0);return Math.round(i*100)/100}planoAtivo(e){return e.find(t=>t.status==="ATIVO")||{}}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-entregas-plano-trabalho"]],viewQuery:function(i,t){if(i&1&&C(Wn,5),i&2){let s;y(s=I())&&(t.accordionUser=s.first)}},inputs:{entregaId:"entregaId"},features:[L],decls:18,vars:11,consts:[["accordionUser",""],["usuarioSectionTitle",""],["columnExpandeEntregas",""],["titleParticipante",""],["columnParticipante",""],["titleForcaTrabalho",""],["columnForcaTrabalho",""],["columnExpandedAtividades",""],["titlePlano",""],["columnPlano",""],["titleOrigem",""],["columnOrigem",""],["titleDescricao",""],["columnDescricao",""],["columnStatus",""],[3,"items","loading"],["type","expand",3,"expandTemplate","template","width"],[3,"titleTemplate","template"],[3,"titleTemplate","template","title","titleHint"],["class","card mb-2",4,"ngFor","ngForOf"],[1,"card","mb-2"],[1,"card-body"],[3,"items"],["type","expand",3,"expandTemplate"],[3,"template","titleTemplate"],[3,"titleTemplate","template","verticalAlign","width","align"],[3,"titleTemplate","title","template","width","align","titleHint"],[3,"maxWidth","titleTemplate","template","verticalAlign","align"],["title","Status",3,"template"],[3,"entregaId"],[1,"text-center"],[1,"d-block","text-center"],[1,"w-100","d-flex","justify-content-center"],[1,"one-per-line"],[3,"label","color"],["color","primary",3,"label","icon",4,"ngIf"],["icon","bi bi-box-arrow-down-left","color","warning",3,"label",4,"ngIf"],["color","primary",3,"label","icon"],["icon","bi bi-box-arrow-down-left","color","warning",3,"label"],["icon","bi bi-calculator",3,"color","label"],[3,"color","icon","label"]],template:function(i,t){if(i&1&&(c(0,"grid",15,0)(2,"columns")(3,"column",16),u(4,$n,0,0,"ng-template",null,1,f)(6,so,4,1,"ng-template",null,2,f),d(),c(8,"column",17),u(9,co,2,0,"ng-template",null,3,f)(11,mo,5,2,"ng-template",null,4,f),d(),c(13,"column",18),u(14,po,0,0,"ng-template",null,5,f)(16,uo,2,2,"ng-template",null,6,f),d()()()),i&2){let s=_(5),h=_(7),E=_(10),b=_(12),w=_(15),V=_(17);r("items",t.items)("loading",t.loader),l(3),r("expandTemplate",h)("template",s)("width",40),l(5),r("titleTemplate",E)("template",b),l(5),r("titleTemplate",w)("template",V)("title","% CHD")("titleHint","% Carga Hor\xE1ria Dispon\xEDvel")}},dependencies:[ue,F,A,k,j,B,Kt]});let a=o;return a})();function ho(a,o){if(a&1&&m(0,"badge",8),a&2){let n=p().$implicit,e=p(2);r("icon",e.entityService.getIcon("Unidade"))("label",n.data==null||n.data.unidade==null?null:n.data.unidade.sigla)}}function _o(a,o){if(a&1){let n=N();c(0,"div",4),g(1),d(),u(2,ho,1,2,"badge",5),m(3,"br"),c(4,"button",6),D("click",function(){let i=P(n).$implicit,t=p(2);return O(t.showDetalhes(i.data))}),m(5,"i",7),d()}if(a&2){let n=o.$implicit;l(),T(n.label),l(),r("ngIf",n.data==null?null:n.data.unidade)}}function fo(a,o){if(a&1&&(c(0,"p-organizationChart",2),u(1,_o,6,2,"ng-template",3),d()),a&2){let n=p();r("value",n.entregasVinculadas)}}function Eo(a,o){a&1&&(c(0,"div",9)(1,"div",10),m(2,"span",11),d()())}var ei=(()=>{let o=class o extends oe{set entregaId(e){this._entregaId!=e&&(this._entregaId=e)}get entregaId(){return this._entregaId}constructor(e){super(e),this.injector=e,this.loader=!1,this.entregasVinculadas=[],this.planoEntregaEntregaDao=e.get(H),this.join=["unidade"]}ngOnInit(){super.ngOnInit(),this.loadData()}loadData(){return v(this,null,function*(){this.loader=!0;try{this.entregasVinculadas=yield this.planoEntregaEntregaDao.hierarquia(this._entregaId),this.cdRef.detectChanges(),this.loader=!1}catch{console.log("Erro")}})}showDetalhes(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega",e.id,"detalhes"]},{metadata:{entrega:e}})})}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-entregas-vinculadas"]],inputs:{entregaId:"entregaId"},features:[L],decls:2,vars:2,consts:[[3,"value",4,"ngIf"],["class","d-flex justify-content-center my-2",4,"ngIf"],[3,"value"],["pTemplate","default"],[1,"p-2"],["color","light",3,"icon","label",4,"ngIf"],["title","Detalhes da entrega",1,"btn","btn-sm",3,"click"],[1,"bi","bi-eye"],["color","light",3,"icon","label"],[1,"d-flex","justify-content-center","my-2"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(i,t){i&1&&u(0,fo,2,1,"p-organizationChart",0)(1,Eo,3,0,"div",1),i&2&&(r("ngIf",t.entregasVinculadas.length),l(),r("ngIf",t.loader))},dependencies:[F,B,Ft,Dt]});let a=o;return a})();function bo(a,o){if(a&1&&m(0,"badge",19),a&2){let n=o.$implicit;r("lookup",n)}}function Co(a,o){if(a&1&&m(0,"badge",20),a&2){let n=p(2);r("icon",n.entityService.getIcon("Unidade"))("label",n.entrega==null||n.entrega.unidade==null?null:n.entrega.unidade.sigla)}}function yo(a,o){if(a&1&&m(0,"badge",21),a&2){let n=p(2);r("label",n.entrega==null?null:n.entrega.destinatario)}}function Io(a,o){if(a&1&&(c(0,"div",22)(1,"div")(2,"b"),g(3,"Planejada"),d(),m(4,"br")(5,"badge",23),d(),m(6,"div",24),c(7,"div")(8,"b"),g(9,"Executada"),d(),m(10,"br")(11,"badge",25),d()()),a&2){let n=p(2);l(5),r("textValue",n.planoEntregaService.getValorMeta(n.entrega)),l(6),r("textValue",n.planoEntregaService.getValorRealizado(n.entrega))}}function To(a,o){if(a&1){let n=N();c(0,"div",33)(1,"small"),g(2),d(),c(3,"button",34),D("click",function(){P(n);let i=p().$implicit,t=p(3);return O(t.showPlanejamento(i.objetivo.id))}),m(4,"i",35),d()()}if(a&2){let n=p().$implicit;l(2),T(n.objetivo.nome)}}function Po(a,o){if(a&1&&(c(0,"li",31),u(1,To,5,1,"div",32),d()),a&2){let n=o.$implicit;l(),r("ngIf",n.objetivo)}}function Oo(a,o){if(a&1&&(c(0,"div",26)(1,"h5",27),g(2),d(),c(3,"div",28)(4,"ul",29),u(5,Po,2,1,"li",30),d()()()),a&2){let n=p(2);l(2),T(n.lex.translate("Objetivos")),l(3),r("ngForOf",n.entrega==null?null:n.entrega.objetivos)}}function Ao(a,o){if(a&1){let n=N();c(0,"div",33)(1,"small"),g(2),d(),c(3,"button",34),D("click",function(){P(n);let i=p().$implicit,t=p(3);return O(t.showCadeiaValor(i.processo.id))}),m(4,"i",35),d()()}if(a&2){let n=p().$implicit;l(2),T(n.processo.nome)}}function Do(a,o){if(a&1&&(c(0,"li",31),u(1,Ao,5,1,"div",32),d()),a&2){let n=o.$implicit;l(),r("ngIf",n.processo)}}function xo(a,o){if(a&1&&(c(0,"div",26)(1,"h5",27),g(2),d(),c(3,"div",28)(4,"ul",29),u(5,Do,2,1,"li",30),d()()()),a&2){let n=p(2);l(2),T(n.lex.translate("Processos")),l(3),r("ngForOf",n.entrega==null?null:n.entrega.processos)}}function So(a,o){if(a&1&&(c(0,"div",8)(1,"div",9),u(2,bo,1,1,"badge",10),d(),c(3,"h5"),g(4),d(),c(5,"small"),g(6),d(),m(7,"hr"),c(8,"p"),g(9,"Per\xEDodo: "),c(10,"small"),g(11),d()(),c(12,"div",11)(13,"p",12),g(14,"Demandante: "),u(15,Co,1,2,"badge",13),d(),c(16,"p"),g(17,"Destinat\xE1rio: "),u(18,yo,1,1,"badge",14),d()(),c(19,"h5",15),g(20),d(),c(21,"small",16),g(22),d(),u(23,Io,12,2,"div",17)(24,Oo,6,2,"div",18)(25,xo,6,2,"div",18),d()),a&2){let n=p();l(2),r("ngForOf",n.entrega==null?null:n.entrega.etiquetas),l(2),T(n.entrega==null?null:n.entrega.descricao),l(2),T(n.entrega==null?null:n.entrega.descricao_entrega),l(5),Et("",n.planoEntregaEntregaDao.getDateFormatted(n.entrega==null?null:n.entrega.data_inicio)," at\xE9 ",n.planoEntregaEntregaDao.getDateFormatted(n.entrega==null?null:n.entrega.data_fim),""),l(4),r("ngIf",n.entrega==null?null:n.entrega.unidade),l(3),r("ngIf",n.entrega==null||n.entrega.destinatario==null?null:n.entrega.destinatario.length),l(2),T(n.lex.translate("Meta")),l(2),T(n.entrega==null?null:n.entrega.descricao_meta),l(),r("ngIf",n.entrega),l(),r("ngIf",n.entrega==null||n.entrega.objetivos==null?null:n.entrega.objetivos.length),l(),r("ngIf",n.entrega==null||n.entrega.processos==null?null:n.entrega.processos.length)}}function wo(a,o){if(a&1&&(c(0,"div",36),m(1,"plano-entrega-entregas-vinculadas",37),d()),a&2){let n=p();l(),r("entregaId",n.entrega.id)}}function Ro(a,o){if(a&1&&(c(0,"div",38),m(1,"plano-entrega-entregas-plano-trabalho",37),d()),a&2){let n=p();l(),r("entregaId",n.entrega.id)}}var ti=(()=>{let o=class o extends oe{constructor(e){super(e),this.injector=e,this.planoEntregaEntregaDao=e.get(H),this.planoEntregaService=e.get($)}ngOnInit(){super.ngOnInit(),this.entrega=this.metadata?.entrega}showPlanejamento(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega","objetivos",e]},{modal:!0})})}showCadeiaValor(e){return v(this,null,function*(){this.go.navigate({route:["gestao","plano-entrega","entrega","processos",e]},{modal:!0})})}};o.\u0275fac=function(i){return new(i||o)(R(S))},o.\u0275cmp=x({type:o,selectors:[["plano-entrega-entrega-detalhes"]],features:[L],decls:8,vars:4,consts:[["detalhesEntrega",""],["right","",3,"title"],["key","INFOS","icon","bi bi-info-lg","label","Informa\xE7\xF5es"],["key","VINCULOS","icon","bi bi-arrow-down-up","label","V\xEDnculos"],["key","PARTICIPANTES","icon","bi bi-people","label","Participantes"],["class","","style","min-height: 400px;",4,"ngIf"],["style","min-height: 400px;",4,"ngIf"],["class","row","style","min-height: 400px;",4,"ngIf"],[1,"",2,"min-height","400px"],[1,"mb-2"],[3,"lookup",4,"ngFor","ngForOf"],[1,"d-flex"],[1,"me-2"],["color","light",3,"icon","label",4,"ngIf"],["color","light","icon","bi bi-mailbox",3,"label",4,"ngIf"],[1,"text-center"],[1,"d-block","text-center","mb-2"],["class","d-flex justify-content-center",4,"ngIf"],["class","mt-3",4,"ngIf"],[3,"lookup"],["color","light",3,"icon","label"],["color","light","icon","bi bi-mailbox",3,"label"],[1,"d-flex","justify-content-center"],["icon","bi bi-graph-up-arrow","color","light","hint","Planejada",3,"textValue"],[1,"vr","mx-5"],["icon","bi bi-check-lg","color","light","hint","Realizada",3,"textValue"],[1,"mt-3"],[1,"text-center","mb-2"],[1,"card"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],["class","d-flex justify-content-between align-items-center",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-sm","btn-outline-info","me-2",3,"click"],[1,"bi","bi-eye"],[2,"min-height","400px"],[3,"entregaId"],[1,"row",2,"min-height","400px"]],template:function(i,t){if(i&1&&(c(0,"tabs",1,0),m(2,"tab",2)(3,"tab",3)(4,"tab",4),d(),u(5,So,26,12,"div",5)(6,wo,2,1,"div",6)(7,Ro,2,1,"div",7)),i&2){let s=_(1);r("title",t.isModal?"":t.title),l(5),r("ngIf",s.active=="INFOS"),l(),r("ngIf",s.active=="VINCULOS"&&t.entrega),l(),r("ngIf",s.active=="PARTICIPANTES"&&t.entrega)}},dependencies:[ue,F,Me,Ue,B,Yt,ei]});let a=o;return a})();var Lo=[{path:"",component:Gt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Plano de Entregas"}},{path:"new",component:Ye,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Inclus\xE3o de Plano de Entregas",modal:!0}},{path:":id/edit",component:Ye,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Edi\xE7\xE3o de Plano de Entregas",modal:!0}},{path:":id/consult",component:Ye,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Consulta a Plano de Entregas",modal:!0}},{path:":id/logs",component:Xt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Logs de Altera\xE7\xF5es em Planos de Entregas",modal:!0}},{path:":planoEntregaId/avaliar",component:Lt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Avaliar Plano de Entrega"}},{path:"entrega",component:ct,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Entregas do Plano de Entregas",modal:!0}},{path:"entrega/:id/consult",component:ct,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Consulta entrega do Plano de Entregas",modal:!0}},{path:"entrega/:id/detalhes",component:ti,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Detalhes da entrega do Plano de Entregas",modal:!0}},{path:"entrega-list",component:Jt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Entregas do Plano de Entregas",modal:!0}},{path:"entrega/objetivos/:objetivo_id",component:dt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Entregas do Plano de Entregas",modal:!0}},{path:"entrega/processos/:processo_id",component:dt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Entregas do Plano de Entregas",modal:!0}},{path:"adesao",component:Qt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Ades\xE3o a Plano de Entregas",modal:!0}},{path:"entrega/progresso/:entrega_id",component:Zt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Progressos da entrega do Plano de Entregas",modal:!0}},{path:"entrega/progresso/:entrega_id/new",component:mt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Inclus\xE3o de Progresso entrega do Plano de Entregas",modal:!0}},{path:"entrega/progresso/:entrega_id/:id/edit",component:mt,canActivate:[U],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Inclus\xE3o de Progresso entrega do Plano de Entregas",modal:!0}}],ii=(()=>{let o=class o{};o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=Le({type:o}),o.\u0275inj=Re({imports:[ot.forChild(Lo),ot]});let a=o;return a})();var Zs=(()=>{let o=class o{};o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=Le({type:o}),o.\u0275inj=Re({imports:[bt,xt,ii,kt,zt,jt,Nt]});let a=o;return a})();export{Zs as PlanoEntregaModule};
