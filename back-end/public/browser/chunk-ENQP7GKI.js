import{f as ce,m as fe,n as he}from"./chunk-ZLGBAEPE.js";import"./chunk-3L5EFWZ5.js";import{a as j}from"./chunk-3OQ5NXFP.js";import{b as me}from"./chunk-GEQ4G77C.js";import{a as F,b as M}from"./chunk-72ETMCRT.js";import{V as pe,b as P,fa as ue,g as se,h as B,i as de,s as b,w as U,x as q}from"./chunk-JEWU6XZO.js";import{b as ae,c as k,d as G,e as ne,h as re,n as le,s as T}from"./chunk-OWVQDN4P.js";import"./chunk-P4ZMML75.js";import{Bb as S,Fa as d,Fb as Y,Ga as m,Ha as s,Hc as $,La as Q,Ma as N,Na as _,Nc as ee,Oc as g,P as z,Pc as ie,Qc as A,U as y,Ua as c,Uc as te,V,Va as f,Wa as h,Ya as X,Z as v,Za as J,_ as E,ad as L,ba as I,h as R,ic as Z,ma as l,na as w,oc as K,pd as oe,va as D,xa as C,ya as O,za as r}from"./chunk-SDCVQHKS.js";var Ae=["cargaHoraria"],Fe=["notificacoes"];function Te(n,a){if(n&1&&(d(0,"tab",22),s(1,"notificacoes-config",23,2),m()),n&2){let p=_();l(),r("entity",p.entity)("entidadeId",p.entity.id)("disabled",p.formDisabled)}}function Me(n,a){if(n&1&&(d(0,"tab",24),s(1,"relatorios-template",25,3),m()),n&2){let p=_();l(),r("entity",p.entity)("entidadeId",p.entity.id)}}var _e=(()=>{let a=class a extends j{constructor(o){super(o,g,A),this.injector=o,this.validateNomenclatura=(t,e)=>{let i=null;return["singular","plural"].includes(e)&&!t.value?.length&&(i="Obrigat\xF3rio"),i},this.validate=(t,e)=>{let i=null;return["carga_horaria_padrao"].indexOf(e)>=0&&!t.value&&(i="Valor n\xE3o pode ser zero."),i},this.titleEdit=t=>"Configurando "+this.lex.translate("Entidade")+": "+(t?.sigla||""),this.tipoModalidadeDao=o.get(L),this.templateDao=o.get(oe),this.notificacao=o.get(te),this.modalWidth=1200,this.join=["notificacoes_templates","relatorios_templates"],this.form=this.fh.FormBuilder({url_sei:{default:""},tipo_modalidade_id:{default:null},notificacoes:{default:[]},nomenclatura:{default:[]},expediente:{default:new $},carga_horaria_padrao:{default:8},forma_contagem_carga_horaria:{default:"DIA"},api_public_key:{default:""}},this.cdRef,this.validate),this.formNomenclatura=this.fh.FormBuilder({id:{default:""},nome:{default:""},singular:{default:""},plural:{default:""},feminino:{default:!1}},this.cdRef,this.validateNomenclatura),this.title="Configurando "+this.lex.translate("Entidade")}onApiKeyClick(o){this.dao?.generateApiKey(this.entity.id).then(t=>{this.form.controls.api_public_key.setValue(t)}).catch(t=>{this.error(t.message?t.message:t)})}onSingularChange(o,t){t.controls.singular.setValue(t.controls.singular.value.toLowerCase()),this.cdRef.detectChanges()}onPluralChange(o,t){t.controls.plural.setValue(t.controls.plural.value.toLowerCase()),this.cdRef.detectChanges()}onFormaContagemCargaHorariaChange(o){this.form.controls.forma_contagem_carga_horaria.setValue(o=="day"?"DIA":o=="week"?"SEMANA":"MES")}get formaContagemCargaHoraria(){let o=this.form?.controls.forma_contagem_carga_horaria?.value||"DIA";return o=="DIA"?"day":o=="SEMANA"?"week":"mouth"}loadData(o,t){return R(this,null,function*(){let e=Object.assign({},t.value),i=o.nomenclatura||[];Object.entries(this.lex.defaults).forEach(([u,W])=>{i.find(ye=>ye.nome==u)||i.push({id:u,nome:u,singular:W.single,plural:W.plural,feminino:W.female})}),o.nomenclatura=i,t.patchValue(this.util.fillForm(e,o))})}initializeData(o){return R(this,null,function*(){this.entity=yield this.dao.getById(this.urlParams.get("id"),this.join),yield this.loadData(this.entity,o)})}saveData(o){return new Promise((t,e)=>{this.notificacoes?.saveData();let i=this.util.fill(new g({notificacoes_templates:[]}),this.entity);i=this.util.fillForm(i,this.form.value),this.dao.update(i.id,{url_sei:i.url_sei,tipo_modalidade_id:i.tipo_modalidade_id,nomenclatura:i.nomenclatura,notificacoes:i.notificacoes,notificacoes_templates:i.notificacoes_templates,expediente:i.expediente,carga_horaria_padrao:i.carga_horaria_padrao,forma_contagem_carga_horaria:i.forma_contagem_carga_horaria}).then(u=>t(!0)).catch(e)})}};a.\u0275fac=function(t){return new(t||a)(w(I))},a.\u0275cmp=y({type:a,selectors:[["app-entidade-conf"]],viewQuery:function(t,e){if(t&1&&(c(b,5),c(Ae,5),c(Fe,5)),t&2){let i;f(i=h())&&(e.editableForm=i.first),f(i=h())&&(e.cargaHoraria=i.first),f(i=h())&&(e.notificacoes=i.first)}},features:[D],decls:21,vars:16,consts:[["cargaHoraria",""],["expediente",""],["notificacoes",""],["relatorios",""],[3,"submit","cancel","form","title"],["display","","right",""],["key","GERAL","label","Geral"],[1,"row"],["controlName","tipo_modalidade_id","labelInfo","Tipo de modalidade padr\xE3o utilizada ao criar plano de trabalho.",3,"size","dao"],["label","Carga Hor\xE1ria","icon","bi bi-hourglass-split","controlName","carga_horaria_padrao","labelInfo","Carga hor\xE1ria e forma de contagem (horas por dia, semana ou m\xEAs) padr\xE3o utilizada ao criar plano de trabalho.",3,"size","unit","unitChange"],["key","EXPEDIENTE","label","Expediente"],[3,"control"],["key","NOTIFICACOES","label","Notifica\xE7\xF5es",4,"ngIf"],["key","RELATORIOS","label","Relat\xF3rios",4,"ngIf"],["key","NOMENCLATURA","label","Nomenclatura"],["clss","row"],["editable","",3,"control","form","hasAdd"],["type","text","title","Nome","field","nome",3,"editable"],["type","text","title","Singular","field","singular",3,"onChange"],["type","text","title","Plural","field","plural",3,"onChange"],["type","switch","title","Feminino","field","feminino"],["type","options"],["key","NOTIFICACOES","label","Notifica\xE7\xF5es"],[3,"entity","entidadeId","disabled"],["key","RELATORIOS","label","Relat\xF3rios"],[3,"entity","entidadeId"]],template:function(t,e){if(t&1){let i=Q();d(0,"editable-form",4),N("submit",function(){return v(i),E(e.onSaveData())})("cancel",function(){return v(i),E(e.onCancel())}),d(1,"tabs",5)(2,"tab",6)(3,"div",7),s(4,"input-search",8)(5,"input-workload",9,0),m()(),d(7,"tab",10),s(8,"calendar-expediente",11,1),m(),C(10,Te,3,3,"tab",12)(11,Me,3,2,"tab",13),d(12,"tab",14)(13,"div",15)(14,"grid",16)(15,"columns"),s(16,"column",17)(17,"column",18)(18,"column",19)(19,"column",20)(20,"column",21),m()()()()()()}t&2&&(r("form",e.form)("title",e.isModal?"":e.title),l(4),r("size",8)("dao",e.tipoModalidadeDao),l(),r("size",4)("unit",e.formaContagemCargaHoraria)("unitChange",e.onFormaContagemCargaHorariaChange.bind(e)),l(3),r("control",e.form.controls.expediente),l(2),r("ngIf",e.entity),l(),r("ngIf",e.entity),l(3),r("control",e.form.controls.nomenclatura)("form",e.formNomenclatura)("hasAdd",!1),l(2),r("editable",!1),l(),r("onChange",e.onSingularChange.bind(e)),l(),r("onChange",e.onPluralChange.bind(e)))},dependencies:[S,T,G,k,b,B,q,U,pe,ce,le,fe]});let n=a;return n})();var Oe=["cidade"],ze=["gestor"],Ve=["gestorSubstituto"],Qe=["tipo_modalidade"];function Le(n,a){if(n&1&&s(0,"input-search",15,2),n&2){let p=_();r("size",8)("dao",p.cidadeDao)}}function Pe(n,a){if(n&1&&s(0,"input-select",16),n&2){let p=_();r("size",8)("items",p.lookup.UF)}}function ke(n,a){n&1&&s(0,"input-display",17),n&2&&r("size",8)}var x=(()=>{let a=class a extends j{constructor(o){super(o,g,A),this.injector=o,this.campos=[],this.validate=(t,e)=>{let i=null;return["nome","sigla"].indexOf(e)>=0&&!t.value?.length&&(i="Obrigat\xF3rio"),i},this.titleEdit=t=>"Editando "+this.lex.translate("Entidade")+": "+(t?.sigla||""),this.tipoModalidadeDao=o.get(L),this.cidadeDao=o.get(ie),this.usuarioDao=o.get(ee),this.form=this.fh.FormBuilder({sigla:{default:""},nome:{default:""},abrangencia:{default:""},codigo_ibge:{default:""},gravar_historico_processo:{default:""},layout_formulario_demanda:{default:""},campos_ocultos_demanda:{default:""},tipo_modalidade_id:{default:null},cidade_id:{default:null},gestor_id:{default:null},gestor_substituto_id:{default:null},expediente:{default:null},uf:{default:null}},this.cdRef,this.validate),this.join=["cidade","tipoModalidade","gestor","gestor_substituto"]}loadData(o,t){return R(this,null,function*(){let e=Object.assign({},t.value);this.campos=o.campos_ocultos_atividade||[],yield Promise.all([this.cidade?.loadSearch(o.cidade||o.cidade_id),this.gestor.loadSearch(o.gestor||o.gestor_id),this.gestorSubstituto.loadSearch(o.gestor_substituto||o.gestor_substituto_id),this.tipoModalidade?.loadSearch(o.tipo_modalidade||o.tipo_modalidade_id)]),t.patchValue(this.util.fillForm(e,o))})}initializeData(o){o.patchValue(new g)}saveData(o){return new Promise((t,e)=>{let i=this.util.fill(new g,this.entity);i=this.util.fillForm(i,this.form.value),i.abrangencia=="MUNICIPAL"&&this.cidade?.selectedEntity?i.codigo_ibge=(this.cidade?.selectedEntity).codigo_ibge:i.abrangencia=="ESTADUAL"?i.codigo_ibge=this.lookup.UF.find(u=>u.key==i.uf)?.code:i.codigo_ibge=null,i.campos_ocultos_demanda=this.campos,t(i)})}};a.\u0275fac=function(t){return new(t||a)(w(I))},a.\u0275cmp=y({type:a,selectors:[["app-entidade-form"]],viewQuery:function(t,e){if(t&1&&(c(b,5),c(Oe,5),c(ze,5),c(Ve,5),c(Qe,5)),t&2){let i;f(i=h())&&(e.editableForm=i.first),f(i=h())&&(e.cidade=i.first),f(i=h())&&(e.gestor=i.first),f(i=h())&&(e.gestorSubstituto=i.first),f(i=h())&&(e.tipoModalidade=i.first)}},features:[D],decls:16,vars:18,consts:[["gestor",""],["gestorSubstituto",""],["cidade",""],["initialFocus","sigla",3,"submit","cancel","form","disabled","title"],["display","","right",""],["key","PRINCIPAL","label","Principal"],[1,"row"],["label","Sigla","controlName","sigla","required","",3,"size"],["label","Nome","controlName","nome","required","",3,"size"],["label","Gestor","controlName","gestor_id","labelInfo","Respons\xE1vel pela unidade",3,"size","emptyValue","dao"],["label","Gestor Substituto","controlName","gestor_substituto_id","labelInfo","Respons\xE1vel substituto pela unidade",3,"size","emptyValue","dao"],["label","Abrang\xEAncia","controlName","abrangencia",3,"size","items"],["controlName","cidade_id",3,"size","dao",4,"ngIf"],["label","UF","icon","bi bi-flag","controlName","uf",3,"size","items",4,"ngIf"],["label","\xC2mbito","icon","bi bi-shield-fill-check","value","Nacional",3,"size",4,"ngIf"],["controlName","cidade_id",3,"size","dao"],["label","UF","icon","bi bi-flag","controlName","uf",3,"size","items"],["label","\xC2mbito","icon","bi bi-shield-fill-check","value","Nacional",3,"size"]],template:function(t,e){if(t&1){let i=Q();d(0,"editable-form",3),N("submit",function(){return v(i),E(e.onSaveData())})("cancel",function(){return v(i),E(e.onCancel())}),d(1,"tabs",4)(2,"tab",5)(3,"div",6),s(4,"input-text",7)(5,"input-text",8),m(),d(6,"div",6),s(7,"input-search",9,0)(9,"input-search",10,1),m(),d(11,"div",6),s(12,"input-select",11),C(13,Le,2,2,"input-search",12)(14,Pe,1,2,"input-select",13)(15,ke,1,1,"input-display",14),m()()()()}t&2&&(r("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),l(4),r("size",2),O("maxlength",250),l(),r("size",10),O("maxlength",250),l(2),r("size",6)("emptyValue",null)("dao",e.usuarioDao),l(2),r("size",6)("emptyValue",null)("dao",e.usuarioDao),l(3),r("size",4)("items",e.lookup.ABRANGENCIA),l(),r("ngIf",e.form.controls.abrangencia.value=="MUNICIPAL"),l(),r("ngIf",e.form.controls.abrangencia.value=="ESTADUAL"),l(),r("ngIf",e.form.controls.abrangencia.value=="NACIONAL"))},dependencies:[S,b,se,B,P,de,q,U]});let n=a;return n})();function Ge(n,a){if(n&1&&(d(0,"h3",11),X(1),m()),n&2){let p=_();l(),J(p.title)}}function Be(n,a){n&1&&s(0,"toolbar")}var be=(()=>{let a=class a extends me{constructor(o){super(o,g,A),this.injector=o,this.options=[],this.filterWhere=t=>{let e=[],i=t.value;return i.nome?.length&&e.push(["nome","like","%"+i.nome.trim().replace(" ","%")+"%"]),e},this.title=this.lex.translate("Entidades"),this.code="MOD_ENTD",this.filter=this.fh.FormBuilder({nome:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG"),this.auth.hasPermissionTo("MOD_CFG_ENTD")&&this.options.push({icon:"bi bi-tools",label:"Configura\xE7\xF5es",onClick:t=>{this.go.navigate({route:["configuracoes","entidade",t.id,"conf"]},{modal:!0})}})}};a.\u0275fac=function(t){return new(t||a)(w(I))},a.\u0275cmp=y({type:a,selectors:[["app-entidade-list"]],viewQuery:function(t,e){if(t&1&&c(T,5),t&2){let i;f(i=h())&&(e.grid=i.first)}},features:[D],decls:12,vars:21,consts:[["class","my-2",4,"ngIf"],[3,"select","dao","orderBy","groupBy","join","selectable","hasEdit"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],[1,"row"],["controlName","nome","placeholder","Nome...",3,"size","label","control"],["title","Sigla","field","sigla"],["title","Nome","field","nome"],["title","Abrang\xEAncia","field","abrangencia"],["type","options",3,"onEdit","options"],[3,"rows"],[1,"my-2"]],template:function(t,e){t&1&&(C(0,Ge,2,1,"h3",0),d(1,"grid",1),N("select",function(u){return e.onSelect(u)}),C(2,Be,1,0,"toolbar",2),d(3,"filter",3)(4,"div",4),s(5,"input-text",5),m()(),d(6,"columns"),s(7,"column",6)(8,"column",7)(9,"column",8)(10,"column",9),m(),s(11,"pagination",10),m()),t&2&&(r("ngIf",!e.isModal),l(),r("dao",e.dao)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasEdit",e.auth.hasPermissionTo("MOD_ENTD_EDT")),l(),r("ngIf",!e.selectable),l(),r("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),l(2),r("size",12)("label","Nome "+e.lex.translate("entidade"))("control",e.filter.controls.nome),O("maxlength",250),l(5),r("onEdit",e.edit)("options",e.options),l(),r("rows",e.rowsLimit))},dependencies:[S,T,G,k,ne,ae,re,P]});let n=a;return n})();var je=[{path:"",component:be,canActivate:[F],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Entidades"}},{path:"new",component:x,canActivate:[F],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Inclus\xE3o de Entidade",modal:!0}},{path:":id/edit",component:x,canActivate:[F],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Edi\xE7\xE3o de Entidade",modal:!0}},{path:":id/conf",component:_e,canActivate:[F],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Configura\xE7\xF5es de Entidade",modal:!0}},{path:":id/consult",component:x,canActivate:[F],resolve:{config:M},runGuardsAndResolvers:"always",data:{title:"Consulta a Entidade",modal:!0}}],Ce=(()=>{let a=class a{};a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=V({type:a}),a.\u0275inj=z({imports:[K.forChild(je),K]});let n=a;return n})();var Gi=(()=>{let a=class a{};a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=V({type:a}),a.\u0275inj=z({imports:[Y,ue,Z,he,Ce]});let n=a;return n})();export{Gi as EntidadeModule};
