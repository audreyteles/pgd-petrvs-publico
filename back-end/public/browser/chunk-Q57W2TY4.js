import{Dc as T,Ec as U,Ic as O,Kc as A,O as f,R as g,ba as I,h as m,uc as _}from"./chunk-SDCVQHKS.js";var j=(()=>{let d=class d{constructor(e){this.injector=e,this.lookup=this.injector.get(O),this.lex=this.injector.get(A),this.dialog=this.injector.get(U),this.util=this.injector.get(T)}converterAtribuicoes(e){return e.map(i=>Object.assign({},{key:i,value:this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO,i),icon:this.lookup.getIcon(this.lookup.UNIDADE_INTEGRANTE_TIPO,i),color:this.lookup.getColor(this.lookup.UNIDADE_INTEGRANTE_TIPO,i)}))}haAlteracaoGestor(e,i,a,o){let t="",r=this.util.array_diff(i.atribuicoes,e).includes("GESTOR"),p=this.util.array_diff(e,i.atribuicoes).includes("GESTOR");if(!r&&!p)return["nenhuma",-1,"",!1];let u=this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR")+" "+this.lex.translate("da Unidade")+" ";if(r)return t=o.toUpperCase()+" deixar\xE1 de ser "+u+i.unidade_sigla?.toUpperCase()+".",["perda",-1,t,!1];let l=i.atribuicoes.includes("LOTADO");t=o.toUpperCase()+" passar\xE1 a ser "+u+i.unidade_sigla?.toUpperCase();let n=a.find(s=>s.atribuicoes.includes("GESTOR")),c=a.findIndex((s,E,b)=>s.atribuicoes.includes("LOTADO"));return t=n?.id.length?t+" e deixar\xE1 de ser "+u+n.unidade_sigla+". ":t+". ",!l&&c>=0&&(t+="Por consequ\xEAncia, sua lota\xE7\xE3o ser\xE1 alterada de "+a[c].unidade_sigla?.toUpperCase()+" para "+i.unidade_sigla?.toUpperCase()+"."),n?.id.length?["troca",a.findIndex(s=>s.id==n?.id),t,!0]:["ganho",-1,t,!l]}haAlteracaoGerencia(e,i,a,o){let t="",r=this.util.array_diff(i.atribuicoes,e).includes("GESTOR"),p=this.util.array_diff(e,i.atribuicoes).includes("GESTOR");if(!r&&!p)return["nenhuma",-1,"",!1];let u=this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR")+" "+this.lex.translate("da Unidade")+" ";if(r)return t=i.usuario_nome?.toUpperCase()+" deixar\xE1 de ser "+u+o.toUpperCase()+".",["perda",-1,t,!1];let l=i.atribuicoes.includes("LOTADO");t=i.usuario_nome?.toUpperCase()+" passar\xE1 a ser "+u+o.toUpperCase();let n=a.find(s=>s.atribuicoes.includes("GESTOR"));t=(n?.id.length?t+" em substitui\xE7\xE3o a "+n.usuario_nome?.toUpperCase():t)+". ";let c=a.findIndex((s,E,b)=>s.atribuicoes.includes("LOTADO"));return!l&&c>=0&&(t+="Como \xE9 lotado em outra unidade, a lota\xE7\xE3o de "+i.usuario_nome?.toUpperCase()+" ser\xE1 alterada para "+this.lex.translate("a Unidade")+" - "+o.toUpperCase()+"."),n?.id.length?["troca",a.findIndex(s=>s.id==n?.id),t,!0]:["ganho",-1,t,!l]}haAlteracaoLotacao(e,i,a,o){let t=e.controls.atribuicoes.value.map(l=>l.key),r=a.findIndex((l,n,c)=>l.atribuicoes.includes("LOTADO"));if(!t.includes("LOTADO")||r==-1)return[!1,-1,"",""];let p=this.lex.translate("A lota\xE7\xE3o")+" de "+o.toUpperCase()+" passar\xE1 de "+a[r].unidade_sigla?.toUpperCase()+" para "+i.unidade_sigla?.toUpperCase()+".",u="N\xE3o \xE9 poss\xEDvel alterar a lota\xE7\xE3o de "+o.toUpperCase()+" porque \xE9 Chefe da sua atual unidade de lota\xE7\xE3o - "+a[r].unidade_sigla?.toUpperCase()+".";return e.controls.unidade_id.value!=a[r].unidade_id?[!0,r,p,u]:[!1,-1,"",""]}inserirAtribuicao(e,i){let a=this.lookup.getLookup(this.lookup.UNIDADE_INTEGRANTE_TIPO,i);return a&&e.push(a),this.lookup.uniqueLookupItem(e)}ordenarIntegrantes(e){return e.sort((i,a)=>{let o=(i.usuario_nome||i.unidade_nome)?.toLowerCase(),t=(a.usuario_nome||a.unidade_nome)?.toLowerCase();return o<t?-1:o>t?1:0}),e.forEach(i=>{i.atribuicoes.sort()}),e}completarIntegrante(e,i,a,o){return Object.assign({},e,{unidade_id:i,usuario_id:a,atribuicoes:o})}ehPermitidoApagar(e){let a=!["LOTADO"].includes(e),o=e=="LOTADO"?"A lota\xE7\xE3o do servidor n\xE3o pode ser apagada. Para alter\xE1-la, lote-o em outra Unidade.":"";return m(this,null,function*(){a||(yield this.dialog.alert("N\xC3O PERMITIDO!",o))}),a}substituirItem(e,i,a){let o=e.itens.findIndex(p=>p.id==e.id),t=a instanceof _,r=t?{id:e.id,unidade_sigla:e.apelidoOuSigla,unidade_nome:e.nome,unidade_codigo:e.codigo}:{id:e.id,usuario_apelido:e.apelidoOuSigla,usuario_nome:e.nome};return e.itens[o]=this.completarIntegrante(r,t?e.id:a.id,t?a.id:e.id,i),e.itens}};d.\u0275fac=function(i){return new(i||d)(g(I))},d.\u0275prov=f({token:d,factory:d.\u0275fac,providedIn:"root"});let h=d;return h})();export{j as a};
