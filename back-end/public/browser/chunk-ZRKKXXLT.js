import{a as oe}from"./chunk-UFS3OPCG.js";import{b as re}from"./chunk-76VPKZU2.js";import{a as v,b as C}from"./chunk-RMYSPY7H.js";import{b as F,fa as ae,i as R,q as N,s as u,t as ne,v as le}from"./chunk-XHTD5OAS.js";import{b as Z,c as $,d as ee,e as te,h as ie,l as c,o as A,s as L}from"./chunk-KODYKPWY.js";import"./chunk-ORJB5SCJ.js";import{Bb as J,Fa as s,Fb as K,Ga as m,Ha as p,La as X,Ma as S,Na as w,P as T,U as E,Ua as P,V as g,Va as D,Wa as M,Xa as z,Ya as j,Z as q,Za as x,_ as W,ba as y,h as U,ic as Y,ma as l,na as _,oc as G,pd as O,sb as V,va as I,xa as f,ya as h,za as r,zb as H}from"./chunk-6YMI2QVU.js";function fe(n,t){n&1&&p(0,"toolbar")}function he(n,t){if(n&1&&(s(0,"small"),j(1),m(),p(2,"br")(3,"badge",14)(4,"badge",15)),n&2){let d=t.row,i=w();l(),x(d.titulo),l(2),r("label",d.numero),l(),r("icon",i.lookup.getIcon(i.lookup.TEMPLATE_ESPECIE,d.especie))("label",i.lookup.getValue(i.lookup.TEMPLATE_ESPECIE,d.especie))("color",i.lookup.getColor(i.lookup.TEMPLATE_ESPECIE,d.especie))}}function ve(n,t){if(n&1&&(s(0,"editable-form",16)(1,"div",2),p(2,"input-text",17),m(),s(3,"div"),p(4,"input-editor",18),m()()),n&2){let d=w();r("disabled",!0)("form",d.form),l(2),r("size",12)("control",d.form.controls.titulo),h("maxlength",250),l(2),r("size",12)("control",d.form.controls.conteudo)}}function Ce(n,t){n&1&&(s(0,"div",19),j(1," Nenhum template selecionado "),m())}function be(n,t){if(n&1&&p(0,"toolbar",20),n&2){let d=w();r("buttons",d.selectButtons)}}var se=(()=>{let t=class t extends re{constructor(i){super(i,c,O),this.injector=i,this.listagem=!1,this.selectButtons=[{color:"btn-outline-success",label:"Selecionar",icon:"bi-check-circle",disabled:()=>!this.selected,onClick:()=>this.onSelect(this.selected)},{color:"btn-outline-danger",label:"Cancelar",icon:"bi bi-dash-circle",onClick:()=>this.close()}],this._dataset=[],this.filterWhere=o=>{let e=[],a=o.value;if(this.listagem){this.addParams={especie:a.especie};let b=this.lookup.TEMPLATE_ESPECIE.find(B=>B.key===a.especie);this.title=this.lex.translate("Templates")+" - "+b?.value}return e.push(["especie","==",a.especie]),a.titulo?.length&&e.push(["titulo","like","%"+a.titulo.trim().replace(" ","%")+"%"]),e},this.templateService=i.get(A),this.title=this.lex.translate("Termos de Ci\xEAncia e Responsabilidade"),this.code="MOD_TEMP",this.modalWidth=1200,this.filter=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"}}),this.form=this.fh.FormBuilder({titulo:{default:""},conteudo:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_TEMP_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}ngAfterViewInit(){super.ngAfterViewInit(),this.addParams={especie:this.filter?.controls.especie.value},this.queryParams.modo=="listagem"?(this.title=this.lex.translate("Templates")+" - OUTRO",this.listagem=!0,this.options=this.options.filter(i=>i.label!=="Associar TCR")):(this.filter?.controls.especie.disable,this.auth.hasPermissionTo("MOD_TEMP_EDT")&&this.options.push({icon:"bi bi-check-all",label:"Associar TCR",onClick:(i=>this.go.navigate({route:["cadastros","template",i.id,"termos"]},{modalClose:o=>console.log(o?.conteudo)})).bind(this)}))}onTemplateSelect(i){this.selected=i||void 0,this.form.patchValue({titulo:this.selected?.titulo||"",conteudo:this.selected?.conteudo||""}),this.cdRef.detectChanges()}};t.\u0275fac=function(o){return new(o||t)(_(y))},t.\u0275cmp=E({type:t,selectors:[["app-template-list"]],viewQuery:function(o,e){if(o&1&&P(L,5),o&2){let a;D(a=M())&&(e.grid=a.first)}},features:[I],decls:20,vars:30,consts:[["columnTemplate",""],["noSelected",""],[1,"row"],[3,"ngClass"],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],["label","Esp\xE9cie","controlName","especie",3,"size","items"],["label","T\xEDtulo","controlName","titulo","placeholder","T\xEDtulo ...",3,"size","control"],["title","Template",3,"template"],["type","options",3,"onEdit","options"],[3,"rows"],["noButtons","",3,"disabled","form",4,"ngIf","ngIfElse"],[3,"buttons",4,"ngIf"],["icon","bi bi-hash",3,"label"],[3,"icon","label","color"],["noButtons","",3,"disabled","form"],["label","T\xEDtulo",3,"size","control"],["label","Pre-view do template",3,"size","control"],[1,"block","w-100","text-center"],[3,"buttons"]],template:function(o,e){if(o&1){let a=X();s(0,"div",2)(1,"div",3)(2,"grid",4),S("select",function(B){return q(a),W(e.onTemplateSelect(B))}),f(3,fe,1,0,"toolbar",5),s(4,"filter",6)(5,"div",2),p(6,"input-select",7),m(),s(7,"div",2),p(8,"input-text",8),m()(),s(9,"columns")(10,"column",9),f(11,he,5,5,"ng-template",null,0,V),m(),p(13,"column",10),m(),p(14,"pagination",11),m()(),s(15,"div",3),f(16,ve,5,7,"editable-form",12)(17,Ce,2,0,"ng-template",null,1,V),m()(),f(19,be,1,1,"toolbar",13)}if(o&2){let a=z(12),b=z(18);l(),r("ngClass",e.listagem?"col-12":"col-4"),l(),r("dao",e.dao)("add",e.add)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",e.auth.hasPermissionTo("MOD_TEMP_INCL"))("hasEdit",e.auth.hasPermissionTo("MOD_TEMP_EDT")),l(),r("ngIf",!e.selectable),l(),r("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),l(2),r("size",12)("items",e.lookup.TEMPLATE_ESPECIE),l(2),r("size",12)("control",e.filter.controls.titulo),h("maxlength",250),l(2),r("template",a),l(3),r("onEdit",e.edit)("options",e.options),l(),r("rows",e.rowsLimit),l(),r("ngClass",e.listagem?"d-none":"col-8"),l(),r("ngIf",e.selected)("ngIfElse",b),l(3),r("ngIf",e.selectable)}},dependencies:[H,J,L,ee,$,te,Z,ie,u,F,R,le,N]});let n=t;return n})();var k=(()=>{let t=class t extends oe{constructor(i){super(i,c,O),this.injector=i,this.dataset=[],this.validate=(o,e)=>null,this.templateService=i.get(A),this.modalWidth=1200,this.form=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"},conteudo:{default:""}},this.cdRef,this.validate)}loadData(i,o){return U(this,null,function*(){let e=Object.assign({},o.value);o.patchValue(this.util.fillForm(e,i)),this.dataset=yield this.templateService.dataset(o.controls.especie.value)})}initializeData(i){this.loadData(new c({especie:this.queryParams?.especie||"OUTRO"}),i)}saveData(i){return new Promise((o,e)=>{let a=this.util.fill(new c,this.entity);a.dataset=this.templateService.prepareDatasetToSave(this.dataset),o(this.util.fillForm(a,this.form.value))})}};t.\u0275fac=function(o){return new(o||t)(_(y))},t.\u0275cmp=E({type:t,selectors:[["app-template-form"]],viewQuery:function(o,e){if(o&1&&P(u,5),o&2){let a;D(a=M())&&(e.editableForm=a.first)}},features:[I],decls:7,vars:8,consts:[["initialFocus","titulo",3,"submit","cancel","form","disabled","title"],[1,"row"],["label","T\xEDtulo","icon","bi bi-upc","controlName","titulo","required","",3,"size"],["disabled","","label","Esp\xE9cie","controlName","especie",3,"size","items"],["title","Design"],["controlName","conteudo",3,"dataset"]],template:function(o,e){o&1&&(s(0,"editable-form",0),S("submit",function(){return e.onSaveData()})("cancel",function(){return e.onCancel()}),s(1,"div",1),p(2,"input-text",2)(3,"input-select",3),m(),p(4,"separator",4),s(5,"div",1),p(6,"input-editor",5),m()()),o&2&&(r("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),l(2),r("size",8),h("maxlength",250),l(),r("size",4)("items",e.lookup.TEMPLATE_ESPECIE),l(3),r("dataset",e.dataset))},dependencies:[u,F,R,ne,N]});let n=t;return n})();var Te=[{path:"",component:se,canActivate:[v],resolve:{config:C},runGuardsAndResolvers:"always",data:{title:"Template"}},{path:"new",component:k,canActivate:[v],resolve:{config:C},runGuardsAndResolvers:"always",data:{title:"Inclus\xE3o",modal:!0}},{path:":id/edit",component:k,canActivate:[v],resolve:{config:C},runGuardsAndResolvers:"always",data:{title:"Edi\xE7\xE3o",modal:!0}},{path:":id/consult",component:k,canActivate:[v],resolve:{config:C},runGuardsAndResolvers:"always",data:{title:"Consultar",modal:!0}}],me=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=g({type:t}),t.\u0275inj=T({imports:[G.forChild(Te),G]});let n=t;return n})();var it=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=g({type:t}),t.\u0275inj=T({imports:[K,ae,Y,me]});let n=t;return n})();export{it as TemplateModule};
