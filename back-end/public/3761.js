"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[3761],{23761:(E,v,r)=>{r.r(v),r.d(v,{ListenersModule:()=>g});var A=r(76733),f=r(55579),n=r(8239),y=r(25026),b=r(43972),l=r(40922),o=r(20755);class d extends l.x{constructor(e){super(e,"editor-montar"),this.injector=e,this.documentoDao=e.get(y.d)}ngOnInit(){super.ngOnInit()}documentoPendenteSei(e){var t=this;return(0,n.Z)(function*(){const a=yield t.documentoDao.documentoPendenteSei(e);if(a){const i=yield t.execute("setConteudoDocumento",[0,a.conteudo]);i?.length&&(yield t.documentoDao.update(a.id,{status:b.U.STATUS_GERADO,numero_documento:i}))}})()}loadToolbarButtons(e){var t=this;return(0,n.Z)(function*(){t.gb.toolbarButtons=[]})()}static#e=this.\u0275fac=function(t){return new(t||d)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:d,selectors:[["app-editor-montar"]],features:[o.qOj],decls:2,vars:0,template:function(t,a){1&t&&(o.TgZ(0,"p"),o._uU(1,"editor-montar works!"),o.qZA())}})}class u extends l.x{constructor(e){super(e,"petrvs-listener"),this.injector=e}ngOnInit(){}static#e=this.\u0275fac=function(t){return new(t||u)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:u,selectors:[["app-petrvs-listener"]],features:[o.qOj],decls:2,vars:0,template:function(t,a){1&t&&(o.TgZ(0,"p"),o._uU(1,"petrvs-listener works!"),o.qZA())}})}var z=r(70361);class p extends l.x{constructor(e){super(e,"procedimento_escolher_tipo"),this.injector=e,this.tipoProcessoDao=e.get(z.n)}ngOnInit(){super.ngOnInit()}loadToolbarButtons(){var e=this;return(0,n.Z)(function*(){e.gb.toolbarButtons=[{icon:"bi bi-folder-check",color:"btn-outline-primary",hint:"Atualizar tipos de processos",onClick:e.atualizarTiposProcessos.bind(e)}]})()}atualizarTiposProcessos(){var e=this;return(0,n.Z)(function*(){let t=yield e.execute("getTiposProcessos",[]);(yield e.tipoProcessoDao.atualizar(t))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}static#e=this.\u0275fac=function(t){return new(t||p)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:p,selectors:[["app-procedimento-escolher-tipo"]],features:[o.qOj],decls:2,vars:0,template:function(t,a){1&t&&(o.TgZ(0,"p"),o._uU(1,"procedimento-escolher-tipo works!"),o.qZA())}})}var C=r(949),T=r(15316),D=r(88340),O=r(88543),Z=r(89997),x=r(48644);class m extends l.x{constructor(e){super(e,"procedimento_trabalhar"),this.injector=e,this.dao=e.get(T.i),this.tipoDocumentoDao=e.get(D.Q)}loadToolbarButtons(e){var t=this;return(0,n.Z)(function*(){let a=[];if(e.includes("plano")&&a.push({icon:"bi bi-list-check",color:"btn-outline-primary",hint:"Gerar termo de ades\xe3o",onClick:t.gerarTermoAdesao.bind(t)}),e.includes("entrega")){let i=[];e.includes("concluir_entrega")&&i.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+t.lex.translate("entrega"),onClick:t.concluirEntrega.bind(t)}),a.push({icon:"bi bi-boxes",color:"btn-outline-secondary",hint:"Incluir "+t.lex.translate("entrega"),onClick:t.incluirEntrega.bind(t),items:i.length?i:void 0})}if(e.includes("atualizar")&&a.push({icon:"bi bi-file-check",color:"btn-outline-warning",hint:"Atualizar tipos de documentos",onClick:t.atualizarTiposDocumentos.bind(t)}),e.find(i=>["incluir","concluir","atividades"].includes(i))){let i=[];e.includes("incluir")&&i.push({icon:"bi bi-plus-circle",color:"btn-outline-primary",label:"Incluir "+t.lex.translate("atividade"),onClick:t.incluirAtividade.bind(t)}),e.includes("concluir")&&i.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+t.lex.translate("atividade"),onClick:t.concluirAtividade.bind(t)}),a.push({icon:"bi bi-activity",color:"btn-outline-success",hint:t.lex.translate("atividade"),onClick:t.atividades.bind(t),items:i.length?i:void 0})}t.gb.toolbarButtons=a})()}incluirAtividade(){var e=this;return(0,n.Z)(function*(){let t=yield e.execute("getSeiKeys",[]);t&&e.go.navigate({route:["gestao","atividade","new"]},{metadata:{sei:t},modal:!0})})()}atividades(){var e=this;return(0,n.Z)(function*(){let t=yield e.execute("getProcessoKeys",[]);t&&e.go.navigate({route:["gestao","atividade"],params:{filter:{numero_processo:t.numero_processo}}},{modal:!0,modalWidth:1200})})()}concluirAtividade(){var e=this;return(0,n.Z)(function*(){if(yield e.execute("getDocumentKeys",[])){const a=yield x.N.modalSelect({fixedFilter:[["status","==","INICIADO"]]});a&&(a.metadados?.pausado?(yield e.dialog.confirm("Atividade pausada","Para concluir \xe9 necess\xe1rio primeiro reiniciar a atividade. Deseja reiniciar?"))&&e.go.navigate({route:["gestao","atividade",a.id,"pausar"],params:{reiniciar:!0}},{modal:!0,modalClose:i=>{i?.length&&e.go.navigate({route:["gestao","atividade",a.id,"concluir"]},{modal:!0})}}):e.go.navigate({route:["gestao","atividade",a.id,"concluir"]},{modal:!0}))}})()}concluirEntrega(){var e=this;return(0,n.Z)(function*(){let t=yield e.execute("getProcessoKeys",[]);t&&e.go.navigate({route:["gestao","atividade","entrega","concluir"],params:{id_processo:t.id_processo}},{modal:!0})})()}incluirEntrega(){var e=this;return(0,n.Z)(function*(){let t=yield e.execute("getSeiKeys",[]);if(t){const a=yield x.N.modalSelect({fixedFilter:[["status","==","NAOCONCLUIDO"]]});if(a){const i=new O.l;i.id=e.dao.generateUuid(),i.usuario=e.auth.usuario,i.usuario_id=e.auth.usuario.id,i.atividade_id=a.id||"",i.comentarios=[],i._status="ADD",e.go.navigate({route:["gestao","atividade","tarefa"]},{metadata:{entrega:i,atividade:a,sei:t},modalClose:s=>{s&&(0,n.Z)(function*(){try{const c=e.injector.get(C.n);e.dialog.showSppinerOverlay("Salvando dados do formul\xe1rio"),yield c.save(s)}catch(c){e.dialog.alert("Error",c.message?c.message:c)}finally{e.dialog.closeSppinerOverlay()}})()}})}}})()}gerarTermoAdesao(){var e=this;return(0,n.Z)(function*(){const t=yield Z.H.modalSelect();if(t){let a=yield e.execute("getProcessoKeys",[]);e.go.navigate({route:["gestao","plano-trabalho","termo"]},{metadata:{plano:t,processo:a},modalClose:i=>{i?.termo?.length&&(0,n.Z)(function*(){e.dialog.showSppinerOverlay("Gerando documento no sei...");try{const s=yield e.execute("incluirDocumento",[a.id_processo,i.codigo_tipo_documento]);if(s){const c=e.injector.get(y.d),P=Object.assign(new b.U,{especie:"TCR",conteudo:i?.termo,id_processo:a.id_processo,id_documento:s.id_documento,numero_processo:s.numero_processo,plano_trabalho_id:t.id,tipo_documento_id:i.tipo_documento_id,status:"AGUARDANDO_SEI"});yield c.save(P),yield e.execute("recarregarArvore",[s.urlReload]),yield e.execute("abrirEditor",[s.urlEditor,s.idUser])}}catch(s){e.dialog.alert("Error",s.message?s.message:s)}finally{e.dialog.closeSppinerOverlay()}})()}})}})()}atualizarTiposDocumentos(){var e=this;return(0,n.Z)(function*(){let t=yield e.execute("getTiposDocumentos",[]);(yield e.tipoDocumentoDao.atualizar(t))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}static#e=this.\u0275fac=function(t){return new(t||m)(o.Y36(o.zs3))};static#t=this.\u0275cmp=o.Xpm({type:m,selectors:[["app-procedimento-trabalhar"]],features:[o.qOj],decls:2,vars:0,template:function(t,a){1&t&&(o.TgZ(0,"p"),o._uU(1,"procedimento-trabalhar works!"),o.qZA())}})}const S=[{path:"editor-montar",component:d},{path:"procedimento-trabalhar",component:m},{path:"procedimento-escolher-tipo",component:p},{path:"petrvs",component:u}];class h{static#e=this.\u0275fac=function(t){return new(t||h)};static#t=this.\u0275mod=o.oAB({type:h});static#o=this.\u0275inj=o.cJS({imports:[f.Bz.forChild(S),f.Bz]})}class g{static#e=this.\u0275fac=function(t){return new(t||g)};static#t=this.\u0275mod=o.oAB({type:g});static#o=this.\u0275inj=o.cJS({imports:[A.ez,h]})}}}]);