"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[3761],{23761:(F,f,r)=>{r.r(f),r.d(f,{ListenersModule:()=>Z});var m,p,P=r(76733),y=r(55579),s=r(8239),b=r(25026),C=r(43972),h=r(40922),t=r(20755);class x extends h.x{constructor(e){super(e,"editor-montar"),this.injector=e,this.documentoDao=e.get(b.d)}ngOnInit(){super.ngOnInit()}documentoPendenteSei(e){var o=this;return(0,s.Z)(function*(){const a=yield o.documentoDao.documentoPendenteSei(e);if(a){const i=yield o.execute("setConteudoDocumento",[0,a.conteudo]);i?.length&&(yield o.documentoDao.update(a.id,{status:C.U.STATUS_GERADO,numero_documento:i}))}})()}loadToolbarButtons(e){var o=this;return(0,s.Z)(function*(){o.gb.toolbarButtons=[]})()}}(m=x).\u0275fac=function(e){return new(e||m)(t.Y36(t.zs3))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-editor-montar"]],features:[t.qOj],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"editor-montar works!"),t.qZA())}});class A extends h.x{constructor(e){super(e,"petrvs-listener"),this.injector=e}ngOnInit(){}}(p=A).\u0275fac=function(e){return new(e||p)(t.Y36(t.zs3))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-petrvs-listener"]],features:[t.qOj],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"petrvs-listener works!"),t.qZA())}});var g,_=r(70361);class T extends h.x{constructor(e){super(e,"procedimento_escolher_tipo"),this.injector=e,this.tipoProcessoDao=e.get(_.n)}ngOnInit(){super.ngOnInit()}loadToolbarButtons(){var e=this;return(0,s.Z)(function*(){e.gb.toolbarButtons=[{icon:"bi bi-folder-check",color:"btn-outline-primary",hint:"Atualizar tipos de processos",onClick:e.atualizarTiposProcessos.bind(e)}]})()}atualizarTiposProcessos(){var e=this;return(0,s.Z)(function*(){let o=yield e.execute("getTiposProcessos",[]);(yield e.tipoProcessoDao.atualizar(o))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}}(g=T).\u0275fac=function(e){return new(e||g)(t.Y36(t.zs3))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-procedimento-escolher-tipo"]],features:[t.qOj],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"procedimento-escolher-tipo works!"),t.qZA())}});var v,d,E=r(949),S=r(15316),k=r(88340),I=r(88543),B=r(89997),z=r(48644);class D extends h.x{constructor(e){super(e,"procedimento_trabalhar"),this.injector=e,this.dao=e.get(S.i),this.tipoDocumentoDao=e.get(k.Q)}loadToolbarButtons(e){var o=this;return(0,s.Z)(function*(){let a=[];if(e.includes("plano")&&a.push({icon:"bi bi-list-check",color:"btn-outline-primary",hint:"Gerar termo de ades\xe3o",onClick:o.gerarTermoAdesao.bind(o)}),e.includes("entrega")){let i=[];e.includes("concluir_entrega")&&i.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+o.lex.translate("entrega"),onClick:o.concluirEntrega.bind(o)}),a.push({icon:"bi bi-boxes",color:"btn-outline-secondary",hint:"Incluir "+o.lex.translate("entrega"),onClick:o.incluirEntrega.bind(o),items:i.length?i:void 0})}if(e.includes("atualizar")&&a.push({icon:"bi bi-file-check",color:"btn-outline-warning",hint:"Atualizar tipos de documentos",onClick:o.atualizarTiposDocumentos.bind(o)}),e.find(i=>["incluir","concluir","atividades"].includes(i))){let i=[];e.includes("incluir")&&i.push({icon:"bi bi-plus-circle",color:"btn-outline-primary",label:"Incluir "+o.lex.translate("atividade"),onClick:o.incluirAtividade.bind(o)}),e.includes("concluir")&&i.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+o.lex.translate("atividade"),onClick:o.concluirAtividade.bind(o)}),a.push({icon:"bi bi-activity",color:"btn-outline-success",hint:o.lex.translate("atividade"),onClick:o.atividades.bind(o),items:i.length?i:void 0})}o.gb.toolbarButtons=a})()}incluirAtividade(){var e=this;return(0,s.Z)(function*(){let o=yield e.execute("getSeiKeys",[]);o&&e.go.navigate({route:["gestao","atividade","new"]},{metadata:{sei:o},modal:!0})})()}atividades(){var e=this;return(0,s.Z)(function*(){let o=yield e.execute("getProcessoKeys",[]);o&&e.go.navigate({route:["gestao","atividade"],params:{filter:{numero_processo:o.numero_processo}}},{modal:!0,modalWidth:1200})})()}concluirAtividade(){var e=this;return(0,s.Z)(function*(){if(yield e.execute("getDocumentKeys",[])){const a=yield z.N.modalSelect({fixedFilter:[["status","==","INICIADO"]]});a&&(a.metadados?.pausado?(yield e.dialog.confirm("Atividade pausada","Para concluir \xe9 necess\xe1rio primeiro reiniciar a atividade. Deseja reiniciar?"))&&e.go.navigate({route:["gestao","atividade",a.id,"pausar"],params:{reiniciar:!0}},{modal:!0,modalClose:i=>{i?.length&&e.go.navigate({route:["gestao","atividade",a.id,"concluir"]},{modal:!0})}}):e.go.navigate({route:["gestao","atividade",a.id,"concluir"]},{modal:!0}))}})()}concluirEntrega(){var e=this;return(0,s.Z)(function*(){let o=yield e.execute("getProcessoKeys",[]);o&&e.go.navigate({route:["gestao","atividade","entrega","concluir"],params:{id_processo:o.id_processo}},{modal:!0})})()}incluirEntrega(){var e=this;return(0,s.Z)(function*(){let o=yield e.execute("getSeiKeys",[]);if(o){const a=yield z.N.modalSelect({fixedFilter:[["status","==","NAOCONCLUIDO"]]});if(a){const i=new I.l;i.id=e.dao.generateUuid(),i.usuario=e.auth.usuario,i.usuario_id=e.auth.usuario.id,i.atividade_id=a.id||"",i.comentarios=[],i._status="ADD",e.go.navigate({route:["gestao","atividade","tarefa"]},{metadata:{entrega:i,atividade:a,sei:o},modalClose:c=>{c&&(0,s.Z)(function*(){try{const l=e.injector.get(E.n);e.dialog.showSppinerOverlay("Salvando dados do formul\xe1rio"),yield l.save(c)}catch(l){e.dialog.alert("Error",l.message?l.message:l)}finally{e.dialog.closeSppinerOverlay()}})()}})}}})()}gerarTermoAdesao(){var e=this;return(0,s.Z)(function*(){const o=yield B.H.modalSelect();if(o){let a=yield e.execute("getProcessoKeys",[]);e.go.navigate({route:["gestao","plano-trabalho","termo"]},{metadata:{plano:o,processo:a},modalClose:i=>{i?.termo?.length&&(0,s.Z)(function*(){e.dialog.showSppinerOverlay("Gerando documento no sei...");try{const c=yield e.execute("incluirDocumento",[a.id_processo,i.codigo_tipo_documento]);if(c){const l=e.injector.get(b.d),L=Object.assign(new C.U,{especie:"TCR",conteudo:i?.termo,id_processo:a.id_processo,id_documento:c.id_documento,numero_processo:c.numero_processo,plano_trabalho_id:o.id,tipo_documento_id:i.tipo_documento_id,status:"AGUARDANDO_SEI"});yield l.save(L),yield e.execute("recarregarArvore",[c.urlReload]),yield e.execute("abrirEditor",[c.urlEditor,c.idUser])}}catch(c){e.dialog.alert("Error",c.message?c.message:c)}finally{e.dialog.closeSppinerOverlay()}})()}})}})()}atualizarTiposDocumentos(){var e=this;return(0,s.Z)(function*(){let o=yield e.execute("getTiposDocumentos",[]);(yield e.tipoDocumentoDao.atualizar(o))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}}(v=D).\u0275fac=function(e){return new(e||v)(t.Y36(t.zs3))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-procedimento-trabalhar"]],features:[t.qOj],decls:2,vars:0,template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"procedimento-trabalhar works!"),t.qZA())}});const U=[{path:"editor-montar",component:x},{path:"procedimento-trabalhar",component:D},{path:"procedimento-escolher-tipo",component:T},{path:"petrvs",component:A}];class O{}var u;(d=O).\u0275fac=function(e){return new(e||d)},d.\u0275mod=t.oAB({type:d}),d.\u0275inj=t.cJS({imports:[y.Bz.forChild(U),y.Bz]});class Z{}(u=Z).\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[P.ez,O]})}}]);