"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[6224],{36224:(ie,C,o)=>{o.r(C),o.d(C,{PreferenciaModule:()=>E});var m,d=o(76733),I=o(55579),y=o(1391),P=o(2314),l=o(8239),s=o(74040),b=o(1184),f=o(26898),A=o(35255),e=o(20755),Z=o(45512),J=o(88820),D=o(92392),N=o(64603),z=o(66848),S=o(17819),O=o(25560),R=o(92739);const B=["notificacoes"];function G(n,a){1&n&&(e.TgZ(0,"div",10)(1,"div",11),e._UZ(2,"span",12),e.qZA()())}function j(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"separator",14)(2,"div",3),e._UZ(3,"input-switch",15)(4,"input-switch",16),e.qZA()(),e.TgZ(5,"separator",17),e._UZ(6,"input-select",18),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("title","Prefer\xeancias de exibi\xe7\xe3o "+t.lex.translate("usu\xe1rio")),e.xp6(2),e.Q6J("size",12)("label","Ocultar menu lateral do sei no Controle de "+t.lex.translate("Processo")),e.xp6(1),e.Q6J("size",12),e.xp6(2),e.Q6J("items",t.lookup.THEMES)}}function H(n,a){if(1&n&&(e.TgZ(0,"separator",19),e._UZ(1,"notificacoes-config",20,21),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("entity",t.entity)("disabled",t.formDisabled)}}class g extends b.F{constructor(a){super(a,f.b,A.q),this.injector=a,this.etiquetas=!1,this.carregando=!1,this.toolbarButtons=[{label:"Resetar",icon:"bi bi-backspace",onClick:()=>{this.loading=!0,this.dao.update(this.usuarioId,{config:new f.x}).then(t=>{this.initializeData(this.form)}).finally(()=>{this.loading=!1})}}],this.validate=(t,i)=>null,this.titleEdit=t=>"Editando "+this.lex.translate("Prefer\xeancia")+" "+this.lex.translate("do Usu\xe1rio")+": "+(t?.apelido||""),this.form=this.fh.FormBuilder({etiquetas:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null},theme:{default:null},ocultar_menu_sei:{default:!0},ocultar_container_petrvs:{default:!1}},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}ngOnInit(){super.ngOnInit(),this.urlParams.get("id")&&(this.usuarioId=this.urlParams.get("id")),this.etiquetas=!!this.queryParams.etiquetas}loadData(a,t){var i=this;return(0,l.Z)(function*(){let r=Object.assign({},t.value);r=i.util.fillForm(r,a.config||{}),r=i.util.fillForm(r,a.notificacoes||{}),t.patchValue(r)})()}initializeData(a){var t=this;return(0,l.Z)(function*(){t.carregando=!0;try{t.entity=yield t.dao.getById(t.usuarioId),yield t.loadData(t.entity,a)}finally{t.carregando=!1}})()}saveData(a){return new Promise((t,i)=>{this.notificacoes?.saveData();let r=this.util.fill(new f.x,this.form.value);Promise.all([this.auth.updateUsuarioConfig(this.usuarioId,r),this.auth.updateUsuarioNotificacoes(this.usuarioId,this.entity.notificacoes)]).then(te=>{this.usuarioId==this.auth.usuario.id?this.auth.authSession().then(ae=>t(!this.isPanel)).catch(i):t(!this.isPanel)}).catch(i)})}addItemHandleEtiquetas(){let a;const t=this.form.controls.etiqueta_texto.value,i=this.util.textHash(t);return t?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,i)&&(a={key:i,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),a}}(m=g).\u0275fac=function(a){return new(a||m)(e.Y36(e.zs3))},m.\u0275cmp=e.Xpm({type:m,selectors:[["preferencia-form-usuario"]],viewQuery:function(a,t){if(1&a&&(e.Gf(s.Q,5),e.Gf(B,5)),2&a){let i;e.iGM(i=e.CRH())&&(t.editableForm=i.first),e.iGM(i=e.CRH())&&(t.notificacoes=i.first)}},inputs:{panel:"panel",usuarioId:"usuarioId"},features:[e.qOj],decls:12,vars:17,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"buttons"],[3,"form","noButtons","submit","cancel"],[1,"row"],["class","col-md-6",4,"ngIf"],["label","Etiquetas","multiselectStyle","inline","controlName","etiquetas",3,"size","addItemHandle"],["label","Texto","controlName","etiqueta_texto",3,"size"],["label","\xcdcone","icon","fas fa-sign-out-alt","controlName","etiqueta_icone","liveSearch","",3,"size","items"],["label","Cor","controlName","etiqueta_cor",3,"size"],["transparent","","title","Notifica\xe7\xf5es",4,"ngIf"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"col-md-6"],["transparent","",3,"title"],["scale","small","labelPosition","right","controlName","ocultar_menu_sei",3,"size","label"],["scale","small","labelPosition","right","label","Ocultar o container Petrvs","controlName","ocultar_container_petrvs",3,"size"],["transparent","","title","Tema"],["controlName","theme",3,"items"],["transparent","","title","Notifica\xe7\xf5es"],[3,"entity","disabled"],["notificacoes",""]],template:function(a,t){1&a&&(e.YNc(0,G,3,0,"div",0),e.TgZ(1,"div"),e._UZ(2,"toolbar",1),e.TgZ(3,"editable-form",2),e.NdJ("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),e.TgZ(4,"div",3),e.YNc(5,j,7,5,"div",4),e.TgZ(6,"div")(7,"input-multiselect",5),e._UZ(8,"input-text",6)(9,"input-select",7)(10,"input-color",8),e.qZA()()(),e.YNc(11,H,3,2,"separator",9),e.qZA()()),2&a&&(e.Q6J("ngIf",t.carregando),e.xp6(1),e.ekj("d-none",t.carregando),e.xp6(1),e.Q6J("buttons",t.toolbarButtons),e.xp6(1),e.Q6J("form",t.form)("noButtons",t.isPanel?"true":void 0),e.xp6(2),e.Q6J("ngIf",!t.etiquetas),e.xp6(1),e.Tol(t.etiquetas?"col-md-12":"col-md-6"),e.xp6(1),e.Q6J("size",12)("addItemHandle",t.addItemHandleEtiquetas.bind(t)),e.xp6(1),e.Q6J("size",5),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",3)("items",t.lookup.ICONES),e.xp6(1),e.Q6J("size",4),e.xp6(1),e.Q6J("ngIf",t.entity&&!t.etiquetas))},dependencies:[d.O5,Z.n,s.Q,J.a,D.m,N.p,z.z,S.p,O.N,R.y]});var p,M=o(17112),_=o(22469),V=o(15316);function Y(n,a){1&n&&(e.TgZ(0,"div",2)(1,"div",3),e._UZ(2,"span",4),e.qZA()())}class F extends b.F{constructor(a){super(a,_.H,V.i),this.injector=a,this.carregando=!1,this.validate=(t,i)=>null,this.titleEdit=t=>"Editando "+this.lex.translate("Prefer\xeancia")+" "+this.lex.translate("da Entidade")+": "+(t?.nome||""),this.form=this.fh.FormBuilder({},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}loadData(a,t){var i=this;return(0,l.Z)(function*(){let r=Object.assign({},t.value);t.patchValue(i.util.fillForm(r,a))})()}initializeData(a){var t=this;return(0,l.Z)(function*(){t.carregando=!0;try{t.entity=new _.H,yield t.loadData(t.entity,a)}finally{t.carregando=!1}})()}saveData(a){return new Promise((t,i)=>{t(!this.isPanel)})}}(p=F).\u0275fac=function(a){return new(a||p)(e.Y36(e.zs3))},p.\u0275cmp=e.Xpm({type:p,selectors:[["preferencia-form-petrvs"]],viewQuery:function(a,t){if(1&a&&e.Gf(s.Q,5),2&a){let i;e.iGM(i=e.CRH())&&(t.editableForm=i.first)}},inputs:{panel:"panel"},features:[e.qOj],decls:4,vars:5,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"form","noButtons","submit","cancel"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(a,t){1&a&&(e.YNc(0,Y,3,0,"div",0),e.TgZ(1,"div")(2,"editable-form",1),e.NdJ("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),e._uU(3," Em desenvolvimento "),e.qZA()()),2&a&&(e.Q6J("ngIf",t.carregando),e.xp6(1),e.ekj("d-none",t.carregando),e.xp6(1),e.Q6J("form",t.form)("noButtons",t.isPanel?"true":void 0))},dependencies:[d.O5,s.Q]});var h,T=o(66384),U=o(74978);function X(n,a){if(1&n&&(e.TgZ(0,"tab",9),e._uU(1," Em desenvolvimento "),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.lex.translate("Entidade"))}}class Q extends M._{constructor(a){super(a),this.injector=a,this.mensagemCarregando="Carregando dados do formul\xe1rio...",this.mensagemSalvando="Salvando dados do formul\xe1rio...",this.form=this.fh.FormBuilder({})}get forceInvalid(){return!!this.petrvs?.form?.invalid||!!this.usuario?.form?.invalid}onSaveData(){var a=this;return(0,l.Z)(function*(){if(a.forceInvalid)a.petrvs?.form?.invalid||(a.editableForm.error="Form Petrvs com erro"),a.usuario?.form?.invalid||(a.editableForm.error="Form do usu\xe1rio com erro");else{a.submitting=!0;try{yield Promise.all([a.petrvs?.onSaveData(),a.usuario?.onSaveData()]),a.dialog.alert("Aten\xe7\xe3o","Algumas modifica\xe7\xf5es s\xf3 surtir\xe3o efeito ap\xf3s atualizar a p\xe1gina.\nPor motivos de seguran\xe7a esse procedimento, de atualizar a pagina, dever\xe1 ser executado pelo usu\xe1rio."),a.go.back()}catch(t){a.editableForm.error=t.message?t.message:t}finally{a.submitting=!1}}})()}onCancel(){this.close()}}(h=Q).\u0275fac=function(a){return new(a||h)(e.Y36(e.zs3))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-preferencia-form"]],viewQuery:function(a,t){if(1&a&&(e.Gf(s.Q,5),e.Gf(F,5),e.Gf(g,5)),2&a){let i;e.iGM(i=e.CRH())&&(t.editableForm=i.first),e.iGM(i=e.CRH())&&(t.petrvs=i.first),e.iGM(i=e.CRH())&&(t.usuario=i.first)}},features:[e.qOj],decls:9,vars:6,consts:[[3,"form","forceInvalid","title","submit","cancel"],["display","","right",""],["key","USUARIO",3,"label"],["panel","",3,"usuarioId"],["usuario",""],["key","PETRVS","label","Petrvs"],["panel",""],["petrvs",""],["key","ENTIDADE",3,"label",4,"ngIf"],["key","ENTIDADE",3,"label"]],template:function(a,t){1&a&&(e.TgZ(0,"editable-form",0),e.NdJ("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),e.TgZ(1,"tabs",1)(2,"tab",2),e._UZ(3,"preferencia-form-usuario",3,4),e.qZA(),e.TgZ(5,"tab",5),e._UZ(6,"preferencia-form-petrvs",6,7),e.qZA(),e.YNc(8,X,2,1,"tab",8),e.qZA()()),2&a&&(e.Q6J("form",t.form)("forceInvalid",t.forceInvalid)("title",t.isModal?"":t.title),e.xp6(2),e.Q6J("label",t.lex.translate("Usu\xe1rio")),e.xp6(1),e.Q6J("usuarioId",t.auth.usuario.id),e.xp6(5),e.Q6J("ngIf",t.auth.entidade))},dependencies:[d.O5,s.Q,T.n,U.i,F,g]});var v,u,L=o(81214),w=o(53937);function K(n,a){1&n&&(e.TgZ(0,"div",6)(1,"div",7),e._UZ(2,"span",8),e.qZA()())}class x extends b.F{constructor(a){super(a,w.b,L.J),this.injector=a,this.etiquetas=!1,this.carregando=!1,this.toolbarButtons=[{label:"Resetar",icon:"bi bi-backspace",onClick:()=>{this.loading=!0,this.dao.update(this.usuarioId,{config:new f.x}).then(t=>{this.initializeData(this.form)}).finally(()=>{this.loading=!1})}}],this.validate=(t,i)=>null,this.form=this.fh.FormBuilder({etiquetas:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null},theme:{default:null},ocultar_menu_sei:{default:!0},ocultar_container_petrvs:{default:!1}},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}ngOnInit(){super.ngOnInit(),this.urlParams.get("id")&&(this.usuarioId=this.urlParams.get("id")),this.etiquetas=!!this.queryParams.etiquetas}loadData(a,t){return(0,l.Z)(function*(){let i=Object.assign({},t.value);t.patchValue(i)})()}initializeData(a){var t=this;return(0,l.Z)(function*(){t.carregando=!0;try{t.entity=yield t.dao.getById(t.usuarioId),yield t.loadData(t.entity,a)}finally{t.carregando=!1}})()}saveData(a){return new Promise((t,i)=>{let r=this.util.fill(new f.x,this.form.value);Promise.all([this.auth.updateUsuarioConfig(this.usuarioId,r),this.auth.updateUsuarioNotificacoes(this.usuarioId,this.entity.notificacoes)]).then(te=>{this.usuarioId==this.auth.usuario.id?this.auth.authSession().then(ae=>t(!this.isPanel)).catch(i):t(!this.isPanel)}).catch(i)})}addItemHandleEtiquetas(){let a;const t=this.form.controls.etiqueta_texto.value,i=this.util.textHash(t);return t?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,i)&&(a={key:i,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),a}}(v=x).\u0275fac=function(a){return new(a||v)(e.Y36(e.zs3))},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-preferencia-form-unidade"]],viewQuery:function(a,t){if(1&a&&e.Gf(s.Q,5),2&a){let i;e.iGM(i=e.CRH())&&(t.editableForm=i.first)}},inputs:{panel:"panel",usuarioId:"usuarioId"},features:[e.qOj],decls:7,vars:7,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"buttons"],[3,"title","form","disabled","submit","cancel"],["display","","right",""],["key","ETIQUETAS","label","Etiquetas"],["key","ATRIBUICOES","label","Atribui\xe7\xf5es"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(a,t){1&a&&(e.YNc(0,K,3,0,"div",0),e.TgZ(1,"div"),e._UZ(2,"toolbar",1),e.TgZ(3,"editable-form",2),e.NdJ("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),e.TgZ(4,"tabs",3),e._UZ(5,"tab",4)(6,"tab",5),e.qZA()()()),2&a&&(e.Q6J("ngIf",t.carregando),e.xp6(1),e.ekj("d-none",t.carregando),e.xp6(1),e.Q6J("buttons",t.toolbarButtons),e.xp6(1),e.Q6J("title",t.isModal?"":t.title)("form",t.form)("disabled",t.formDisabled))},dependencies:[d.O5,Z.n,s.Q,T.n,U.i]});const W=[{path:"",component:Q,canActivate:[y.a],resolve:{config:P.o},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias"}},{path:"usuario/:id",component:g,canActivate:[y.a],resolve:{config:P.o},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias do Usu\xe1rio"}},{path:"unidade/:id",component:x,canActivate:[y.a],resolve:{config:P.o},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias da Unidade"}}];class q{}(u=q).\u0275fac=function(a){return new(a||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({imports:[I.Bz.forChild(W),I.Bz]});var c,$=o(58568),k=o(72133),ee=o(32864);class E{}(c=E).\u0275fac=function(a){return new(a||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[d.ez,$.K,k.UX,q,ee.UteisModule]})}}]);