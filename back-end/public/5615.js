"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[5615],{75615:(x,g,l)=>{l.r(g),l.d(g,{TemplateModule:()=>h});var f=l(76733),v=l(55579),c=l(1391),d=l(2314),m=l(98409),E=l(99230),b=l(73150),P=l(78509),C=l(49367),t=l(20755),Q=l(57224),y=l(83351),I=l(57765),M=l(45512),J=l(42704),T=l(74040),A=l(92392),Z=l(64603),D=l(95489),O=l(55795);function S(a,i){1&a&&t._UZ(0,"toolbar")}function U(a,i){if(1&a&&(t.TgZ(0,"small"),t._uU(1),t.qZA(),t._UZ(2,"br")(3,"badge",14)(4,"badge",15)),2&a){const o=i.row,e=t.oxw();t.xp6(1),t.Oqu(o.titulo),t.xp6(2),t.Q6J("label",o.numero),t.xp6(1),t.Q6J("icon",e.lookup.getIcon(e.lookup.TEMPLATE_ESPECIE,o.especie))("label",e.lookup.getValue(e.lookup.TEMPLATE_ESPECIE,o.especie))("color",e.lookup.getColor(e.lookup.TEMPLATE_ESPECIE,o.especie))}}function L(a,i){if(1&a&&(t.TgZ(0,"editable-form",16)(1,"div",0),t._UZ(2,"input-text",17),t.qZA(),t.TgZ(3,"div"),t._UZ(4,"input-editor",18),t.qZA()()),2&a){const o=t.oxw();t.Q6J("disabled",!0)("form",o.form),t.xp6(2),t.Q6J("size",12)("control",o.form.controls.titulo),t.uIk("maxlength",250),t.xp6(2),t.Q6J("size",12)("control",o.form.controls.conteudo)}}function N(a,i){1&a&&(t.TgZ(0,"div",19),t._uU(1," Nenhum template selecionado "),t.qZA())}function z(a,i){if(1&a&&t._UZ(0,"toolbar",20),2&a){const o=t.oxw();t.Q6J("buttons",o.selectButtons)}}class p extends P.E{constructor(i){super(i,m.Y,E.w),this.injector=i,this.listagem=!1,this.selectButtons=[{color:"btn-outline-success",label:"Selecionar",icon:"bi-check-circle",disabled:()=>!this.selected,onClick:()=>this.onSelect(this.selected)},{color:"btn-outline-danger",label:"Cancelar",icon:"bi bi-dash-circle",onClick:()=>this.close()}],this._dataset=[],this.filterWhere=o=>{let e=[],s=o.value;if(this.listagem){this.addParams={especie:s.especie};const r=this.lookup.TEMPLATE_ESPECIE.find(j=>j.key===s.especie);this.title=this.lex.translate("Templates")+" - "+r?.value}return e.push(["especie","==",s.especie]),s.titulo?.length&&e.push(["titulo","like","%"+s.titulo.trim().replace(" ","%")+"%"]),e},this.templateService=i.get(C.E),this.title=this.lex.translate("Termos de Ci\xeancia e Responsabilidade"),this.code="MOD_TEMP",this.modalWidth=1200,this.filter=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"}}),this.form=this.fh.FormBuilder({titulo:{default:""},conteudo:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_TEMP_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}ngAfterViewInit(){super.ngAfterViewInit(),this.addParams={especie:this.filter?.controls.especie.value},"listagem"==this.queryParams.modo?(this.title=this.lex.translate("Templates")+" - OUTRO",this.listagem=!0,this.options=this.options.filter(i=>"Associar TCR"!==i.label)):(this.filter?.controls.especie.disable,this.auth.hasPermissionTo("MOD_TEMP_EDT")&&this.options.push({icon:"bi bi-check-all",label:"Associar TCR",onClick:(i=>this.go.navigate({route:["cadastros","template",i.id,"termos"]},{modalClose:o=>console.log(o?.conteudo)})).bind(this)}))}onTemplateSelect(i){this.selected=i||void 0,this.form.patchValue({titulo:this.selected?.titulo||"",conteudo:this.selected?.conteudo||""}),this.cdRef.detectChanges()}static#t=this.\u0275fac=function(o){return new(o||p)(t.Y36(t.zs3))};static#e=this.\u0275cmp=t.Xpm({type:p,selectors:[["app-template-list"]],viewQuery:function(o,e){if(1&o&&t.Gf(b.M,5),2&o){let s;t.iGM(s=t.CRH())&&(e.grid=s.first)}},features:[t.qOj],decls:20,vars:30,consts:[[1,"row"],[3,"ngClass"],[3,"dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","select"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],["label","Esp\xe9cie","controlName","especie",3,"size","items"],["label","T\xedtulo","controlName","titulo","placeholder","T\xedtulo ...",3,"size","control"],["title","Template",3,"template"],["columnTemplate",""],["type","options",3,"onEdit","options"],[3,"rows"],["noButtons","",3,"disabled","form",4,"ngIf","ngIfElse"],["noSelected",""],[3,"buttons",4,"ngIf"],["icon","bi bi-hash",3,"label"],[3,"icon","label","color"],["noButtons","",3,"disabled","form"],["label","T\xedtulo",3,"size","control"],["label","Pre-view do template",3,"size","control"],[1,"block","w-100","text-center"],[3,"buttons"]],template:function(o,e){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"grid",2),t.NdJ("select",function(r){return e.onTemplateSelect(r)}),t.YNc(3,S,1,0,"toolbar",3),t.TgZ(4,"filter",4)(5,"div",0),t._UZ(6,"input-select",5),t.qZA(),t.TgZ(7,"div",0),t._UZ(8,"input-text",6),t.qZA()(),t.TgZ(9,"columns")(10,"column",7),t.YNc(11,U,5,5,"ng-template",null,8,t.W1O),t.qZA(),t._UZ(13,"column",9),t.qZA(),t._UZ(14,"pagination",10),t.qZA()(),t.TgZ(15,"div",1),t.YNc(16,L,5,7,"editable-form",11),t.YNc(17,N,2,0,"ng-template",null,12,t.W1O),t.qZA()(),t.YNc(19,z,1,1,"toolbar",13)),2&o){const s=t.MAs(12),r=t.MAs(18);t.xp6(1),t.Q6J("ngClass",e.listagem?"col-12":"col-4"),t.xp6(1),t.Q6J("dao",e.dao)("add",e.add)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",e.auth.hasPermissionTo("MOD_TEMP_INCL"))("hasEdit",e.auth.hasPermissionTo("MOD_TEMP_EDT")),t.xp6(1),t.Q6J("ngIf",!e.selectable),t.xp6(1),t.Q6J("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),t.xp6(2),t.Q6J("size",12)("items",e.lookup.TEMPLATE_ESPECIE),t.xp6(2),t.Q6J("size",12)("control",e.filter.controls.titulo),t.uIk("maxlength",250),t.xp6(2),t.Q6J("template",s),t.xp6(3),t.Q6J("onEdit",e.edit)("options",e.options),t.xp6(1),t.Q6J("rows",e.rowsLimit),t.xp6(1),t.Q6J("ngClass",e.listagem?"d-none":"col-8"),t.xp6(1),t.Q6J("ngIf",e.selected)("ngIfElse",r),t.xp6(3),t.Q6J("ngIf",e.selectable)}},dependencies:[f.mk,f.O5,b.M,Q.a,y.b,I.z,M.n,J.Q,T.Q,A.m,Z.p,D.F,O.G]})}var F=l(8239),B=l(1184),R=l(25560);class n extends B.F{constructor(i){super(i,m.Y,E.w),this.injector=i,this.dataset=[],this.validate=(o,e)=>null,this.templateService=i.get(C.E),this.modalWidth=1200,this.form=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"},conteudo:{default:""}},this.cdRef,this.validate)}loadData(i,o){var e=this;return(0,F.Z)(function*(){let s=Object.assign({},o.value);o.patchValue(e.util.fillForm(s,i)),e.dataset=yield e.templateService.dataset(o.controls.especie.value)})()}initializeData(i){this.loadData(new m.Y({especie:this.queryParams?.especie||"OUTRO"}),i)}saveData(i){return new Promise((o,e)=>{const s=this.util.fill(new m.Y,this.entity);s.dataset=this.templateService.prepareDatasetToSave(this.dataset),o(this.util.fillForm(s,this.form.value))})}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(t.zs3))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-template-form"]],viewQuery:function(o,e){if(1&o&&t.Gf(T.Q,5),2&o){let s;t.iGM(s=t.CRH())&&(e.editableForm=s.first)}},features:[t.qOj],decls:7,vars:8,consts:[["initialFocus","titulo",3,"form","disabled","title","submit","cancel"],[1,"row"],["label","T\xedtulo","icon","bi bi-upc","controlName","titulo","required","",3,"size"],["disabled","","label","Esp\xe9cie","controlName","especie",3,"size","items"],["title","Design"],["controlName","conteudo",3,"dataset"]],template:function(o,e){1&o&&(t.TgZ(0,"editable-form",0),t.NdJ("submit",function(){return e.onSaveData()})("cancel",function(){return e.onCancel()}),t.TgZ(1,"div",1),t._UZ(2,"input-text",2)(3,"input-select",3),t.qZA(),t._UZ(4,"separator",4),t.TgZ(5,"div",1),t._UZ(6,"input-editor",5),t.qZA()()),2&o&&(t.Q6J("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),t.xp6(2),t.Q6J("size",8),t.uIk("maxlength",250),t.xp6(1),t.Q6J("size",4)("items",e.lookup.TEMPLATE_ESPECIE),t.xp6(3),t.Q6J("dataset",e.dataset))},dependencies:[T.Q,A.m,Z.p,R.N,O.G]})}const G=[{path:"",component:p,canActivate:[c.a],resolve:{config:d.o},runGuardsAndResolvers:"always",data:{title:"Template"}},{path:"new",component:n,canActivate:[c.a],resolve:{config:d.o},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o",modal:!0}},{path:":id/edit",component:n,canActivate:[c.a],resolve:{config:d.o},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o",modal:!0}},{path:":id/consult",component:n,canActivate:[c.a],resolve:{config:d.o},runGuardsAndResolvers:"always",data:{title:"Consultar",modal:!0}}];class u{static#t=this.\u0275fac=function(o){return new(o||u)};static#e=this.\u0275mod=t.oAB({type:u});static#o=this.\u0275inj=t.cJS({imports:[v.Bz.forChild(G),v.Bz]})}var Y=l(31415),w=l(72133);class h{static#t=this.\u0275fac=function(o){return new(o||h)};static#e=this.\u0275mod=t.oAB({type:h});static#o=this.\u0275inj=t.cJS({imports:[f.ez,Y.K,w.UX,u]})}}}]);