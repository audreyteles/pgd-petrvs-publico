"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[5615],{75615:(H,v,l)=>{l.r(v),l.d(v,{TemplateModule:()=>Q});var m,h=l(76733),g=l(55579),p=l(1391),c=l(2314),u=l(98409),E=l(99230),b=l(73150),y=l(78509),C=l(49367),e=l(20755),I=l(57224),J=l(83351),D=l(57765),L=l(45512),S=l(42704),T=l(74040),A=l(92392),Z=l(64603),U=l(95489),O=l(55795);function F(i,o){1&i&&e._UZ(0,"toolbar")}function N(i,o){if(1&i&&(e.TgZ(0,"small"),e._uU(1),e.qZA(),e._UZ(2,"br")(3,"badge",14)(4,"badge",15)),2&i){const t=o.row,s=e.oxw();e.xp6(1),e.Oqu(t.titulo),e.xp6(2),e.Q6J("label",t.numero),e.xp6(1),e.Q6J("icon",s.lookup.getIcon(s.lookup.TEMPLATE_ESPECIE,t.especie))("label",s.lookup.getValue(s.lookup.TEMPLATE_ESPECIE,t.especie))("color",s.lookup.getColor(s.lookup.TEMPLATE_ESPECIE,t.especie))}}function z(i,o){if(1&i&&(e.TgZ(0,"editable-form",16)(1,"div",0),e._UZ(2,"input-text",17),e.qZA(),e.TgZ(3,"div"),e._UZ(4,"input-editor",18),e.qZA()()),2&i){const t=e.oxw();e.Q6J("disabled",!0)("form",t.form),e.xp6(2),e.Q6J("size",12)("control",t.form.controls.titulo),e.uIk("maxlength",250),e.xp6(2),e.Q6J("size",12)("control",t.form.controls.conteudo)}}function R(i,o){1&i&&(e.TgZ(0,"div",19),e._uU(1," Nenhum template selecionado "),e.qZA())}function B(i,o){if(1&i&&e._UZ(0,"toolbar",20),2&i){const t=e.oxw();e.Q6J("buttons",t.selectButtons)}}class M extends y.E{constructor(o){super(o,u.Y,E.w),this.injector=o,this.listagem=!1,this.selectButtons=[{color:"btn-outline-success",label:"Selecionar",icon:"bi-check-circle",disabled:()=>!this.selected,onClick:()=>this.onSelect(this.selected)},{color:"btn-outline-danger",label:"Cancelar",icon:"bi bi-dash-circle",onClick:()=>this.close()}],this._dataset=[],this.filterWhere=t=>{let s=[],a=t.value;if(this.listagem){this.addParams={especie:a.especie};const W=this.lookup.TEMPLATE_ESPECIE.find(X=>X.key===a.especie);this.title=this.lex.translate("Templates")+" - "+W?.value}return s.push(["especie","==",a.especie]),a.titulo?.length&&s.push(["titulo","like","%"+a.titulo.trim().replace(" ","%")+"%"]),s},this.templateService=o.get(C.E),this.title=this.lex.translate("Termos de Ci\xeancia e Responsabilidade"),this.code="MOD_TEMP",this.modalWidth=1200,this.filter=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"}}),this.form=this.fh.FormBuilder({titulo:{default:""},conteudo:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_TEMP_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}ngAfterViewInit(){super.ngAfterViewInit(),this.addParams={especie:this.filter?.controls.especie.value},"listagem"==this.queryParams.modo?(this.title=this.lex.translate("Templates")+" - OUTRO",this.listagem=!0,this.options=this.options.filter(o=>"Associar TCR"!==o.label)):(this.filter?.controls.especie.disable,this.auth.hasPermissionTo("MOD_TEMP_EDT")&&this.options.push({icon:"bi bi-check-all",label:"Associar TCR",onClick:(o=>this.go.navigate({route:["cadastros","template",o.id,"termos"]},{modalClose:t=>console.log(t?.conteudo)})).bind(this)}))}onTemplateSelect(o){this.selected=o||void 0,this.form.patchValue({titulo:this.selected?.titulo||"",conteudo:this.selected?.conteudo||""}),this.cdRef.detectChanges()}}(m=M).\u0275fac=function(o){return new(o||m)(e.Y36(e.zs3))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-template-list"]],viewQuery:function(o,t){if(1&o&&e.Gf(b.M,5),2&o){let s;e.iGM(s=e.CRH())&&(t.grid=s.first)}},features:[e.qOj],decls:20,vars:30,consts:[[1,"row"],[3,"ngClass"],[3,"dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","select"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],["label","Esp\xe9cie","controlName","especie",3,"size","items"],["label","T\xedtulo","controlName","titulo","placeholder","T\xedtulo ...",3,"size","control"],["title","Template",3,"template"],["columnTemplate",""],["type","options",3,"onEdit","options"],[3,"rows"],["noButtons","",3,"disabled","form",4,"ngIf","ngIfElse"],["noSelected",""],[3,"buttons",4,"ngIf"],["icon","bi bi-hash",3,"label"],[3,"icon","label","color"],["noButtons","",3,"disabled","form"],["label","T\xedtulo",3,"size","control"],["label","Pre-view do template",3,"size","control"],[1,"block","w-100","text-center"],[3,"buttons"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"grid",2),e.NdJ("select",function(a){return t.onTemplateSelect(a)}),e.YNc(3,F,1,0,"toolbar",3),e.TgZ(4,"filter",4)(5,"div",0),e._UZ(6,"input-select",5),e.qZA(),e.TgZ(7,"div",0),e._UZ(8,"input-text",6),e.qZA()(),e.TgZ(9,"columns")(10,"column",7),e.YNc(11,N,5,5,"ng-template",null,8,e.W1O),e.qZA(),e._UZ(13,"column",9),e.qZA(),e._UZ(14,"pagination",10),e.qZA()(),e.TgZ(15,"div",1),e.YNc(16,z,5,7,"editable-form",11),e.YNc(17,R,2,0,"ng-template",null,12,e.W1O),e.qZA()(),e.YNc(19,B,1,1,"toolbar",13)),2&o){const s=e.MAs(12),a=e.MAs(18);e.xp6(1),e.Q6J("ngClass",t.listagem?"col-12":"col-4"),e.xp6(1),e.Q6J("dao",t.dao)("add",t.add)("title",t.isModal?"":t.title)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("selectable",t.selectable)("hasAdd",t.auth.hasPermissionTo("MOD_TEMP_INCL"))("hasEdit",t.auth.hasPermissionTo("MOD_TEMP_EDT")),e.xp6(1),e.Q6J("ngIf",!t.selectable),e.xp6(1),e.Q6J("deleted",t.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),e.xp6(2),e.Q6J("size",12)("items",t.lookup.TEMPLATE_ESPECIE),e.xp6(2),e.Q6J("size",12)("control",t.filter.controls.titulo),e.uIk("maxlength",250),e.xp6(2),e.Q6J("template",s),e.xp6(3),e.Q6J("onEdit",t.edit)("options",t.options),e.xp6(1),e.Q6J("rows",t.rowsLimit),e.xp6(1),e.Q6J("ngClass",t.listagem?"d-none":"col-8"),e.xp6(1),e.Q6J("ngIf",t.selected)("ngIfElse",a),e.xp6(3),e.Q6J("ngIf",t.selectable)}},dependencies:[h.mk,h.O5,b.M,I.a,J.b,D.z,L.n,S.Q,T.Q,A.m,Z.p,U.F,O.G]});var d,n,G=l(8239),Y=l(1184),w=l(25560);class f extends Y.F{constructor(o){super(o,u.Y,E.w),this.injector=o,this.dataset=[],this.validate=(t,s)=>null,this.templateService=o.get(C.E),this.modalWidth=1200,this.form=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"},conteudo:{default:""}},this.cdRef,this.validate)}loadData(o,t){var s=this;return(0,G.Z)(function*(){let a=Object.assign({},t.value);t.patchValue(s.util.fillForm(a,o)),s.dataset=yield s.templateService.dataset(t.controls.especie.value)})()}initializeData(o){this.loadData(new u.Y({especie:this.queryParams?.especie||"OUTRO"}),o)}saveData(o){return new Promise((t,s)=>{const a=this.util.fill(new u.Y,this.entity);a.dataset=this.templateService.prepareDatasetToSave(this.dataset),t(this.util.fillForm(a,this.form.value))})}}(d=f).\u0275fac=function(o){return new(o||d)(e.Y36(e.zs3))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-template-form"]],viewQuery:function(o,t){if(1&o&&e.Gf(T.Q,5),2&o){let s;e.iGM(s=e.CRH())&&(t.editableForm=s.first)}},features:[e.qOj],decls:7,vars:8,consts:[["initialFocus","titulo",3,"form","disabled","title","submit","cancel"],[1,"row"],["label","T\xedtulo","icon","bi bi-upc","controlName","titulo","required","",3,"size"],["disabled","","label","Esp\xe9cie","controlName","especie",3,"size","items"],["title","Design"],["controlName","conteudo",3,"dataset"]],template:function(o,t){1&o&&(e.TgZ(0,"editable-form",0),e.NdJ("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),e.TgZ(1,"div",1),e._UZ(2,"input-text",2)(3,"input-select",3),e.qZA(),e._UZ(4,"separator",4),e.TgZ(5,"div",1),e._UZ(6,"input-editor",5),e.qZA()()),2&o&&(e.Q6J("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),e.xp6(2),e.Q6J("size",8),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",4)("items",t.lookup.TEMPLATE_ESPECIE),e.xp6(3),e.Q6J("dataset",t.dataset))},dependencies:[T.Q,A.m,Z.p,w.N,O.G]});const j=[{path:"",component:M,canActivate:[p.a],resolve:{config:c.o},runGuardsAndResolvers:"always",data:{title:"Template"}},{path:"new",component:f,canActivate:[p.a],resolve:{config:c.o},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o",modal:!0}},{path:":id/edit",component:f,canActivate:[p.a],resolve:{config:c.o},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o",modal:!0}},{path:":id/consult",component:f,canActivate:[p.a],resolve:{config:c.o},runGuardsAndResolvers:"always",data:{title:"Consultar",modal:!0}}];class P{}(n=P).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.Bz.forChild(j),g.Bz]});var r,x=l(58568),V=l(72133);class Q{}(r=Q).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.ez,x.K,V.UX,P]})}}]);