"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[615],{5615:(V,f,s)=>{s.r(f),s.d(f,{TemplateModule:()=>j});var p=s(6733),T=s(5579),c=s(1391),m=s(2314),d=s(8409),g=s(9230),v=s(3150),Z=s(8509),E=s(9367),t=s(755),O=s(7224),M=s(3351),P=s(7765),Q=s(5512),y=s(2704),u=s(4040),b=s(2392),C=s(4603),I=s(5489),A=s(5795);function J(i,n){1&i&&t._UZ(0,"toolbar")}function D(i,n){if(1&i&&(t.TgZ(0,"small"),t._uU(1),t.qZA(),t._UZ(2,"br")(3,"badge",14)(4,"badge",15)),2&i){const o=n.row,l=t.oxw();t.xp6(1),t.Oqu(o.titulo),t.xp6(2),t.Q6J("label",o.numero),t.xp6(1),t.Q6J("icon",l.lookup.getIcon(l.lookup.TEMPLATE_ESPECIE,o.especie))("label",l.lookup.getValue(l.lookup.TEMPLATE_ESPECIE,o.especie))("color",l.lookup.getColor(l.lookup.TEMPLATE_ESPECIE,o.especie))}}function L(i,n){if(1&i&&(t.TgZ(0,"editable-form",16)(1,"div",0),t._UZ(2,"input-text",17),t.qZA(),t.TgZ(3,"div"),t._UZ(4,"input-editor",18),t.qZA()()),2&i){const o=t.oxw();t.Q6J("disabled",!0)("form",o.form),t.xp6(2),t.Q6J("size",12)("control",o.form.controls.titulo),t.uIk("maxlength",250),t.xp6(2),t.Q6J("size",12)("control",o.form.controls.conteudo)}}function S(i,n){1&i&&(t.TgZ(0,"div",19),t._uU(1," Nenhum template selecionado "),t.qZA())}function U(i,n){if(1&i&&t._UZ(0,"toolbar",20),2&i){const o=t.oxw();t.Q6J("buttons",o.selectButtons)}}let N=(()=>{class i extends Z.E{constructor(o){super(o,d.Y,g.w),this.injector=o,this.listagem=!1,this.selectButtons=[{color:"btn-outline-success",label:"Selecionar",icon:"bi-check-circle",disabled:()=>!this.selected,onClick:()=>this.onSelect(this.selected)},{color:"btn-outline-danger",label:"Cancelar",icon:"bi bi-dash-circle",onClick:()=>this.close()}],this._dataset=[],this.filterWhere=l=>{let e=[],a=l.value;if(this.listagem){this.addParams={especie:a.especie};const r=this.lookup.TEMPLATE_ESPECIE.find(x=>x.key===a.especie);this.title=this.lex.translate("Templates")+" - "+r?.value}return e.push(["especie","==",a.especie]),a.titulo?.length&&e.push(["titulo","like","%"+a.titulo.trim().replace(" ","%")+"%"]),e},this.templateService=o.get(E.E),this.title=this.lex.translate("Termos de Ci\xeancia e Responsabilidade"),this.code="MOD_TEMP",this.modalWidth=1200,this.filter=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"}}),this.form=this.fh.FormBuilder({titulo:{default:""},conteudo:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_TEMP_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}ngAfterViewInit(){super.ngAfterViewInit(),this.addParams={especie:this.filter?.controls.especie.value},"listagem"==this.queryParams.modo?(this.title=this.lex.translate("Templates")+" - OUTRO",this.listagem=!0,this.options=this.options.filter(o=>"Associar TCR"!==o.label)):this.auth.hasPermissionTo("MOD_TEMP_EDT")&&this.options.push({icon:"bi bi-check-all",label:"Associar TCR",onClick:(o=>this.go.navigate({route:["cadastros","template",o.id,"termos"]},{modalClose:l=>console.log(l?.conteudo)})).bind(this)})}onTemplateSelect(o){this.selected=o||void 0,this.form.patchValue({titulo:this.selected?.titulo||"",conteudo:this.selected?.conteudo||""}),this.cdRef.detectChanges()}static#t=this.\u0275fac=function(l){return new(l||i)(t.Y36(t.zs3))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-template-list"]],viewQuery:function(l,e){if(1&l&&t.Gf(v.M,5),2&l){let a;t.iGM(a=t.CRH())&&(e.grid=a.first)}},features:[t.qOj],decls:20,vars:30,consts:[[1,"row"],[3,"ngClass"],[3,"dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","select"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],["label","Esp\xe9cie","controlName","especie",3,"size","items"],["label","T\xedtulo","controlName","titulo","placeholder","T\xedtulo ...",3,"size","control"],["title","Template",3,"template"],["columnTemplate",""],["type","options",3,"onEdit","options"],[3,"rows"],["noButtons","",3,"disabled","form",4,"ngIf","ngIfElse"],["noSelected",""],[3,"buttons",4,"ngIf"],["icon","bi bi-hash",3,"label"],[3,"icon","label","color"],["noButtons","",3,"disabled","form"],["label","T\xedtulo",3,"size","control"],["label","Pre-view do template",3,"size","control"],[1,"block","w-100","text-center"],[3,"buttons"]],template:function(l,e){if(1&l&&(t.TgZ(0,"div",0)(1,"div",1)(2,"grid",2),t.NdJ("select",function(r){return e.onTemplateSelect(r)}),t.YNc(3,J,1,0,"toolbar",3),t.TgZ(4,"filter",4)(5,"div",0),t._UZ(6,"input-select",5),t.qZA(),t.TgZ(7,"div",0),t._UZ(8,"input-text",6),t.qZA()(),t.TgZ(9,"columns")(10,"column",7),t.YNc(11,D,5,5,"ng-template",null,8,t.W1O),t.qZA(),t._UZ(13,"column",9),t.qZA(),t._UZ(14,"pagination",10),t.qZA()(),t.TgZ(15,"div",1),t.YNc(16,L,5,7,"editable-form",11),t.YNc(17,S,2,0,"ng-template",null,12,t.W1O),t.qZA()(),t.YNc(19,U,1,1,"toolbar",13)),2&l){const a=t.MAs(12),r=t.MAs(18);t.xp6(1),t.Q6J("ngClass",e.listagem?"col-12":"col-4"),t.xp6(1),t.Q6J("dao",e.dao)("add",e.add)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",e.auth.hasPermissionTo("MOD_TEMP_INCL"))("hasEdit",e.auth.hasPermissionTo("MOD_TEMP_EDT")),t.xp6(1),t.Q6J("ngIf",!e.selectable),t.xp6(1),t.Q6J("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),t.xp6(2),t.Q6J("size",12)("items",e.lookup.TEMPLATE_ESPECIE),t.xp6(2),t.Q6J("size",12)("control",e.filter.controls.titulo),t.uIk("maxlength",250),t.xp6(2),t.Q6J("template",a),t.xp6(3),t.Q6J("onEdit",e.edit)("options",e.options),t.xp6(1),t.Q6J("rows",e.rowsLimit),t.xp6(1),t.Q6J("ngClass",e.listagem?"d-none":"col-8"),t.xp6(1),t.Q6J("ngIf",e.selected)("ngIfElse",r),t.xp6(3),t.Q6J("ngIf",e.selectable)}},dependencies:[p.mk,p.O5,v.M,O.a,M.b,P.z,Q.n,y.Q,u.Q,b.m,C.p,I.F,A.G]})}return i})();var z=s(8239),F=s(1184),R=s(5560);let h=(()=>{class i extends F.F{constructor(o){super(o,d.Y,g.w),this.injector=o,this.dataset=[],this.validate=(l,e)=>null,this.templateService=o.get(E.E),this.modalWidth=1200,this.form=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"},conteudo:{default:""}},this.cdRef,this.validate)}loadData(o,l){var e=this;return(0,z.Z)(function*(){let a=Object.assign({},l.value);l.patchValue(e.util.fillForm(a,o)),e.dataset=yield e.templateService.dataset(l.controls.especie.value)})()}initializeData(o){this.loadData(new d.Y({especie:this.queryParams?.especie||"OUTRO"}),o)}saveData(o){return new Promise((l,e)=>{const a=this.util.fill(new d.Y,this.entity);a.dataset=this.templateService.prepareDatasetToSave(this.dataset),l(this.util.fillForm(a,this.form.value))})}static#t=this.\u0275fac=function(l){return new(l||i)(t.Y36(t.zs3))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-template-form"]],viewQuery:function(l,e){if(1&l&&t.Gf(u.Q,5),2&l){let a;t.iGM(a=t.CRH())&&(e.editableForm=a.first)}},features:[t.qOj],decls:7,vars:8,consts:[["initialFocus","titulo",3,"form","disabled","title","submit","cancel"],[1,"row"],["label","T\xedtulo","icon","bi bi-upc","controlName","titulo","required","",3,"size"],["disabled","","label","Esp\xe9cie","controlName","especie",3,"size","items"],["title","Design"],["controlName","conteudo",3,"dataset"]],template:function(l,e){1&l&&(t.TgZ(0,"editable-form",0),t.NdJ("submit",function(){return e.onSaveData()})("cancel",function(){return e.onCancel()}),t.TgZ(1,"div",1),t._UZ(2,"input-text",2)(3,"input-select",3),t.qZA(),t._UZ(4,"separator",4),t.TgZ(5,"div",1),t._UZ(6,"input-editor",5),t.qZA()()),2&l&&(t.Q6J("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),t.xp6(2),t.Q6J("size",8),t.uIk("maxlength",250),t.xp6(1),t.Q6J("size",4)("items",e.lookup.TEMPLATE_ESPECIE),t.xp6(3),t.Q6J("dataset",e.dataset))},dependencies:[u.Q,b.m,C.p,R.N,A.G]})}return i})();const B=[{path:"",component:N,canActivate:[c.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Template"}},{path:"new",component:h,canActivate:[c.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o",modal:!0}},{path:":id/edit",component:h,canActivate:[c.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o",modal:!0}},{path:":id/consult",component:h,canActivate:[c.a],resolve:{config:m.o},runGuardsAndResolvers:"always",data:{title:"Consultar",modal:!0}}];let G=(()=>{class i{static#t=this.\u0275fac=function(l){return new(l||i)};static#e=this.\u0275mod=t.oAB({type:i});static#o=this.\u0275inj=t.cJS({imports:[T.Bz.forChild(B),T.Bz]})}return i})();var Y=s(2662),w=s(2133);let j=(()=>{class i{static#t=this.\u0275fac=function(l){return new(l||i)};static#e=this.\u0275mod=t.oAB({type:i});static#o=this.\u0275inj=t.cJS({imports:[p.ez,Y.K,w.UX,G]})}return i})()}}]);