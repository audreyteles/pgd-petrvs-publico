"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[5562],{55562:(he,N,o)=>{o.r(N),o.d(N,{UsuarioModule:()=>y});var I=o(76733),Z=o(55579),h=o(1391),v=o(2314),c=o(8239),_=o(74040),L=o(87744),O=o(81214),U=o(35255),b=o(26898),z=o(1184),T=o(73150),C=o(88631),M=o(76298),V=o(27918),R=o(65298),e=o(20755),P=o(57224),Q=o(83351),S=o(32802),D=o(64603),B=o(17819),J=o(50933),k=o(95489);const H=["unidade"];function Y(l,a){if(1&l&&(e.TgZ(0,"span")(1,"strong"),e._uU(2),e.qZA()()),2&l){const i=e.oxw();e.xp6(2),e.Oqu("Servidor: "+(null==i.entity?null:i.entity.nome))}}function j(l,a){if(1&l&&e._UZ(0,"top-alert",16),2&l){const i=e.oxw();e.Q6J("message","\xc9 imposs\xedvel excluir "+i.lex.translate("a lota\xe7\xe3o")+" "+i.lex.translate("do servidor")+". Para alter\xe1-la, lote-o em outra "+i.lex.translate("unidade")+"!")}}function W(l,a){if(1&l&&(e.TgZ(0,"strong"),e._uU(1),e.qZA(),e.TgZ(2,"span"),e._uU(3),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"span"),e._uU(6),e.qZA()),2&l){const i=a.row;e.xp6(1),e.Oqu(i.unidade_sigla||""),e.xp6(2),e.hij(" ",i.informal?"(Unidade Informal)":"(C\xf3digo: "+(i.unidade_codigo||"")+")",""),e.xp6(3),e.hij("",i.unidade_nome||""," ")}}function X(l,a){if(1&l&&e._UZ(0,"input-search",17,18),2&l){const i=e.oxw(),t=e.MAs(9);e.Q6J("disabled",null!=t&&t.adding?void 0:"true")("size",12)("dao",i.unidadeDao)}}function q(l,a){if(1&l&&(e.TgZ(0,"div"),e._UZ(1,"badge",20)(2,"br"),e.qZA()),2&l){const i=a.$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("color",t.lookup.getColor(t.lookup.UNIDADE_INTEGRANTE_TIPO,i||""))("icon",t.lookup.getIcon(t.lookup.UNIDADE_INTEGRANTE_TIPO,i||""))("label",t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,i||""))}}function K(l,a){if(1&l&&e.YNc(0,q,3,3,"div",19),2&l){const i=a.row;e.Q6J("ngForOf",i.atribuicoes)}}function $(l,a){if(1&l&&(e.TgZ(0,"input-multiselect",21),e._UZ(1,"input-select",22),e.qZA()),2&l){const i=e.oxw();e.Q6J("size",8)("addItemHandle",i.addItemHandle.bind(i))("deleteItemHandle",i.deleteItemHandle.bind(i)),e.xp6(1),e.Q6J("size",12)("items",i.lookup.ordenarLookupItem(i.lookup.UNIDADE_INTEGRANTE_TIPO))}}class p extends M.D{set control(a){super.control=a}get control(){return super.control}set entity(a){super.entity=a}get entity(){return super.entity}set noPersist(a){super.noPersist=a}get noPersist(){return super.noPersist}constructor(a){super(a),this.injector=a,this.items=[],this.perfilUsuario="",this.validate=(i,t)=>{let n=null;return["unidade_id","perfil_id","atribuicoes"].includes(t)&&!i.value?.length&&(n="Obrigat\xf3rio"),"unidade_id"==t&&this.grid?.adding&&this.items.map(s=>s.id).includes(i.value)&&(n="O usu\xe1rio j\xe1 \xe9 integrante desta unidade. Edite-a, ao inv\xe9s de inclu\xed-la novamente!"),n},this.formValidation=i=>{let t=i.controls.atribuicoes.value;if(this.util.array_diff(["GESTOR","GESTOR_SUBSTITUTO","GESTOR_DELEGADO"],t.map(n=>n.key)||[]).length<2)return"A um mesmo servidor s\xf3 pode ser atribu\xedda uma fun\xe7\xe3o de gestor (titular, substituto ou delegado), para uma mesma Unidade!"},this.integranteService=a.get(V.X),this.integranteDao=a.get(C.o),this.unidadeDao=a.get(O.J),this.usuarioDao=a.get(U.q),this.perfilDao=a.get(R.r),this.form=this.fh.FormBuilder({unidade_id:{default:""},atribuicoes:{default:void 0},atribuicao:{default:""}},this.cdRef,this.validate),this.formPerfil=this.fh.FormBuilder({perfil_id:{default:""}},this.cdRef,this.validate)}ngOnInit(){super.ngOnInit(),this.entity=this.entity??this.metadata?.entity}ngAfterViewInit(){var a=this;(0,c.Z)(function*(){yield a.loadData(a.entity||{},a.form)})()}loadData(a,i){var t=this;return(0,c.Z)(function*(){if(a.id){let n=[];try{yield t.integranteDao.carregarIntegrantes("",a.id).then(s=>n=s.integrantes.filter(d=>d.atribuicoes?.length>0))}finally{t.perfilUsuario=a.perfil_id,t.formPerfil.controls.perfil_id.setValue(t.perfilUsuario),t.items=[],n.forEach(s=>t.items?.push(t.integranteService.completarIntegrante(s,s.id,a.id,s.atribuicoes))),t.items=t.integranteService.ordenarIntegrantes(t.items),t.cdRef.detectChanges(),t.grid.loading=!1}}})()}salvarPerfil(){var a=this;return(0,c.Z)(function*(){a.submitting=!0,a.usuarioDao?.update(a.entity.id,{perfil_id:a.formPerfil.controls.perfil_id.value},[]).then(i=>{a.perfilUsuario=i.perfil_id,a.submitting=!1})})()}addItemHandle(){let a;const i=this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO,this.form.controls.atribuicao.value),t=this.form.controls.atribuicao.value;if(i?.length&&this.util.validateLookupItem(this.form.controls.atribuicao.value,t)){a={key:t,value:i,icon:this.lookup.getIcon(this.lookup.UNIDADE_INTEGRANTE_TIPO,this.form.controls.atribuicao.value),color:this.lookup.getColor(this.lookup.UNIDADE_INTEGRANTE_TIPO,this.form.controls.atribuicao.value)},this.form.controls.atribuicao.setValue("")}return a}deleteItemHandle(a){return"LOTADO"!=a.key}carregarIntegrante(a,i){var t=this;return(0,c.Z)(function*(){a.controls.unidade_id.setValue(t.grid?.adding?i.unidade_id:i.id),a.controls.atribuicoes.setValue(t.integranteService.converterAtribuicoes(i.atribuicoes)),a.controls.atribuicao.setValue("")})()}adicionarIntegrante(){var a=this;return(0,c.Z)(function*(){return a.grid&&(a.grid.error=""),{id:a.integranteDao.generateUuid(),unidade_id:"",atribuicoes:[]}})()}removerIntegrante(a){var i=this;return(0,c.Z)(function*(){if(a.atribuicoes.includes("LOTADO"))yield i.dialog.alert("IMPOSS\xcdVEL EXCLUIR !","O v\xednculo que inclui "+i.lex.translate("a lota\xe7\xe3o")+" "+i.lex.translate("do servidor")+" n\xe3o pode ser exclu\xeddo. Se deseja excluir as demais atribui\xe7\xf5es, edite o v\xednculo. Se deseja alterar "+i.lex.translate("a lota\xe7\xe3o")+", lote-o em outra "+i.lex.translate("Unidade")+".");else if(yield i.dialog.confirm("Exclui ?","Deseja realmente excluir todas as atribui\xe7\xf5es de "+i.entity.nome.toUpperCase()+" "+i.lex.translate("na unidade")+" "+a.unidade_sigla?.toUpperCase()+" ?")){let n;try{if(i.isNoPersist)return Object.assign(a,{_status:"DELETE",atribuicoes:[]}),!1;i.loading=!0,yield i.integranteDao.salvarIntegrantes([i.integranteService.completarIntegrante(a,a.id,i.entity.id,[])]).then(s=>{(n=s.find(d=>d._metadata.msg?.length)?._metadata.msg)&&i.grid&&(i.grid.error=n)}),yield i.loadData({id:i.entity.id},i.form)}finally{i.loading=!1}}return!1})()}salvarIntegrante(a,i){var t=this;return(0,c.Z)(function*(){let n=t.lookup.uniqueLookupItem(a.controls.atribuicoes.value);a.controls.atribuicoes.setValue(n),t.grid&&(t.grid.error=""),t.cdRef.detectChanges();let s=t.formValidation(a);if(s)yield t.dialog.alert("IMPOSS\xcdVEL INCLUIR/ALTERAR A UNIDADE !",s);else{let d=t.grid?.items||[],u=!0,f=t.integranteService.haAlteracaoGestor(n.map(r=>r.key),Object.assign(i,{unidade_sigla:t.unidade?.selectedItem?.entity.sigla}),d,t.entity?.nome||t.parent?.form?.controls.nome.value||"");if("nenhuma"!=f[0]){if(u=yield t.dialog.confirm("CONFIRMA A ALTERA\xc7\xc3O DA CHEFIA ?",f[2]),!u)return;switch(f[0]){case"ganho":if(f[3]){let r=t.grid?.items.findIndex(m=>m.atribuicoes.includes("LOTADO"));r&&(t.grid.items[r].atribuicoes=t.grid.items[r].atribuicoes.filter(m=>"LOTADO"!=m))}break;case"troca":t.grid.items[f[1]].atribuicoes=t.grid.items[f[1]].atribuicoes.filter(r=>!["GESTOR","LOTADO"].includes(r))}n=t.integranteService.inserirAtribuicao(n,"LOTADO"),a.controls.atribuicoes.setValue(n),t.loading=!0}else{let r=t.integranteService.haAlteracaoLotacao(a,Object.assign(i,{unidade_sigla:t.unidade?.selectedItem?.entity.sigla}),d,t.entity?.nome||"");if(r[0]){if(t.grid?.items[r[1]].atribuicoes.includes("GESTOR"))return void(yield t.dialog.alert("IMPOSS\xcdVEL ALTERAR A LOTA\xc7\xc3O !",r[3]));if(u=yield t.dialog.confirm("CONFIRMA A ALTERA\xc7\xc3O DA LOTA\xc7\xc3O ?",r[2]),!u)return;t.grid.items[r[1]].atribuicoes=t.grid.items[r[1]].atribuicoes.filter(m=>"LOTADO"!=m)}}try{t.isNoPersist?(i.id=t.unidade?.selectedEntity.id,t.grid.items=t.integranteService.substituirItem({id:i.id,itens:t.grid?.items||[],apelidoOuSigla:t.unidade?.selectedItem?.entity.sigla,nome:t.unidade?.selectedItem?.entity.nome,codigo:t.unidade?.selectedItem?.entity.codigo},n.map(r=>r.key),new b.b(t.entity)),t.cdRef.detectChanges()):(yield t.integranteDao.salvarIntegrantes([t.integranteService.completarIntegrante(i,a.controls.unidade_id.value,t.entity.id,n.map(r=>r.key))]).then(r=>{let m;(m=r?.find(x=>x._metadata.msg?.length)?._metadata.msg)&&t.dialog.alert("ATEN\xc7\xc3O: ERRO!",m)}),yield t.loadData({id:t.entity.id},t.form),t.grid&&(t.grid.error=""))}catch(r){t.grid&&(t.grid.error=r),yield t.loadData({id:t.entity.id},t.form)}finally{t.loading=!1}}})()}isNoButtons(){return this.isNoPersist||this.formPerfil.controls.perfil_id.value==this.perfilUsuario?"true":void 0}static#e=this.\u0275fac=function(i){return new(i||p)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:p,selectors:[["usuario-integrante"]],viewQuery:function(i,t){if(1&i&&(e.Gf(T.M,5),e.Gf(H,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.grid=n.first),e.iGM(n=e.CRH())&&(t.unidade=n.first)}},inputs:{control:"control",entity:"entity",noPersist:"noPersist",parent:"parent"},features:[e.qOj],decls:23,vars:23,consts:[[4,"ngIf"],[1,"row"],[1,"col-4"],["title","",3,"form","noButtons","disabled","submit"],["controlName","perfil_id","required","",3,"disabled","label","dao"],[1,"col"],["type","warning",3,"message"],["editable","",3,"items","minHeight","form","hasDelete","add","load","remove","save"],["grid",""],["type","alert",3,"message",4,"ngIf"],[3,"title","template","editTemplate"],["columnUnidade",""],["editUnidade",""],["columnAtribuicoes",""],["editAtribuicoes",""],["type","options"],["type","alert",3,"message"],["label","","icon","","controlName","unidade_id",3,"disabled","size","dao"],["unidade",""],[4,"ngFor","ngForOf"],[3,"color","icon","label"],["controlName","atribuicoes",3,"size","addItemHandle","deleteItemHandle"],["label","","icon","fas fa-sign-out-alt","controlName","atribuicao",3,"size","items"]],template:function(i,t){if(1&i&&(e.YNc(0,Y,3,1,"span",0),e.TgZ(1,"div",1)(2,"div",2)(3,"editable-form",3),e.NdJ("submit",function(){return t.salvarPerfil()}),e.TgZ(4,"div",1),e._UZ(5,"input-select",4),e.qZA()()(),e.TgZ(6,"div",5),e._UZ(7,"top-alert",6),e.qZA()(),e.TgZ(8,"grid",7,8),e.YNc(10,j,1,1,"top-alert",9),e.TgZ(11,"columns")(12,"column",10),e.YNc(13,W,7,3,"ng-template",null,11,e.W1O),e.YNc(15,X,2,3,"ng-template",null,12,e.W1O),e.qZA(),e.TgZ(17,"column",10),e.YNc(18,K,1,1,"ng-template",null,13,e.W1O),e.YNc(20,$,2,5,"ng-template",null,14,e.W1O),e.qZA(),e._UZ(22,"column",15),e.qZA()()),2&i){const n=e.MAs(14),s=e.MAs(16),d=e.MAs(19),u=e.MAs(21);e.Q6J("ngIf",!t.isNoPersist),e.xp6(3),e.Q6J("form",t.formPerfil)("noButtons",t.isNoButtons())("disabled",t.formDisabled),e.xp6(2),e.Q6J("disabled",t.auth.hasPermissionTo("MOD_CFG_USER_PERFIL")?void 0:"true")("label",t.lex.translate("Perfil"))("dao",t.perfilDao),e.xp6(2),e.Q6J("message","Ao conceder a "+t.lex.translate("um usu\xe1rio")+" a atribui\xe7\xe3o de "+t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR")+", "+t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR_SUBSTITUTO")+" ou de "+t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR_DELEGADO")+" em "+t.lex.translate("uma unidade")+", deve lhe ser concedido tamb\xe9m "+t.lex.translate("o n\xedvel de acesso")+" correspondente."),e.xp6(1),e.Q6J("items",t.items)("minHeight",500)("form",t.form)("hasDelete",!0)("add",t.adicionarIntegrante.bind(t))("load",t.carregarIntegrante.bind(t))("remove",t.removerIntegrante.bind(t))("save",t.salvarIntegrante.bind(t)),e.xp6(2),e.Q6J("ngIf",!t.isNoPersist),e.xp6(2),e.Q6J("title",t.lex.translate("Unidades"))("template",n)("editTemplate",s),e.xp6(5),e.Q6J("title",t.lex.translate("Atribui\xe7\xf5es"))("template",d)("editTemplate",u)}},dependencies:[I.sg,I.O5,T.M,P.a,Q.b,_.Q,S.V,D.p,B.p,J.o,k.F]})}var F=o(92392),w=o(84495),ee=o(48877),te=o(66384),ie=o(74978),G=o(2729),ae=o(55795);const ne=["lotacao"];class g extends z.F{constructor(a){super(a,b.b,U.q),this.injector=a,this.validate=(i,t)=>{let n=null;return"cpf"==t&&!this.util.validarCPF(i.value)&&(n="Inv\xe1lido"),["data_nascimento"].indexOf(t)>=0&&!this.dao?.validDateTime(i.value)&&(n="Inv\xe1lido"),n},this.formValidation=i=>this.unidadesIntegrantes?.formPerfil.controls.perfil_id.value?.length?this.unidadesIntegrantes?.grid?.items.find((t,n,s)=>t.atribuicoes.includes("LOTADO"))?"new"!=this.action&&this.unidadesIntegrantes?.grid?.items.find((t,n,s)=>!(t.unidade_id.length&&t.usuario_id.length))?"Na aba 'Atribui\xe7\xf5es' h\xe1 "+this.lex.translate("unidade")+" com edi\xe7\xe3o n\xe3o conclu\xedda. Conclua-a antes de salvar "+this.lex.translate("o servidor")+"!":void 0:"\xc9 obrigat\xf3ria a defini\xe7\xe3o "+this.lex.translate("da unidade")+" "+this.lex.translate("de lota\xe7\xe3o")+" "+this.lex.translate("do servidor")+"! Defina-a na aba 'Atribui\xe7\xf5es'.":"\xc9 obrigat\xf3rio a defini\xe7\xe3o de um "+this.lex.translate("perfil")+" para "+this.lex.translate("o servidor")+". Utilize a aba 'Atribui\xe7\xf5es'.",this.titleEdit=i=>"Editando "+this.lex.translate("Usu\xe1rio")+": "+(i?.nome||""),this.unidadeDao=a.get(O.J),this.integranteDao=a.get(C.o),this.planoTrabalhoDao=a.get(L.t),this.form=this.fh.FormBuilder({email:{default:""},nome:{default:""},cpf:{default:""},matricula:{default:""},apelido:{default:""},telefone:{default:""},uf:{default:""},sexo:{default:null},url_foto:{default:""},texto_complementar_plano:{default:""},data_nascimento:{default:null}},this.cdRef,this.validate),this.planoDataset=this.planoTrabalhoDao.dataset()}loadData(a,i){var t=this;return(0,c.Z)(function*(){let n=Object.assign({},i.value);i.patchValue(t.util.fillForm(n,a)),yield t.unidadesIntegrantes?.loadData(a)})()}initializeData(a){this.entity=new b.b,this.loadData(this.entity,a)}saveData(a){var i=this;return new Promise(function(){var t=(0,c.Z)(function*(n,s){i.unidadesIntegrantes.grid.confirm();let d=i.util.fill(new b.b,i.entity);d=i.util.fillForm(d,i.form.value),d.perfil_id=i.unidadesIntegrantes?.formPerfil.controls.perfil_id.value;let u=i.unidadesIntegrantes?.items||[],f=u.findIndex(r=>r.atribuicoes.includes("LOTADO"));u.forEach((r,m,x)=>{m!=f&&"DELETE"==r._status&&(r.atribuicoes=[])}),d.integrantes=u,n(d)});return function(n,s){return t.apply(this,arguments)}}())}static#e=this.\u0275fac=function(i){return new(i||g)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:g,selectors:[["app-usuario-form"]],viewQuery:function(i,t){if(1&i&&(e.Gf(_.Q,5),e.Gf(p,5),e.Gf(ne,5)),2&i){let n;e.iGM(n=e.CRH())&&(t.editableForm=n.first),e.iGM(n=e.CRH())&&(t.unidadesIntegrantes=n.first),e.iGM(n=e.CRH())&&(t.lotacao=n.first)}},features:[e.qOj],decls:26,vars:33,consts:[["initialFocus","cpf",3,"form","disabled","title","submit","cancel"],["display","","right",""],["key","PRINCIPAL","label","Principal"],[1,"row"],[1,"form-group","col-md-3","text-center"],[1,"mt-5",3,"url","size"],[1,"form-group","col-md-9"],["label","CPF","controlName","cpf","required","",3,"disabled","size","maskFormat"],["label","Matr\xedcula","controlName","matricula","required","",3,"disabled","size"],["label","E-mail","controlName","email","textCase","lower","required","",3,"disabled","size"],["date","","label","Nascimento","noIcon","","controlName","data_nascimento",3,"size","labelInfo"],["label","Nome","controlName","nome","required","",3,"size"],["label","Apelido","controlName","apelido","required","",3,"size"],["label","Sexo","controlName","sexo",3,"size","items"],["label","UF","icon","bi bi-flag","controlName","uf",3,"size","items"],["label","Telefone","controlName","telefone",3,"size","maskFormat"],["key","CONFIGURACOES","label","Configura\xe7\xf5es"],["controlName","texto_complementar_plano",3,"label","dataset"],["key","ATRIBUICOES",3,"label"],["type","alert",3,"message"],["noPersist","",3,"entity"],["unidadesIntegrantes",""]],template:function(i,t){1&i&&(e.TgZ(0,"editable-form",0),e.NdJ("submit",function(){return t.onSaveData()})("cancel",function(){return t.onCancel()}),e.TgZ(1,"tabs",1)(2,"tab",2)(3,"div",3)(4,"div",4),e._UZ(5,"profile-picture",5),e.qZA(),e.TgZ(6,"div",6)(7,"div",3),e._UZ(8,"input-text",7)(9,"input-text",8)(10,"input-text",9)(11,"input-datetime",10),e.qZA(),e.TgZ(12,"div",3),e._UZ(13,"input-text",11)(14,"input-text",12)(15,"input-radio",13),e.qZA(),e.TgZ(16,"div",3),e._UZ(17,"input-select",14)(18,"input-text",15),e.qZA()()()(),e.TgZ(19,"tab",16)(20,"div",3),e._UZ(21,"input-editor",17),e.qZA()(),e.TgZ(22,"tab",18),e._UZ(23,"top-alert",19)(24,"usuario-integrante",20,21),e.qZA()()()),2&i&&(e.Q6J("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),e.xp6(5),e.Q6J("url",t.form.controls.url_foto.value)("size",150),e.xp6(3),e.Q6J("disabled",t.auth.hasPermissionTo("MOD_CFG_USER_CPF")?void 0:"true")("size",3)("maskFormat","000.000.000-00"),e.uIk("maxlength",15),e.xp6(1),e.Q6J("disabled",t.auth.hasPermissionTo("MOD_CFG_USER_MAT")?void 0:"true")("size",2),e.uIk("maxlength",250),e.xp6(1),e.Q6J("disabled",t.auth.hasPermissionTo("MOD_CFG_USER_MAIL")?void 0:"true")("size",4),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",3)("labelInfo","Data de nascimento"),e.xp6(2),e.Q6J("size",5),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",3),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",3)("items",t.lookup.SEXO),e.xp6(2),e.Q6J("size",4)("items",t.lookup.UF),e.xp6(1),e.Q6J("size",4)("maskFormat","(00) 0000-0000||(00) 0 0000-0000"),e.uIk("maxlength",250),e.xp6(3),e.Q6J("label","Texto complementar "+t.lex.translate("Plano de Trabalho"))("dataset",t.planoDataset),e.xp6(1),e.Q6J("label",t.lex.translate("Atribui\xe7\xf5es")),e.xp6(1),e.Q6J("message","\xc9 imposs\xedvel excluir "+t.lex.translate("a lota\xe7\xe3o")+" "+t.lex.translate("do servidor")+". Para alter\xe1-la, lote-o em outra "+t.lex.translate("unidade")+"!"),e.xp6(1),e.Q6J("entity",t.entity))},dependencies:[_.Q,F.m,w.k,ee.f,D.p,te.n,ie.i,J.o,G.q,ae.G,p]})}var oe=o(78509),le=o(57765),re=o(45512),se=o(42704);function de(l,a){if(1&l&&(e.TgZ(0,"h3",17),e._uU(1),e.qZA()),2&l){const i=e.oxw();e.xp6(1),e.Oqu(i.title)}}function ue(l,a){1&l&&e._UZ(0,"toolbar")}function me(l,a){if(1&l&&e._UZ(0,"profile-picture",18),2&l){const i=a.row;e.Q6J("url",i.url_foto)("size",40)("hint",i.nome)}}function ce(l,a){if(1&l&&(e.TgZ(0,"strong"),e._uU(1),e.qZA()),2&l){const i=a.row;e.xp6(1),e.Oqu((null==i.perfil?null:i.perfil.nome)||"")}}class A extends oe.E{constructor(a){super(a,b.b,U.q),this.injector=a,this.filterWhere=i=>{let t=[];return i?.controls.usuario?.value?.length&&t.push(["nome","like","%"+i?.controls.usuario?.value.trim().replace(" ","%")+"%"]),i?.controls.unidade_id?.value?.length&&t.push(["lotacao","==",i?.controls.unidade_id.value]),i?.controls.perfil_id?.value?.length&&t.push(["perfil_id","==",i?.controls.perfil_id?.value]),t},this.unidadeDao=a.get(O.J),this.perfilDao=a.get(R.r),this.title=this.lex.translate("Usu\xe1rios"),this.code="MOD_CFG_USER",this.join=["perfil:id,nome"],this.filter=this.fh.FormBuilder({usuario:{default:""},unidade_id:{default:""},perfil_id:{default:null}}),this.addOption(this.OPTION_INFORMACOES,"MOD_USER")}dynamicOptions(a){let i=[];return this.auth.hasPermissionTo("MOD_USER_ATRIB")&&i.push({label:"Atribui\xe7\xf5es",icon:"bi bi-list-task",onClick:t=>{this.go.navigate({route:["configuracoes","usuario",t.id,"integrante"]},{metadata:{entity:a}})}}),i}static#e=this.\u0275fac=function(i){return new(i||A)(e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:A,selectors:[["app-usuario-list"]],viewQuery:function(i,t){if(1&i&&e.Gf(T.M,5),2&i){let n;e.iGM(n=e.CRH())&&(t.grid=n.first)}},features:[e.qOj],decls:20,vars:35,consts:[["class","my-2",4,"ngIf"],[3,"dao","add","orderBy","groupBy","join","selectable","hasAdd","hasEdit","select"],[4,"ngIf"],[3,"form","where","submit","collapseChange","collapsed"],[1,"row"],["controlName","usuario","placeholder","Nome",3,"size","label","control"],["controlName","unidade_id",3,"size","label","control","dao"],["controlName","perfil_id","nullable","",3,"size","label","control","dao"],["icon","bi-person",3,"align","template"],["columnFoto",""],["title","CPF","field","cpf"],["title","Matr\xedcula","field","matricula"],["title","Nome","field","nome","orderBy","nome"],[3,"title","template"],["columnPerfil",""],["type","options",3,"onEdit","dynamicOptions","options"],[3,"rows"],[1,"my-2"],[3,"url","size","hint"]],template:function(i,t){if(1&i&&(e.YNc(0,de,2,1,"h3",0),e.TgZ(1,"grid",1),e.NdJ("select",function(s){return t.onSelect(s)}),e.YNc(2,ue,1,0,"toolbar",2),e.TgZ(3,"filter",3)(4,"div",4),e._UZ(5,"input-text",5)(6,"input-search",6)(7,"input-select",7),e.qZA()(),e.TgZ(8,"columns")(9,"column",8),e.YNc(10,me,1,3,"ng-template",null,9,e.W1O),e.qZA(),e._UZ(12,"column",10)(13,"column",11)(14,"column",12),e.TgZ(15,"column",13),e.YNc(16,ce,2,1,"ng-template",null,14,e.W1O),e.qZA(),e._UZ(18,"column",15),e.qZA(),e._UZ(19,"pagination",16),e.qZA()),2&i){const n=e.MAs(11),s=e.MAs(17);e.Q6J("ngIf",!t.isModal),e.xp6(1),e.Q6J("dao",t.dao)("add",t.add)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("selectable",t.selectable)("hasAdd",t.auth.hasPermissionTo("MOD_USER_INCL"))("hasEdit",t.auth.hasPermissionTo("MOD_USER_EDT")),e.xp6(1),e.Q6J("ngIf",!t.selectable),e.xp6(1),e.Q6J("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),e.xp6(2),e.Q6J("size",4)("label",t.lex.translate("Usu\xe1rio"))("control",t.filter.controls.usuario),e.uIk("maxlength",250),e.xp6(1),e.Q6J("size",4)("label",t.lex.translate("Lota\xe7\xe3o"))("control",t.filter.controls.unidade_id)("dao",t.unidadeDao),e.xp6(1),e.Q6J("size",4)("label",t.lex.translate("Perfil"))("control",t.filter.controls.perfil_id)("dao",t.perfilDao),e.xp6(2),e.Q6J("align","center")("template",n),e.xp6(6),e.Q6J("title",t.lex.translate("Perfil"))("template",s),e.xp6(3),e.Q6J("onEdit",t.edit)("dynamicOptions",t.dynamicOptions.bind(t))("options",t.options),e.xp6(1),e.Q6J("rows",t.rowsLimit)}},dependencies:[I.O5,T.M,P.a,Q.b,le.z,re.n,se.Q,S.V,F.m,D.p,G.q]})}const fe=[{path:"",component:A,canActivate:[h.a],resolve:{config:v.o},runGuardsAndResolvers:"always",data:{title:"Usu\xe1rios"}},{path:"new",component:g,canActivate:[h.a],resolve:{config:v.o},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o de Usu\xe1rio",modal:!0}},{path:":id/edit",component:g,canActivate:[h.a],resolve:{config:v.o},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o de Usu\xe1rio",modal:!0}},{path:":id/consult",component:g,canActivate:[h.a],resolve:{config:v.o},runGuardsAndResolvers:"always",data:{title:"Consulta a Usu\xe1rio",modal:!0}},{path:":id/integrante",component:p,canActivate:[h.a],resolve:{config:v.o},runGuardsAndResolvers:"always",data:{title:"Atribui\xe7\xf5es do Usu\xe1rio",modal:!0}}];class E{static#e=this.\u0275fac=function(i){return new(i||E)};static#t=this.\u0275mod=e.oAB({type:E});static#i=this.\u0275inj=e.cJS({imports:[Z.Bz.forChild(fe),Z.Bz]})}var pe=o(31415),ge=o(72133);class y{static#e=this.\u0275fac=function(i){return new(i||y)};static#t=this.\u0275mod=e.oAB({type:y});static#i=this.\u0275inj=e.cJS({imports:[I.ez,pe.K,ge.UX,E]})}}}]);